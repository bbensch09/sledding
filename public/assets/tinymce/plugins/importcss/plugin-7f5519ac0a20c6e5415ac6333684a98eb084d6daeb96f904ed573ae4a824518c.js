/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.5.1 (2020-10-01)
 */
!function(){"use strict";var t,e=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),n=tinymce.util.Tools.resolve("tinymce.EditorManager"),o=tinymce.util.Tools.resolve("tinymce.Env"),i=tinymce.util.Tools.resolve("tinymce.util.Tools"),c=function(t){return t.getParam("importcss_selector_converter")},s=(t="array",function(e){return n=typeof(r=e),(null===r?"null":"object"==n&&(Array.prototype.isPrototypeOf(r)||r.constructor&&"Array"===r.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(r)||r.constructor&&"String"===r.constructor.name)?"string":n)===t;var r,n}),a=Array.prototype.push,u=function(t,e){return function(t){for(var e=[],r=0,n=t.length;r<n;++r){if(!s(t[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+t);a.apply(e,t[r])}return e}(function(t,e){for(var r=t.length,n=new Array(r),o=0;o<r;o++){var i=t[o];n[o]=e(i,o)}return n}(t,e))},l=function(t){return"string"==typeof t?function(e){return-1!==e.indexOf(t)}:t instanceof RegExp?function(e){return t.test(e)}:t},f=function(t,e,r){function c(e,a){var u,l,f,m=e.href;if(l=m,f=o.cacheSuffix,"string"==typeof l&&(l=l.replace("?"+f,"").replace("&"+f,"")),(m=l)&&r(m,a)&&!function(t,e){var r,o=!1!==(r=t.getParam("skin"))&&(r||"oxide");if(o){var i=t.getParam("skin_url"),c=i?t.documentBaseURI.toAbsolute(i):n.baseURL+"/skins/ui/"+o,s=n.baseURL+"/skins/content/";return e===c+"/content"+(t.inline?".inline":"")+".min.css"||-1!==e.indexOf(s)}return!1}(t,m)){i.each(e.imports,function(t){c(t,!0)});try{u=e.cssRules||e.rules}catch(p){}i.each(u,function(t){t.styleSheet?c(t.styleSheet,!0):t.selectorText&&i.each(t.selectorText.split(","),function(t){s.push(i.trim(t))})})}}var s=[],a={};i.each(t.contentCSS,function(t){a[t]=!0}),r=r||function(t,e){return e||a[t]};try{i.each(e.styleSheets,function(t){c(t)})}catch(u){}return s},m=function(t,e){var r,n=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(e);if(n){var o=n[1],c=n[2].substr(1).split(".").join(" "),s=i.makeMap("a,img");return n[1]?(r={title:e},t.schema.getTextBlockElements()[o]?r.block=o:t.schema.getBlockElements()[o]||s[o.toLowerCase()]?r.selector=o:r.inline=o):n[2]&&(r={inline:"span",title:e.substr(1),classes:c}),!1!==t.getParam("importcss_merge_classes")?r.classes=c:r.attributes={"class":c},r}},p=function(t,e){return null===e||!1!==t.getParam("importcss_exclusive")},g=function(t){t.on("init",function(){var e,n,o,s,a=(e=[],n=[],o={},{addItemToGroup:function(t,e){o[t]?o[t].push(e):(n.push(t),o[t]=[e])},addItem:function(t){e.push(t)},toFormats:function(){return u(n,function(t){var e=o[t];return 0===e.length?[]:[{title:t,items:e}]}).concat(e)}}),g={},y=l(t.getParam("importcss_selector_filter")),v=(s=t.getParam("importcss_groups"),i.map(s,function(t){return i.extend({},t,{original:t,selectors:{},filter:l(t.filter),item:{text:t.title,menu:[]}})})),h=function(e,n){if(d=e,x=g,!(p(t,_=n)?d in x:d in _.selectors)){y=e,h=g,p(t,v=n)?h[y]=!0:v.selectors[y]=!0;var o=(u=(a=t).plugins.importcss,l=e,((f=n)&&f.selector_converter?f.selector_converter:c(a)?c(a):function(){return m(a,l)}).call(u,l,f));if(o){var s=o.name||r.DOM.uniqueId();return t.formatter.register(s,o),i.extend({},{title:o.title,format:s})}}var a,u,l,f,y,v,h,d,_,x;return null};i.each(f(t,t.getDoc(),l(t.getParam("importcss_file_filter"))),function(t){var e,r,n,o;-1===t.indexOf(".mce-")&&(y&&!y(t)||(n=v,o=t,0<(e=i.grep(n,function(t){return!t.filter||t.filter(o)})).length?i.each(e,function(e){var r=h(t,e);r&&a.addItemToGroup(e.title,r)}):(r=h(t,null))&&a.addItem(r)))});var d=a.toFormats();t.fire("addStyleModifications",{items:d,replace:!t.getParam("importcss_append")})})};e.add("importcss",function(t){return g(t),e=t,{convertSelectorToFormat:function(t){return m(e,t)}};var e})}();