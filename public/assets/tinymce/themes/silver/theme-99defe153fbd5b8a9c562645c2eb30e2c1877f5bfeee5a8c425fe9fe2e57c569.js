/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.5.1 (2020-10-01)
 */
!function(){"use strict";function t(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}function n(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function e(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var o=Array(t),r=0;for(n=0;n<e;n++)for(var i=arguments[n],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}function o(t,n){var e=function(e){var o=n(e);if(o<=0||null===o){var r=Fu(e,t);return parseFloat(r)||0}return o},o=function(t,n){return At(n,function(n,e){var o=Fu(t,e),r=o===undefined?0:parseInt(o,10);return isNaN(r)?n:n+r},0)};return{set:function(n,e){if(!ht(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom;vu(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e);return r<n?n-r:0}}}function r(t,n,e,o,r){return t(e,o)?ut.some(e):pt(r)&&r(e)?ut.none():n(e,o,r)}function i(t,n,e){var o=n.backstage;return{open:function(t,r){var i=!t.closeButton&&t.timeout&&(0<t.timeout||t.timeout<0),u=function(){r(),Fp.hide(c)},a=Ju($p.sketch({text:t.text,level:St(["success","error","warning","warn","info"],t.type)?t.type:undefined,progress:!0===t.progressBar,icon:ut.from(t.icon),closeButton:!i,onAction:u,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),c=Ju(Fp.sketch(et({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:n.backstage.shared.getSink,fireDismissalEventInstead:{}},o.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return e.add(c),0<t.timeout&&Gp.setTimeout(function(){u()},t.timeout),{close:u,moveTo:function(t,n){Fp.showAt(c,{anchor:"makeshift",x:t,y:n},$u(a))},moveRel:function(t,e){var o,r;"banner"!==e?(o=function(){switch(e){case"bc-bc":return Wp;case"tc-tc":return Up;case"tc-bc":return xc;case"bc-tc":default:return wc}}(),r={anchor:"node",root:_u(),node:ut.some($e.fromDom(t)),layouts:{onRtl:function(){return[o]},onLtr:function(){return[o]}}},Fp.showAt(c,r,$u(a))):Fp.showAt(c,n.backstage.shared.anchors.banner(),$u(a))},text:function(t){$p.updateText(a,t)},settings:t,getEl:function(){return a.element.dom},progressBar:{value:function(t){$p.updateProgress(a,t)}}}},close:function(t){t.close()},reposition:function(t){var n;Tt(t,function(t){return t.moveTo(0,0)}),0<(n=t).length&&(Nt(n).each(function(t){return t.moveRel(null,"banner")}),Tt(n,function(t,e){0<e&&t.moveRel(n[e-1].getEl(),"bc-tc")}))},getArgs:function(t){return t.settings}}}function u(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout(function(){t.apply(null,o),e=null},n)}}}function a(){var t={};return{registerId:function(n,e,o){dn(o,function(o,r){var i=t[r]!==undefined?t[r]:{};i[e]=Qi(o,n),t[r]=i})},unregisterId:function(n){dn(t,function(t){t.hasOwnProperty(n)&&delete t[n]})},filterByType:function(n){return yn(t,n).map(function(t){return hn(t,function(t,n){return nx(n,t)})}).getOr([])},find:function(n,e,o){var r=yn(t,e);return Io(o,function(t){return n=r,Hi(e=t).fold(function(){return ut.none()},function(t){return n.bind(function(n){return yn(n,t)}).map(function(t){return tx(e,t)})});var n,e},n)}}}function c(){var t=a(),n={},e=function(t){var n=t.element;return Hi(n).fold(function(){return n="uid-",e=t.element,o=Mi(Ri+n),Pi(e,o),o;var n,e,o},function(t){return t})},o=function(e){Hi(e.element).each(function(e){delete n[e],t.unregisterId(e)})};return{find:function(n,e,o){return t.find(n,e,o)},filter:function(n){return t.filterByType(n)},register:function(r){var i=e(r);wn(n,i)&&function(t,e){var r=n[e];if(r!==t)throw new Error('The tagId "'+e+'" is already used by: '+Ei(r.element)+"\nCannot use it for: "+Ei(t.element)+"\nThe conflicting element is"+(Ou(r.element)?" ":" not ")+"already in the DOM");o(t)}(r,i);var u=[r];t.registerId(u,i,r.events),n[i]=r},unregister:o,getById:function(t){return yn(n,t)}}}function s(t,n){return d(document.createElement("canvas"),t,n)}function l(t){var n=s(t.width,t.height);return f(n).drawImage(t,0,0),n}function f(t){return t.getContext("2d")}function d(t,n,e){return t.width=n,t.height=e,t}function m(t){return t.naturalWidth||t.width}function g(t){return t.naturalHeight||t.height}function p(t,n){return function(){return t.apply(n,arguments)}}function h(t){var n=this;null!==this._state?ew(function(){var e,o=n._state?t.onFulfilled:t.onRejected;if(null!==o){try{e=o(n._value)}catch(j){return void t.reject(j)}t.resolve(e)}else(n._state?t.resolve:t.reject)(n._value)}):this._deferreds.push(t)}function v(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if("function"==typeof n)return void w(p(n,t),p(v,this),p(b,this))}this._state=!0,this._value=t,y.call(this)}catch(j){b.call(this,j)}}function b(t){this._state=!1,this._value=t,y.call(this)}function y(){for(var t=0,n=this._deferreds;t<n.length;t++){var e=n[t];h.call(this,e)}this._deferreds=[]}function x(t,n,e,o){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=o}function w(t,n,e){var o=!1;try{t(function(t){o||(o=!0,n(t))},function(t){o||(o=!0,e(t))})}catch(W){if(o)return;o=!0,e(W)}}function S(t){return new Kk(function(n,e){(function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return ut.none();for(var o=e[1],r=n[1],i=atob(r),u=i.length,a=Math.ceil(u/1024),c=new Array(a),s=0;s<a;++s){for(var l=1024*s,f=Math.min(1024+l,u),d=new Array(f-l),m=l,g=0;m<f;++g,++m)d[g]=i[m].charCodeAt(0);c[s]=new Uint8Array(d)}return ut.some(new Blob(c,{type:o}))})(t).fold(function(){e("uri is not base64: "+t)},n)})}function k(t,n,e){return n=n||"image/png",pt(HTMLCanvasElement.prototype.toBlob)?new Kk(function(o,r){t.toBlob(function(t){t?o(t):r()},n,e)}):S(t.toDataURL(n,e))}function C(t){return n=t,new Kk(function(t,e){function o(){a(),t(u)}function r(){a(),e("Unable to load data of type "+n.type+": "+i)}var i=URL.createObjectURL(n),u=new Image,a=function(){u.removeEventListener("load",o),u.removeEventListener("error",r)};u.addEventListener("load",o),u.addEventListener("error",r),u.src=i,u.complete&&o()}).then(function(t){var n;n=t,URL.revokeObjectURL(n.src);var e=s(m(t),g(t));return f(e).drawImage(t,0,0),e});var n}function O(t,n,e){function o(n,e){return t.then(function(t){return r=e,o=(o=n)||"image/png",t.toDataURL(o,r);var o,r})}var r=n.type;return{getType:K(r),toBlob:function(){return Kk.resolve(n)},toDataURL:K(e),toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then(function(t){return k(t,n,e)})},toAdjustedDataURL:o,toAdjustedBase64:function(t,n){return o(t,n).then(function(t){return t.split(",")[1]})},toCanvas:function(){return t.then(l)}}}function _(t){return n=t,new Kk(function(t){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n)}).then(function(n){return O(C(t),t,n)});var n}function T(t,n){return k(t,n).then(function(n){return O(Kk.resolve(t),n,t.toDataURL())})}function E(t,n,e){var o="string"==typeof t?parseFloat(t):t;return e<o?o=e:o<n&&(o=n),o}function B(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}function D(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){for(var a=e=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r}function A(t,n){return t.toCanvas().then(function(e){return o=e,r=t.getType(),i=n,a=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],l=n[3],f=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*l+f,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}((u=f(o)).getImageData(0,0,o.width,o.height),i),u.putImageData(a,0,0),T(o,r);var o,r,i,u,a})}function M(t,n){return t.toCanvas().then(function(e){return o=e,r=t.getType(),i=n,a=function(t,n,e){function o(t,n,e){return e<t?t=e:t<n&&(t=n),t}for(var r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(f+h-i,0,c-1),b=4*(o(l+p-i,0,s-1)*c+v),y=e[p*r+h];d+=u[b]*y,m+=u[1+b]*y,g+=u[2+b]*y}var x=4*(l*c+f);a[x]=o(d,0,255),a[1+x]=o(m,0,255),a[2+x]=o(g,0,255)}return n}((u=f(o)).getImageData(0,0,o.width,o.height),a=u.getImageData(0,0,o.width,o.height),i),u.putImageData(a,0,0),T(o,r);var o,r,i,u,a})}function F(t){return function(n,e){return A(n,t(B(),e))}}function I(t,n,e){var o=m(t),r=g(t),i=n/o,u=e/r,a=!1;(i<.5||2<i)&&(i=i<.5?.5:2,a=!0),(u<.5||2<u)&&(u=u<.5?.5:2,a=!0);var c,l,d,p=(c=t,l=i,d=u,new Kk(function(t){var n=m(c),e=g(c),o=Math.floor(n*l),r=Math.floor(e*d),i=s(o,r);f(i).drawImage(c,0,0,n,e,0,0,o,r),t(i)}));return a?p.then(function(t){return I(t,n,e)}):p}function R(t,n){return t.toCanvas().then(function(e){return function(t,n,e){var o=s(t.width,t.height),r=f(o),i=0,u=0;return 90!==(e=e<0?360+e:e)&&270!==e||d(o,o.height,o.width),90!==e&&180!==e||(i=o.width),270!==e&&180!==e||(u=o.height),r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(t,0,0),T(o,n)}(e,t.getType(),n)})}function V(t,n){return t.toCanvas().then(function(e){return function(t,n,e){var o=s(t.width,t.height),r=f(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),T(o,n)}(e,t.getType(),n)})}function P(t,n,e,o,r){return t.toCanvas().then(function(i){return u=i,a=t.getType(),c=n,l=e,f(d=s(o,r)).drawImage(u,-c,-l),T(d,a);var u,a,c,l,d})}function H(t){var n,e;if(t.changedTouches)for(n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]}function z(t,n){var e,o,r,i,u=n.document||document,a=u.getElementById(n.handle||t),c=function(t){if(H(t),t.button!==o)return s(t);t.deltaX=t.screenX-r,t.deltaY=t.screenY-i,t.preventDefault(),n.drag(t)},s=function(t){H(t),nO(u).off("mousemove touchmove",c).off("mouseup touchend",s),e.remove(),n.stop&&n.stop(t)};this.destroy=function(){nO(a).off()},nO(a).on("mousedown touchstart",function(t){var l,f,d,m,g,p,h,v,b,y,x=(l=u,f=Math.max,d=l.documentElement,m=l.body,g=f(d.scrollWidth,m.scrollWidth),p=f(d.clientWidth,m.clientWidth),h=f(d.offsetWidth,m.offsetWidth),v=f(d.scrollHeight,m.scrollHeight),b=f(d.clientHeight,m.clientHeight),{width:g<h?p:g,height:v<f(d.offsetHeight,m.offsetHeight)?b:v});H(t),t.preventDefault(),o=t.button;var w=a;r=t.screenX,i=t.screenY,y=window.getComputedStyle?window.getComputedStyle(w,null).getPropertyValue("cursor"):w.runtimeStyle.cursor,e=nO("<div></div>").css({position:"absolute",top:0,left:0,width:x.width,height:x.height,zIndex:2147483647,opacity:1e-4,cursor:y}).appendTo(u.body),nO(u).on("mousemove touchmove",c).on("mouseup touchend",s),n.start(t)})}function N(){function t(){return 0<o}function n(){return-1!==o&&o<e.length-1}var e=[],o=-1;return{data:e,add:function(t){var n=e.splice(++o);return e.push(t),{state:t,removed:n}},undo:function(){if(t())return e[--o]},redo:function(){if(n())return e[++o]},canUndo:t,canRedo:n}}var L,j,U,W,G,X,Y=function(){},q=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}},K=function(t){return function(){return t}},J=function(t){return t},$=function(t){return function(n){return!t(n)}},Q=function(t){return function(){throw new Error(t)}},Z=K(!1),tt=K(!0),nt=tinymce.util.Tools.resolve("tinymce.ThemeManager"),et=function(){return(et=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)},ot=function(){return rt},rt=(L=function(t){return t.isNone()},{fold:function(t){return t()},is:Z,isSome:Z,isNone:tt,getOr:U=function(t){return t},getOrThunk:j=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:K(null),getOrUndefined:K(undefined),or:U,orThunk:j,map:ot,each:Y,bind:ot,exists:Z,forall:tt,filter:ot,equals:L,equals_:L,toArray:function(){return[]},toString:K("none()")}),it=function(t){var n=K(t),e=function(){return r},o=function(n){return n(t)},r={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:tt,isNone:Z,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return it(n(t))},each:function(n){n(t)},bind:o,exists:o,forall:o,filter:function(n){return n(t)?r:rt},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(Z,function(n){return e(t,n)})}};return r},ut={some:it,none:ot,from:function(t){return null===t||t===undefined?rt:it(t)}},at=function(t){return function(n){return o=typeof(e=n),(null===e?"null":"object"==o&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==o&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":o)===t;var e,o}},ct=function(t){return function(n){return typeof n===t}},st=at("string"),lt=at("object"),ft=at("array"),dt=ct("boolean"),mt=(W=undefined,function(t){return W===t}),gt=function(t){return!(null===(n=t)||n===undefined);var n},pt=ct("function"),ht=ct("number"),vt=function(t,n){if(ft(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},bt=Array.prototype.slice,yt=Array.prototype.indexOf,xt=Array.prototype.push,wt=function(t,n){return yt.call(t,n)},St=function(t,n){return-1<wt(t,n)},kt=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return!0;return!1},Ct=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},Ot=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=bt.call(t,o,o+n);e.push(r)}return e},_t=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},Tt=function(t,n){for(var e=0,o=t.length;e<o;e++)n(t[e],e)},Et=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},Bt=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},Dt=function(t,n,e){return function(t,n){for(var e=t.length-1;0<=e;e--)n(t[e],e)}(t,function(t){e=n(e,t)}),e},At=function(t,n,e){return Tt(t,function(t){e=n(e,t)}),e},Mt=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return ut.some(i);if(e(i,o))break}return ut.none()}(t,n,Z)},Ft=function(t,n){for(var e=0,o=t.length;e<o;e++)if(n(t[e],e))return ut.some(e);return ut.none()},It=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!ft(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);xt.apply(n,t[e])}return n},Rt=function(t,n){return It(_t(t,n))},Vt=function(t,n){for(var e=0,o=t.length;e<o;++e)if(!0!==n(t[e],e))return!1;return!0},Pt=function(t){var n=bt.call(t,0);return n.reverse(),n},Ht=function(t,n){return Bt(t,function(t){return!St(n,t)})},zt=function(t,n){var e=bt.call(t,0);return e.sort(n),e},Nt=function(t){return 0===t.length?ut.none():ut.some(t[0])},Lt=function(t){return 0===t.length?ut.none():ut.some(t[t.length-1])},jt=pt(Array.from)?Array.from:function(t){return bt.call(t)},Ut=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return ut.none()},Wt=function(t){return{is:function(n){return t===n},isValue:tt,isError:Z,getOr:K(t),getOrThunk:K(t),getOrDie:K(t),or:function(){return Wt(t)},orThunk:function(){return Wt(t)},fold:function(n,e){return e(t)},map:function(n){return Wt(n(t))},mapError:function(){return Wt(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return ut.some(t)}}},Gt=function(t){return{is:Z,isValue:Z,isError:tt,getOr:J,getOrThunk:function(t){return t()},getOrDie:function(){return Q(String(t))()},or:function(t){return t},orThunk:function(t){return t()},fold:function(n){return n(t)},map:function(){return Gt(t)},mapError:function(n){return Gt(n(t))},each:Y,bind:function(){return Gt(t)},exists:Z,forall:tt,toOptional:ut.none}},Xt={value:Wt,error:Gt,fromOption:function(t,n){return t.fold(function(){return Gt(n)},Wt)}};(X=G=G||{})[X.Error=0]="Error",X[X.Value=1]="Value";var Yt,qt,Kt,Jt,$t=function(t,n,e){return t.stype===G.Error?n(t.serror):e(t.svalue)},Qt=function(t){return{stype:G.Value,svalue:t}},Zt=function(t){return{stype:G.Error,serror:t}},tn=function(t){return t.fold(Zt,Qt)},nn=function(t){return $t(t,Xt.error,Xt.value)},en=Qt,on=function(t){var n=[],e=[];return Tt(t,function(t){$t(t,function(t){return e.push(t)},function(t){return n.push(t)})}),{values:n,errors:e}},rn=Zt,un=function(t,n){return t.stype===G.Value?n(t.svalue):t},an=function(t,n){return t.stype===G.Error?n(t.serror):t},cn=function(t,n){return t.stype===G.Value?{stype:G.Value,svalue:n(t.svalue)}:t},sn=function(t,n){return t.stype===G.Error?{stype:G.Error,serror:n(t.serror)}:t},ln=Object.keys,fn=Object.hasOwnProperty,dn=function(t,n){for(var e=ln(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},mn=function(t,n){return gn(t,function(t,e){return{k:e,v:n(t,e)}})},gn=function(t,n){var e={};return dn(t,function(t,o){var r=n(t,o);e[r.k]=r.v}),e},pn=function(t,n){var e,o,r,i,u={};return e=n,i=u,o=function(t,n){i[n]=t},r=Y,dn(t,function(t,n){(e(t,n)?o:r)(t,n)}),u},hn=function(t,n){var e=[];return dn(t,function(t,o){e.push(n(t,o))}),e},vn=function(t,n){for(var e=ln(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return ut.some(u)}return ut.none()},bn=function(t){return hn(t,function(t){return t})},yn=function(t,n){return xn(t,n)?ut.from(t[n]):ut.none()},xn=function(t,n){return fn.call(t,n)},wn=function(t,n){return xn(t,n)&&t[n]!==undefined&&null!==t[n]},Sn=function(t){if(!ft(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],e={};return Tt(t,function(o,r){var i=ln(o);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=o[u];if(e[u]!==undefined)throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!ft(a))throw new Error("case arguments must be an array");n.push(u),e[u]=function(){var e=arguments.length;if(e!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+e);for(var o=new Array(e),i=0;i<o.length;i++)o[i]=arguments[i];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[r].apply(null,o)},match:function(t){var e=ln(t);if(n.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+e.join(","));if(!Vt(n,function(t){return St(e,t)}))throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+n.join(", "));return t[u].apply(null,o)},log:function(t){console.log(t,{constructors:n,constructor:u,params:o})}}}}),e},kn=Object.prototype.hasOwnProperty,Cn=function(t){return function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i=n[r];for(var u in i)kn.call(i,u)&&(o[u]=t(o[u],i[u]))}return o}},On=Cn(function(t,n){return lt(t)&&lt(n)?On(t,n):n}),_n=Cn(function(t,n){return n}),Tn=function(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}},En=Sn([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Bn=function(t){return En.defaultedThunk(K(t))},Dn=En.strict,An=En.asOption,Mn=En.defaultedThunk,Fn=(En.asDefaultedOptionThunk,En.mergeWithThunk),In=(Sn([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t,n){var e={};return e[t]=n,e}),Rn=function(t,n){return e=n,o={},dn(t,function(t,n){St(e,n)||(o[n]=t)}),o;var e,o},Vn=In,Pn=function(t){return n={},Tt(t,function(t){n[t.key]=t.value}),n;var n},Hn=function(t,n){var e,o,r,i,u,a=(e=[],o=[],Tt(t,function(t){t.fold(function(t){e.push(t)},function(t){o.push(t)})}),{errors:e,values:o});return 0<a.errors.length?(u=a.errors,Xt.error(It(u))):(i=n,0===(r=a.values).length?Xt.value(i):Xt.value(On(i,_n.apply(undefined,r))))},zn=function(t){return q(rn,It)(t)},Nn=function(t,n){var e,o,r=on(t);return 0<r.errors.length?zn(r.errors):(o=n,0<(e=r.values).length?en(On(o,_n.apply(undefined,e))):en(o))},Ln=function(t){var n=on(t);return 0<n.errors.length?zn(n.errors):en(n.values)},jn=function(t){return lt(t)&&100<ln(t).length?" removed due to size":JSON.stringify(t,null,2)},Un=function(t,n){return rn([{path:t,getErrorInfo:n}])},Wn=Sn([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Gn=function(t,n,e){return yn(n,e).fold(function(){return o=e,r=n,Un(t,function(){return'Could not find valid *strict* value for "'+o+'" in '+jn(r)});var o,r},en)},Xn=function(t,n,e){var o=yn(t,n).fold(function(){return e(t)},J);return en(o)},Yn=function(t,n,e,o){return e.fold(function(e,r,i,u){var a=function(n){var i=u.extract(t.concat([e]),o,n);return cn(i,function(t){return In(r,o(t))})},c=function(n){return n.fold(function(){var t=In(r,o(ut.none()));return en(t)},function(n){var i=u.extract(t.concat([e]),o,n);return cn(i,function(t){return In(r,o(ut.some(t)))})})};return i.fold(function(){return un(Gn(t,n,e),a)},function(t){return un(Xn(n,e,t),a)},function(){return un(en(yn(n,e)),c)},function(t){return un((r=t,i=yn(o=n,e).map(function(t){return!0===t?r(o):t}),en(i)),c);var o,r,i},function(t){var o=t(n),r=cn(Xn(n,e,K({})),function(t){return On(o,t)});return un(r,a)})},function(t,e){var r=e(n);return en(In(t,o(r)))})},qn=function(t){return{extract:function(n,e,o){return an(t(o,e),function(t){return e=t,Un(n,function(){return e});var e})},toString:function(){return"val"}}},Kn=function(t){var n=Jn(t),e=Dt(t,function(t,n){return n.fold(function(n){return On(t,Vn(n,!0))},K(t))},{});return{extract:function(t,o,r){var i,u=dt(r)?[]:ln(pn(r,function(t){return t!==undefined&&null!==t})),a=Bt(u,function(t){return!wn(e,t)});return 0===a.length?n.extract(t,o,r):(i=a,Un(t,function(){return"There are unsupported fields: ["+i.join(", ")+"] specified"}))},toString:n.toString}},Jn=function(t){return{extract:function(n,e,o){return r=n,i=o,u=e,a=_t(t,function(t){return Yn(r,i,t,u)}),Nn(a,{});var r,i,u,a},toString:function(){return"obj{\n"+_t(t,function(t){return t.fold(function(t,n,e,o){return t+" -> "+o.toString()},function(t){return"state("+t+")"})}).join("\n")+"}"}}},$n=function(t){return{extract:function(n,e,o){var r=_t(o,function(o,r){return t.extract(n.concat(["["+r+"]"]),e,o)});return Ln(r)},toString:function(){return"array("+t.toString()+")"}}},Qn=function(t){return{extract:function(n,e,o){for(var r=[],i=0,u=t;i<u.length;i++){var a=u[i].extract(n,e,o);if(a.stype===G.Value)return a;r.push(a)}return Ln(r)},toString:function(){return"oneOf("+_t(t,function(t){return t.toString()}).join(", ")+")"}}},Zn=function(t,n){return{extract:function(e,o,r){var i,u,a=ln(r),c=(i=e,u=a,$n(qn(t)).extract(i,J,u));return un(c,function(t){var i=_t(t,function(t){return Wn.field(t,t,Dn(),n)});return Jn(i).extract(e,o,r)})},toString:function(){return"setOf("+n.toString()+")"}}},te=K(qn(en)),ne=q($n,Jn),ee=Wn.state,oe=Wn.field,re=function(t,n,e,o,r){return yn(o,r).fold(function(){return n=o,e=r,Un(t,function(){return'The chosen schema: "'+e+'" did not exist in branches: '+jn(n)});var n,e},function(o){return o.extract(t.concat(["branch: "+r]),n,e)})},ie=function(t,n){return{extract:function(e,o,r){return yn(r,t).fold(function(){return n=t,Un(e,function(){return'Choice schema did not contain choice key: "'+n+'"'});var n},function(t){return re(e,o,r,n,t)})},toString:function(){return"chooseOn("+t+"). Possible values: "+ln(n)}}},ue=qn(en),ae=function(t){return ne(t)},ce=function(t){return{extract:function(n,e,o){return t().extract(n,e,o)},toString:function(){return t().toString()}}},se=function(t){return qn(function(n){return t(n).fold(rn,en)})},le=function(t,n){return Zn(function(n){return tn(t(n))},n)},fe=function(t,n,e){return nn((o=t,r=J,i=e,u=n.extract([o],r,i),sn(u,function(t){return{input:i,errors:t}})));var o,r,i,u},de=function(t){return t.fold(function(t){throw new Error(ge(t))},J)},me=function(t,n,e){return de(fe(t,n,e))},ge=function(t){return"Errors: \n"+(e=10<(n=t.errors).length?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n,_t(e,function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}).join("\n"))+"\n\nInput object: "+jn(t.input);var n,e},pe=ie,he=function(t,n){return ie(t,mn(n,Jn))},ve=K(ue),be=function(t,n){return qn(function(e){var o=typeof e;return t(e)?en(e):rn("Expected type: "+n+" but got: "+o)})},ye=be(ht,"number"),xe=be(st,"string"),we=be(dt,"boolean"),Se=be(pt,"function"),ke=function(t){var n=function(t,n){for(var e=t.next();!e.done;){if(!n(e.value))return!1;e=t.next()}return!0};if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every(function(n){return ke(t[n])});case"Map":return n(t.keys(),ke)&&n(t.values(),ke);case"Set":return n(t.keys(),ke);default:return!1}},Ce=qn(function(t){return ke(t)?en(t):rn("Expected value to be acceptable for sending via postMessage")}),Oe=function(t){return se(function(n){return St(t,n)?Xt.value(n):Xt.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')})},_e=function(t){return oe(t,t,Dn(),te())},Te=function(t,n){return oe(t,t,Dn(),n)},Ee=function(t){return Te(t,xe)},Be=function(t,n){return oe(t,t,Dn(),Oe(n))},De=function(t){return Te(t,Se)},Ae=function(t,n){return oe(t,t,Dn(),Jn(n))},Me=function(t,n){return oe(t,t,Dn(),ne(n))},Fe=function(t,n){return oe(t,t,Dn(),$n(n))},Ie=function(t){return oe(t,t,An(),te())},Re=function(t,n){return oe(t,t,An(),n)},Ve=function(t){return Re(t,ye)},Pe=function(t){return Re(t,xe)},He=function(t){return Re(t,Se)},ze=function(t,n){return Re(t,Jn(n))},Ne=function(t,n){return oe(t,t,Bn(n),te())},Le=function(t,n,e){return oe(t,t,Bn(n),e)},je=function(t,n){return Le(t,n,ye)},Ue=function(t,n){return Le(t,n,xe)},We=function(t,n,e){return Le(t,n,Oe(e))},Ge=function(t,n){return Le(t,n,we)},Xe=function(t,n){return Le(t,n,Se)},Ye=function(t,n,e){return Le(t,n,Jn(e))},qe=function(t,n){return ee(t,n)},Ke=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},Je=function(t){if(null===t||t===undefined)throw new Error("Node cannot be null or undefined");return{dom:t}},$e={fromHtml:function(t,n){var e=(n||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||1<e.childNodes.length)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return Je(e.childNodes[0])},fromTag:function(t,n){var e=(n||document).createElement(t);return Je(e)},fromText:function(t,n){var e=(n||document).createTextNode(t);return Je(e)},fromDom:Je,fromPoint:function(t,n,e){return ut.from(t.dom.elementFromPoint(n,e)).map(Je)}},Qe=function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}return undefined}(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return to(o(1),o(2))},Ze=function(){return to(0,0)},to=function(t,n){return{major:t,minor:n}},no={nu:to,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?Ze():Qe(t,e)},unknown:Ze},eo=function(t,n){var e=String(n).toLowerCase();return Mt(t,function(t){return t.search(e)})},oo=function(t,n){return eo(t,n).map(function(t){var e=no.detect(t.versionRegexes,n);return{current:t.name,version:e}})},ro=function(t,n){return eo(t,n).map(function(t){var e=no.detect(t.versionRegexes,n);return{current:t.name,version:e}})},io=function(t,n){return-1!==t.indexOf(n)},uo=(Yt=/^\s+|\s+$/g,function(t){return t.replace(Yt,"")}),ao=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,co=function(t){return function(n){return io(n,t)}},so=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return io(t,"edge/")&&io(t,"chrome")&&io(t,"safari")&&io(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ao],search:function(t){return io(t,"chrome")&&!io(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return io(t,"msie")||io(t,"trident")}},{name:"Opera",versionRegexes:[ao,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:co("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:co("firefox")},{name:"Safari",versionRegexes:[ao,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(io(t,"safari")||io(t,"mobile/"))&&io(t,"applewebkit")}}],lo=[{name:"Windows",search:co("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return io(t,"iphone")||io(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:co("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:co("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:co("linux"),versionRegexes:[]},{name:"Solaris",search:co("sunos"),versionRegexes:[]},{name:"FreeBSD",search:co("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:co("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],fo={browsers:K(so),oses:K(lo)},mo="Firefox",go=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:o("Edge"),isChrome:o("Chrome"),isIE:o("IE"),isOpera:o("Opera"),isFirefox:o(mo),isSafari:o("Safari")}},po={unknown:function(){return go({current:undefined,version:no.unknown()})},nu:go,edge:K("Edge"),chrome:K("Chrome"),ie:K("IE"),opera:K("Opera"),firefox:K(mo),safari:K("Safari")},ho="Windows",vo="Android",bo="Solaris",yo="FreeBSD",xo="ChromeOS",wo=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:o(ho),isiOS:o("iOS"),isAndroid:o(vo),isOSX:o("OSX"),isLinux:o("Linux"),isSolaris:o(bo),isFreeBSD:o(yo),isChromeOS:o(xo)}},So={unknown:function(){return wo({current:undefined,version:no.unknown()})},nu:wo,windows:K(ho),ios:K("iOS"),android:K(vo),linux:K("Linux"),osx:K("OSX"),solaris:K(bo),freebsd:K(yo),chromeos:K(xo)},ko=function(t,n){var e,o,r,i,u,a,c,s,l,f,d,m,g=fo.browsers(),p=fo.oses(),h=oo(g,t).fold(po.unknown,po.nu),v=ro(p,t).fold(So.unknown,So.nu);return{browser:h,os:v,deviceType:(o=h,r=t,i=n,u=(e=v).isiOS()&&!0===/ipad/i.test(r),a=e.isiOS()&&!u,c=e.isiOS()||e.isAndroid(),s=c||i("(pointer:coarse)"),l=u||!a&&c&&i("(min-device-width:768px)"),f=a||c&&!l,d=o.isSafari()&&e.isiOS()&&!1===/safari/i.test(r),m=!f&&!l&&!d,{isiPad:K(u),isiPhone:K(a),isTablet:K(l),isPhone:K(f),isTouch:K(s),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:K(d),isDesktop:K(m)})}},Co=function(t){return window.matchMedia(t).matches},Oo=Tn(function(){return ko(navigator.userAgent,Co)}),_o=function(){return Oo()},To=function(t,n){var e=t.dom;if(1!==e.nodeType)return!1;var o=e;if(o.matches!==undefined)return o.matches(n);if(o.msMatchesSelector!==undefined)return o.msMatchesSelector(n);if(o.webkitMatchesSelector!==undefined)return o.webkitMatchesSelector(n);if(o.mozMatchesSelector!==undefined)return o.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},Eo=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},Bo=function(t,n){return t.dom===n.dom},Do=function(t,n){return e=t.dom,o=n.dom,r=Node.DOCUMENT_POSITION_CONTAINED_BY,0!=(e.compareDocumentPosition(o)&r);var e,o,r},Ao=function(t,n){return _o().browser.isIE()?Do(t,n):(e=n,(o=t.dom)!==(r=e.dom)&&o.contains(r));var e,o,r},Mo=function(t){return pt(t)?t:Z},Fo=function(t,n,e){for(var o=t.dom,r=Mo(e);o.parentNode;){o=o.parentNode;var i=$e.fromDom(o),u=n(i)
;if(u.isSome())return u;if(r(i))break}return ut.none()},Io=function(t,n,e){var o=n(t),r=Mo(e);return o.orThunk(function(){return r(t)?ut.none():Fo(t,n,r)})},Ro=function(t,n){return Bo(t.element,n.event.target)},Vo=function(t){if(!wn(t,"can")&&!wn(t,"abort")&&!wn(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return me("Extracting event.handler",Kn([Ne("can",tt),Ne("abort",Z),Ne("run",Y)]),t)},Po=function(t){var n,e,o,r,i=(e=function(t){return t.can},function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return At(n,function(n,o){return n&&e(o).apply(undefined,t)},!0)}),u=(o=n=t,r=function(t){return t.abort},function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return At(o,function(n,e){return n||r(e).apply(undefined,t)},!1)});return Vo({can:i,abort:u,run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];Tt(t,function(t){t.run.apply(undefined,n)})}})},Ho=K,zo=Ho("touchstart"),No=Ho("touchmove"),Lo=Ho("touchend"),jo=Ho("touchcancel"),Uo=Ho("mousedown"),Wo=Ho("mousemove"),Go=Ho("mouseout"),Xo=Ho("mouseup"),Yo=Ho("mouseover"),qo=Ho("focusin"),Ko=Ho("focusout"),Jo=Ho("keydown"),$o=Ho("keyup"),Qo=Ho("input"),Zo=Ho("change"),tr=Ho("click"),nr=Ho("transitionend"),er=Ho("selectstart"),or=function(t){return K("alloy."+t)},rr={tap:or("tap")},ir=or("focus"),ur=or("blur.post"),ar=or("paste.post"),cr=or("receive"),sr=or("execute"),lr=or("focus.item"),fr=rr.tap,dr=or("longpress"),mr=or("sandbox.close"),gr=or("typeahead.cancel"),pr=or("system.init"),hr=or("system.touchmove"),vr=or("system.touchend"),br=or("system.scroll"),yr=or("system.resize"),xr=or("system.attached"),wr=or("system.detached"),Sr=or("system.dismissRequested"),kr=or("system.repositionRequested"),Cr=or("focusmanager.shifted"),Or=or("slotcontainer.visibility"),_r=or("change.tab"),Tr=or("dismiss.tab"),Er=or("highlight"),Br=or("dehighlight"),Dr=function(t,n){Ir(t,t.element,n,{})},Ar=function(t,n,e){Ir(t,t.element,n,e)},Mr=function(t){Dr(t,sr())},Fr=function(t,n,e){Ir(t,n,e,{})},Ir=function(t,n,e,o){var r=et({target:n},o);t.getSystem().triggerEvent(e,n,r)},Rr=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},Vr=Pn,Pr=function(t,n){return{key:t,value:Vo({abort:n})}},Hr=function(t){return{key:t,value:Vo({run:function(t,n){n.event.prevent()}})}},zr=function(t,n){return{key:t,value:Vo({run:n})}},Nr=function(t,n,e){return{key:t,value:Vo({run:function(t,o){n.apply(undefined,[t,o].concat(e))}})}},Lr=function(t){return function(n){return{key:t,value:Vo({run:function(t,e){Ro(t,e)&&n(t,e)}})}}},jr=function(t,n,e){var o,r,i=n.partUids[e];return r=i,zr(o=t,function(t,n){t.getSystem().getByUid(r).each(function(t){Rr(t,t.element,o,n)})})},Ur=function(t,n){return zr(t,function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).fold(function(){return Io(o.target,function(n){return t.getSystem().getByDom(n).toOptional()},Z).getOr(t)},function(t){return t});n(t,r,e)})},Wr=function(t){return zr(t,function(t,n){n.cut()})},Gr=function(t,n){return Lr(t)(n)},Xr=Lr(xr()),Yr=Lr(wr()),qr=Lr(pr()),Kr=(qt=sr(),function(t){return zr(qt,t)}),Jr=("undefined"!=typeof window||Function("return this;")(),function(t){return t.dom.nodeName.toLowerCase()}),$r=function(t){return function(n){return n.dom.nodeType===t}},Qr=$r(1),Zr=$r(3),ti=$r(9),ni=$r(11),ei=function(t){return $e.fromDom(t.dom.ownerDocument)},oi=function(t){return ti(t)?t:ei(t)},ri=function(t){return $e.fromDom(oi(t).dom.documentElement)},ii=function(t){return $e.fromDom(oi(t).dom.defaultView)},ui=function(t){return ut.from(t.dom.parentNode).map($e.fromDom)},ai=ui,ci=function(t){return ut.from(t.dom.offsetParent).map($e.fromDom)},si=function(t){return _t(t.dom.childNodes,$e.fromDom)},li=function(t,n){var e=t.dom.childNodes;return ut.from(e[n]).map($e.fromDom)},fi=function(t,n){ui(t).each(function(e){e.dom.insertBefore(n.dom,t.dom)})},di=function(t,n){var e;(e=t,ut.from(e.dom.nextSibling).map($e.fromDom)).fold(function(){ui(t).each(function(t){gi(t,n)})},function(t){fi(t,n)})},mi=function(t,n){li(t,0).fold(function(){gi(t,n)},function(e){t.dom.insertBefore(n.dom,e.dom)})},gi=function(t,n){t.dom.appendChild(n.dom)},pi=function(t,n){Tt(n,function(n){gi(t,n)})},hi=function(t){t.dom.textContent="",Tt(si(t),function(t){vi(t)})},vi=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},bi=function(t){var n,e=si(t);0<e.length&&(n=t,Tt(e,function(t){fi(n,t)})),vi(t)},yi=function(t){return t.dom.innerHTML},xi=function(t,n){var e,o,r=ei(t).dom,i=$e.fromDom(r.createDocumentFragment()),u=(e=n,(o=(r||document).createElement("div")).innerHTML=e,si($e.fromDom(o)));pi(i,u),hi(t),gi(t,i)},wi=function(t,n,e){if(!(st(e)||dt(e)||ht(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},Si=function(t,n,e){wi(t.dom,n,e)},ki=function(t,n){var e=t.dom.getAttribute(n);return null===e?undefined:e},Ci=function(t,n){return ut.from(ki(t,n))},Oi=function(t,n){var e=t.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},_i=function(t,n){t.dom.removeAttribute(n)},Ti=function(t){return n=t,e=!1,$e.fromDom(n.dom.cloneNode(e));var n,e},Ei=function(t){var n,e,o;return n=Ti(t),e=$e.fromTag("div"),o=$e.fromDom(n.dom.cloneNode(!0)),gi(e,o),yi(e)},Bi=Vr([{key:ir(),value:Vo({can:function(t,n){var e,o,r=n.event,i=r.originator,u=r.target;return o=u,!(Bo(e=i,t.element)&&!Bo(e,o)&&(console.warn(ir()+" did not get interpreted by the desired target. \nOriginator: "+Ei(i)+"\nTarget: "+Ei(u)+"\nCheck the "+ir()+" event handlers"),1))}})}]),Di=Object.freeze({__proto__:null,events:Bi}),Ai=0,Mi=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++Ai+String(n)},Fi=K("alloy-id-"),Ii=K("data-alloy-id"),Ri=Fi(),Vi=Ii(),Pi=function(t,n){Object.defineProperty(t.dom,Vi,{value:n,writable:!0})},Hi=function(t){var n=Qr(t)?t.dom[Vi]:null;return ut.from(n)},zi=Mi,Ni=J,Li=function(t){var n=function(n){return function(){throw new Error("The component must be in a context to send: "+n+(t?"\n"+Ei(t().element)+" is not in context.":""))}};return{debugInfo:K("fake"),triggerEvent:n("triggerEvent"),triggerFocus:n("triggerFocus"),triggerEscape:n("triggerEscape"),build:n("build"),addToWorld:n("addToWorld"),removeFromWorld:n("removeFromWorld"),addToGui:n("addToGui"),removeFromGui:n("removeFromGui"),getByUid:n("getByUid"),getByDom:n("getByDom"),broadcast:n("broadcast"),broadcastOn:n("broadcastOn"),broadcastEvent:n("broadcastEvent"),isConnected:Z}},ji=Li(),Ui=function(t){return _t(t,function(t){return o=n="/*",r=(e=t).length-n.length,""===o||e.length>=o.length&&e.substr(r,r+o.length)===o?t.substring(0,t.length-"/*".length):t;var n,e,o,r})},Wi=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:Ui(i)}},t},Gi=Mi("alloy-premade"),Xi=function(t){return Vn(Gi,t)},Yi=function(t){return n=function(n){for(var o=[],r=1;r<arguments.length;r++)o[r-1]=arguments[r];return t.apply(void 0,e([n.getApis(),n],o))},r=(o=t.toString()).indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/),n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Ui(u.slice(1))}},n;var n,o,r,i,u},qi={init:function(){return Ki({readState:function(){return"No State required"}})}},Ki=function(t){return t},Ji=function(t,n){var e={};return dn(t,function(t,o){dn(t,function(t,r){var i=yn(e,r).getOr([]);e[r]=i.concat([n(o,t)])})}),e},$i=function(t){return{classes:t.classes!==undefined?t.classes:[],attributes:t.attributes!==undefined?t.attributes:{},styles:t.styles!==undefined?t.styles:{}}},Qi=function(n,e){return{cHandler:t.apply(undefined,[n.handler].concat(e)),purpose:n.purpose}},Zi=function(t){return t.cHandler},tu=function(t,n){return{name:t,handler:n}},nu=function(t,n,e){var o,r,i=et(et({},e),(o=t,r={},Tt(n,function(t){r[t.name()]=t.handlers(o)}),r));return Ji(i,tu)},eu=function(t){var n,e=pt(n=t)?{can:K(!0),abort:K(!1),run:n}:n;return function(t,n){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[t,n].concat(o);e.abort.apply(undefined,i)?n.stop():e.can.apply(undefined,i)&&e.run.apply(undefined,i)}},ou=function(t,n,e){var o,r,i=n[e];return i?function(t,n,o,r){try{var i=zt(o,function(e,o){var i=e[n],u=o[n],a=r.indexOf(i),c=r.indexOf(u);if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2));return a<c?-1:c<a?1:0});return Xt.value(i)}catch(e){return Xt.error([e])}}("Event: "+e,"name",t,i).map(function(t){var n=_t(t,function(t){return t.handler});return Po(n)}):(o=e,r=t,Xt.error(["The event ("+o+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(_t(r,function(t){return t.name}),null,2)]))},ru=function(t,n){var e=hn(t,function(t,e){return(1===t.length?Xt.value(t[0].handler):ou(t,n,e)).map(function(o){var r=eu(o),i=1<t.length?Bt(n[e],function(n){return kt(t,function(t){return t.name===n})}).join(" > "):t[0].name;return Vn(e,{handler:r,purpose:i})})});return Hn(e,{})},iu="alloy.base.behaviour",uu=function(t){var n,e;return fe("custom.definition",Jn([oe("dom","dom",Dn(),Jn([_e("tag"),Ne("styles",{}),Ne("classes",[]),Ne("attributes",{}),Ie("value"),Ie("innerHtml")])),_e("components"),_e("uid"),Ne("events",{}),Ne("apis",{}),oe("eventOrder","eventOrder",((n={})[sr()]=["disabling",iu,"toggling","typeaheadevents"],n[ir()]=[iu,"focusing","keying"],n[pr()]=[iu,"disabling","toggling","representing"],n[Qo()]=[iu,"representing","streaming","invalidating"],n[wr()]=[iu,"representing","item-events","tooltipping"],n[Uo()]=["focusing",iu,"item-type-events"],n[zo()]=["focusing",iu,"item-type-events"],n[Yo()]=["item-type-events","tooltipping"],n[cr()]=["receiving","reflecting","tooltipping"],e=n,En.mergeWithThunk(K(e))),ve()),Ie("domModification")]),t)},au=function(t,n){var e=ki(t,n);return e===undefined||""===e?[]:e.split(" ")},cu=function(t){return t.dom.classList!==undefined},su=function(t,n){return r=n,i=au(e=t,o="class").concat([r]),Si(e,o,i.join(" ")),!0;var e,o,r,i},lu=function(t,n){return r=n,0<(i=Bt(au(e=t,o="class"),function(t){return t!==r})).length?Si(e,o,i.join(" ")):_i(e,o),!1;var e,o,r,i},fu=function(t,n){cu(t)?t.dom.classList.add(n):su(t,n)},du=function(t){0===(cu(t)?t.dom.classList:au(t,"class")).length&&_i(t,"class")},mu=function(t,n){cu(t)?t.dom.classList.remove(n):lu(t,n),du(t)},gu=function(t,n){return cu(t)&&t.dom.classList.contains(n)},pu=function(t,n){Tt(n,function(n){fu(t,n)})},hu=function(t,n){Tt(n,function(n){mu(t,n)})},vu=function(t){return t.style!==undefined&&pt(t.style.getPropertyValue)},bu=function(t){return ni(t)},yu=pt(Element.prototype.attachShadow)&&pt(Node.prototype.getRootNode),xu=K(yu),wu=yu?function(t){return $e.fromDom(t.dom.getRootNode())}:oi,Su=function(t){return bu(t)?t:$e.fromDom(oi(t).dom.body)},ku=function(t){return $e.fromDom(t.dom.host)},Cu=function(t){return gt(t.dom.shadowRoot)},Ou=function(t){var n=Zr(t)?t.dom.parentNode:t.dom;if(n===undefined||null===n||null===n.ownerDocument)return!1;var e,o,r,i,u=n.ownerDocument;return r=$e.fromDom(n),i=wu(r),(bu(i)?ut.some(i):ut.none()).fold(function(){return u.body.contains(n)},(e=Ou,o=ku,function(t){return e(o(t))}))},_u=function(){return Tu($e.fromDom(document))},Tu=function(t){var n=t.dom.body;if(null===n||n===undefined)throw new Error("Body is not available yet");return $e.fromDom(n)},Eu=function(t,n,e){if(!st(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);vu(t)&&t.style.setProperty(n,e)},Bu=function(t,n){vu(t)&&t.style.removeProperty(n)},Du=function(t,n,e){var o=t.dom;Eu(o,n,e)},Au=function(t,n){var e=t.dom;dn(n,function(t,n){Eu(e,n,t)})},Mu=function(t,n){var e=t.dom;dn(n,function(t,n){t.fold(function(){Bu(e,n)},function(t){Eu(e,n,t)})})},Fu=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||Ou(t)?o:Iu(e,n)},Iu=function(t,n){return vu(t)?t.style.getPropertyValue(n):""},Ru=function(t,n){var e=t.dom,o=Iu(e,n);return ut.from(o).filter(function(t){return 0<t.length})},Vu=function(t,n,e){var o=$e.fromTag(t);return Du(o,n,e),Ru(o,n).isSome()},Pu=function(t,n){var e=t.dom;Bu(e,n),Ci(t,"style").map(uo).is("")&&_i(t,"style")},Hu=function(t){return t.dom.offsetWidth},zu=function(t){return t.dom.value},Nu=function(t,n){if(n===undefined)throw new Error("Value.set was undefined");t.dom.value=n},Lu=function(t){var n,e,o,r=$e.fromTag(t.tag);n=r,e=t.attributes,o=n.dom,dn(e,function(t,n){wi(o,n,t)}),pu(r,t.classes),Au(r,t.styles),t.innerHtml.each(function(t){return xi(r,t)});var i=t.domChildren;return pi(r,i),t.value.each(function(t){Nu(r,t)}),t.uid,Pi(r,t.uid),r},ju=function(t,n){return e=t,r=_t(o=n,function(t){return ze(t.name(),[_e("config"),Ne("state",qi)])}),i=fe("component.behaviours",Jn(r),e.behaviours).fold(function(t){throw new Error(ge(t)+"\nComplete spec:\n"+JSON.stringify(e,null,2))},function(t){return t}),{list:o,data:mn(i,function(t){var n=t.map(function(t){return{config:t.config,state:t.state.init(t.config)}});return function(){return n}})};var e,o,r,i},Uu=function(t){var n,e,o=(n=yn(t,"behaviours").getOr({}),e=Bt(ln(n),function(t){return n[t]!==undefined}),_t(e,function(t){return n[t].me}));return ju(t,o)},Wu=function(t,n,e){var o,r,i,u=et(et({},(o=t).dom),{uid:o.uid,domChildren:_t(o.components,function(t){return t.element})}),a=t.domModification.fold(function(){return $i({})},$i),c={"alloy.base.modification":a};return i=0<n.length?function(t,n,e,o){var r=et({},n);Tt(e,function(n){r[n.name()]=n.exhibit(t,o)});var i=Ji(r,function(t,n){return{name:t,modification:n}}),u=function(t){return Dt(t,function(t,n){return et(et({},n.modification),t)},{})},a=Dt(i.classes,function(t,n){return n.modification.concat(t)},[]),c=u(i.attributes),s=u(i.styles);return $i({classes:a,attributes:c,styles:s})}(e,c,n,u):a,et(et({},r=u),{attributes:et(et({},r.attributes),i.attributes),styles:et(et({},r.styles),i.styles),classes:r.classes.concat(i.classes)})},Gu=function(t,n,e){var o,r,i,u={"alloy.base.behaviour":t.events};return o=e,r=t.eventOrder,i=nu(o,n,u),ru(i,r).getOrDie()},Xu=function(t){var e,o,r,i,u,a,c,s,l,f,d,m,g,p=Ni(t),h=p.events,v=n(p,["events"]),b=(e=yn(v,"components").getOr([]),_t(e,Ju)),y=et(et({},v),{events:et(et({},Di),h),components:b});return Xt.value((r=function(){return g},i=Ke(ji),u=de(uu(o=y)),c=(a=Uu(o)).list,s=a.data,l=Wu(u,c,s),f=Lu(l),d=Gu(u,c,s),m=Ke(u.components),g={getSystem:i.get,config:function(t){var n=s;return(pt(n[t.name()])?n[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(o,null,2))})()},hasConfigured:function(t){return pt(s[t.name()])},spec:o,readState:function(t){return s[t]().map(function(t){return t.state.readState()}).getOr("not enabled")},getApis:function(){return u.apis},connect:function(t){i.set(t)},disconnect:function(){i.set(Li(r))},element:f,syncComponents:function(){var t=si(f),n=Rt(t,function(t){return i.get().getByDom(t).fold(function(){return[]},function(t){return[t]})});m.set(n)},components:m.get,events:d}))},Yu=function(t){var n=$e.fromText(t);return qu({element:n})},qu=function(t){var n=me("external.component",Kn([_e("element"),Ie("uid")]),t),e=Ke(Li());n.uid.each(function(t){Pi(n.element,t)});var o={getSystem:e.get,config:ut.none,hasConfigured:Z,connect:function(t){e.set(t)},disconnect:function(){e.set(Li(function(){return o}))},getApis:function(){return{}},element:n.element,spec:t,readState:K("No state"),syncComponents:Y,components:K([]),events:{}};return Xi(o)},Ku=zi,Ju=function(t){return yn(t,Gi).fold(function(){var n=t.hasOwnProperty("uid")?t:et({uid:Ku("")},t);return Xu(n).getOrDie()},function(t){return t})},$u=Xi,Qu=o("height",function(t){var n=t.dom;return Ou(t)?n.getBoundingClientRect().height:n.offsetHeight}),Zu=function(t){return Qu.get(t)},ta=function(t){return Qu.getOuter(t)},na=function(t,n){return{left:t,top:n,translate:function(e,o){return na(t+e,n+o)}}},ea=na,oa=function(t,n){return t!==undefined?t:n!==undefined?n:0},ra=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return ea(e.offsetLeft,e.offsetTop);var i=oa(null==o?void 0:o.pageYOffset,r.scrollTop),u=oa(null==o?void 0:o.pageXOffset,r.scrollLeft),a=oa(r.clientTop,e.clientTop),c=oa(r.clientLeft,e.clientLeft);return ia(t).translate(u-c,i-a)},ia=function(t){var n,e=t.dom,o=e.ownerDocument.body;return o===e?ea(o.offsetLeft,o.offsetTop):Ou(t)?(n=e.getBoundingClientRect(),ea(n.left,n.top)):ea(0,0)},ua=o("width",function(t){return t.dom.offsetWidth}),aa=function(t){return ua.get(t)},ca=function(t){return ua.getOuter(t)},sa=function(t){var n=$e.fromDom(function(t){if(xu()&&gt(t.target)){var n=$e.fromDom(t.target);if(Qr(n)&&Cu(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return Nt(e)}}return ut.from(t.target)}(t).getOr(t.target)),e=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},r=q(o,e);return{target:n,x:t.clientX,y:t.clientY,stop:e,prevent:o,kill:r,raw:t}},la=function(n,e,o,r,i){var u,a,c=(u=o,a=r,function(t){u(t)&&a(sa(t))});return n.dom.addEventListener(e,c,i),{unbind:t(fa,n,e,c,i)}},fa=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},da=function(t){var n=t!==undefined?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return ea(e,o)},ma=function(t,n,e){var o=(e!==undefined?e.dom:document).defaultView;o&&o.scrollTo(t,n)},ga=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},pa=function(t){var n,e,o=t===undefined?window:t,r=o.document,i=da($e.fromDom(r));return e=(n=o)===undefined?window:n,ut.from(e.visualViewport).fold(function(){var t=o.document.documentElement,n=t.clientWidth,e=t.clientHeight;return ga(i.left,i.top,n,e)},function(t){return ga(Math.max(t.pageLeft,i.left),Math.max(t.pageTop,i.top),t.width,t.height)})},ha=function(t,n){return t.view(n).fold(K([]),function(n){var e=t.owner(n),o=ha(t,e);return[n].concat(o)})},va=Object.freeze({__proto__:null,view:function(t){var n;return(t.dom===document?ut.none():ut.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map($e.fromDom)},owner:ei}),ba=function(n){var e,o,r,i,u=$e.fromDom(document),a=da(u);return(e=n,r=(o=va).owner(e),i=ha(o,r),ut.some(i)).fold(t(ra,n),function(t){var e=ia(n),o=Dt(t,function(t,n){var e=ia(n);return{left:t.left+e.left,top:t.top+e.top}},{left:0,top:0});return ea(o.left+e.left+a.left,o.top+e.top+a.top)})},ya=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},xa=function(t){var n=ra(t),e=ca(t),o=ta(t);return ya(n.left,n.top,e,o)},wa=function(t){var n=ba(t),e=ca(t),o=ta(t);return ya(n.left,n.top,e,o)},Sa=function(){return pa(window)},ka=function(t,n,e){for(var o=t.dom,r=pt(e)?e:Z;o.parentNode;){o=o.parentNode;var i=$e.fromDom(o);if(n(i))return ut.some(i);if(r(i))break}return ut.none()},Ca=function(t,n,e){return r(function(t,n){return n(t)},ka,t,n,e)},Oa=function(t,n,e){return Ca(t,n,e).isSome()},_a=function(t,n,e){return ka(t,function(t){return To(t,n)},e)},Ta=function(t,n){return e=n,r=(o=t)===undefined?document:o.dom,Eo(r)?ut.none():ut.from(r.querySelector(e)).map($e.fromDom);var e,o,r},Ea=function(t,n,e){return r(To,_a,t,n,e)},Ba=function(){var t=Mi("aria-owns");return{id:t,link:function(n){Si(n,"aria-owns",t)},unlink:function(t){_i(t,"aria-owns")}}},Da=function(t,n){return Ca(n,function(t){if(!Qr(t))return!1;var n=ki(t,"id");return n!==undefined&&-1<n.indexOf("aria-owns")}).bind(function(t){var n=ki(t,"id"),e=wu(t);return Ta(e,'[aria-owns="'+n+'"]')}).exists(function(n){return Aa(t,n)})},Aa=function(t,n){return Oa(n,function(n){return Bo(n,t.element)},Z)||Da(t,n)},Ma="unknown";(Jt=Kt=Kt||{})[Jt.STOP=0]="STOP",Jt[Jt.NORMAL=1]="NORMAL",Jt[Jt.LOGGING=2]="LOGGING";var Fa,Ia,Ra=Ke({}),Va=["alloy/data/Fields","alloy/debugging/Debugging"],Pa=function(t,n,e){var o,r,i,u;switch(yn(Ra.get(),t).orThunk(function(){var n=ln(Ra.get());return Ut(n,function(n){return-1<t.indexOf(n)?ut.some(Ra.get()[n]):ut.none()})}).getOr(Kt.NORMAL)){case Kt.NORMAL:return e(Ha());case Kt.LOGGING:var a=(o=t,r=n,i=[],u=(new Date).getTime(),{logEventCut:function(t,n,e){i.push({outcome:"cut",target:n,purpose:e})},logEventStopped:function(t,n,e){i.push({outcome:"stopped",target:n,purpose:e})},logNoParent:function(t,n,e){i.push({outcome:"no-parent",target:n,purpose:e})},logEventNoHandlers:function(t,n){i.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,e){i.push({outcome:"response",purpose:e,target:n})},write:function(){var t=(new Date).getTime();St(["mousemove","mouseover","mouseout",pr()],o)||console.log(o,{event:o,time:t-u,target:r.dom,sequence:_t(i,function(t){return St(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Ei(t.target)+")":t.outcome})})}}),c=e(a);return a.write(),c;case Kt.STOP:return!0}},Ha=K({logEventCut:Y,logEventStopped:Y,logNoParent:Y,logEventNoHandlers:Y,logEventResponse:Y,write:Y}),za=K([_e("menu"),_e("selectedMenu")]),Na=K([_e("item"),_e("selectedItem")]),La=(K(Jn(Na().concat(za()))),K(Jn(Na()))),ja=Ae("initSize",[_e("numColumns"),_e("numRows")]),Ua=function(){return Ae("markers",[_e("backgroundMenu")].concat(za()).concat(Na()))},Wa=function(t){return Ae("markers",_t(t,_e))},Ga=function(t,n,e){return function(){var t=new Error;if(t.stack!==undefined){var n=t.stack.split("\n");Mt(n,function(t){return 0<t.indexOf("alloy")&&!kt(Va,function(n){return-1<t.indexOf(n)})}).getOr(Ma)}}(),oe(n,n,e,se(function(t){return Xt.value(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(undefined,n)})}))},Xa=function(t){return Ga(0,t,Bn(Y))},Ya=function(t){return Ga(0,t,Bn(ut.none))},qa=function(t){return Ga(0,t,Dn())},Ka=function(t){return Ga(0,t,Dn())},Ja=function(t,n){return qe(t,K(n))},$a=function(t){return qe(t,J)},Qa=K(ja),Za=function(t,n,e,o,r,i){return{x:t,y:n,bubble:e,direction:o,boundsRestriction:r,label:i}},tc=Sn([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),nc=tc.southeast,ec=tc.southwest,oc=tc.northeast,rc=tc.northwest,ic=tc.south,uc=tc.north,ac=tc.east,cc=tc.west,sc=function(t,n){return function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e}(["left","right","top","bottom"],function(e){return yn(n,e).map(function(n){return function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}}(t,n)})})},lc=function(t){return t.x},fc=function(t,n){return t.x+t.width/2-n.width/2},dc=function(t,n){return t.x+t.width-n.width},mc=function(t,n){return t.y-n.height},gc=function(t){return t.y+t.height},pc=function(t,n){return t.y+t.height/2-n.height/2},hc=function(t,n,e){return Za(lc(t),gc(t),e.southeast(),nc(),sc(t,{left:1,top:3}),"layout-se")},vc=function(t,n,e){return Za(dc(t,n),gc(t),e.southwest(),ec(),sc(t,{right:0,top:3}),"layout-sw")},bc=function(t,n,e){return Za(lc(t),mc(t,n),e.northeast(),oc(),sc(t,{left:1,bottom:2}),"layout-ne")},yc=function(t,n,e){return Za(dc(t,n),mc(t,n),e.northwest(),rc(),sc(t,{right:0,bottom:2}),"layout-nw")},xc=function(t,n,e){return Za(fc(t,n),mc(t,n),e.north(),uc(),sc(t,{bottom:2}),"layout-n")},wc=function(t,n,e){return Za(fc(t,n),gc(t),e.south(),ic(),sc(t,{top:3}),"layout-s")},Sc=function(t,n,e){return Za((o=t).x+o.width,pc(t,n),e.east(),ac(),sc(t,{left:0}),"layout-e");var o},kc=function(t,n,e){return Za((o=n,t.x-o.width),pc(t,n),e.west(),cc(),sc(t,{right:1}),"layout-w");var o},Cc=function(){return[hc,vc,bc,yc,wc,xc,Sc,kc]},Oc=function(){return[vc,hc,yc,bc,wc,xc,Sc,kc]},_c=function(){return[bc,yc,hc,vc,xc,wc]},Tc=function(){return[yc,bc,vc,hc,xc,wc]},Ec=function(){return[hc,vc,bc,yc,wc,xc]},Bc=function(){return[vc,hc,yc,bc,wc,xc]},Dc=Object.freeze({__proto__:null,events:function(t){return Vr([zr(cr(),function(n,e){var o,r,i=t.channels,u=ln(i),a=e,c=(o=u,(r=a).universal?o:Bt(o,function(t){return St(r.channels,t)}));Tt(c,function(t){var e=i[t],o=e.schema,r=me("channel["+t+"] data\nReceiver: "+Ei(n.element),o,a.data);e.onReceive(n,r)})})])}}),Ac=[Te("channels",le(Xt.value,Kn([qa("onReceive"),Ne("schema",ve())])))],Mc=function(t,n,e){return qr(function(o){e(o,t,n)})},Fc=function(t,n,e,o,r,i){var u=Kn(t),a=ze(n,[Re("config",Kn(t))]);return Vc(u,a,n,e,o,r,i)},Ic=function(t,n,e){var o,r,i,u,a,c;return o=function(o){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var u=[o].concat(r);return o.config({name:K(t)}).fold(function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+e)},function(t){var e=Array.prototype.slice.call(u,1);return n.apply(undefined,[o,t.config,t.state].concat(e))})},r=e,u=(i=n.toString()).indexOf(")")+1,a=i.indexOf("("),c=i.substring(a+1,u-1).split(/,\s*/),o.toFunctionAnnotation=function(){return{name:r,parameters:Ui(c.slice(0,1).concat(c.slice(3)))}},o},Rc=function(t){return{key:t,value:undefined}},Vc=function(n,e,o,r,i,u,a){var c=function(t){return wn(t,o)?t[o]():ut.none()},s=mn(i,function(t,n){return Ic(o,t,n)}),l=mn(u,Wi),f=et(et(et({},l),s),{revoke:t(Rc,o),config:function(t){var e=me(o+"-config",n,t);return{key:o,value:{config:e,me:f,configAsRaw:Tn(function(){return me(o+"-config",n,t)}),initialConfig:t,state:a}}},schema:function(){return e},exhibit:function(t,n){return c(t).bind(function(t){return yn(r,"exhibit").map(function(e){return e(n,t.config,t.state)})}).getOr($i({}))},name:function(){return o},handlers:function(t){return c(t).map(function(t){return yn(r,"events").getOr(function(){return{}})(t.config,t.state)}).getOr({})}});return f},Pc=Pn,Hc=Kn([_e("fields"),_e("name"),Ne("active",{}),Ne("apis",{}),Ne("state",qi),Ne("extra",{})]),zc=function(t){var n=me("Creating behaviour: "+t.name,Hc,t);return Fc(n.fields,n.name,n.active,n.apis,n.extra,n.state)},Nc=Kn([_e("branchKey"),_e("branches"),_e("name"),Ne("active",{}),Ne("apis",{}),Ne("state",qi),Ne("extra",{})]),Lc=function(t){var n,e,o,r,i,u,a,c,s=me("Creating behaviour: "+t.name,Nc,t);return n=he(s.branchKey,s.branches),e=s.name,o=s.active,r=s.apis,i=s.extra,u=s.state,c=ze(e,[Re("config",a=n)]),Vc(a,c,e,o,r,i,u)},jc=K(undefined),Uc=zc({fields:Ac,name:"receiving",active:Dc}),Wc=Object.freeze({__proto__:null,exhibit:function(t,n){return $i({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),Gc=function(t){return t.dom.focus()},Xc=function(t){return void 0===t&&(t=$e.fromDom(document)),ut.from(t.dom.activeElement).map($e.fromDom)},Yc=function(t){return Xc(wu(t)).filter(function(n){return t.dom.contains(n.dom)})},qc=function(t,n){var e=wu(n),o=Xc(e).bind(function(t){var e,o,r=function(n){return Bo(t,n)};return r(n)?ut.some(n):(e=r,(o=function(t){for(var n=0;n<t.childNodes.length;n++){var r=$e.fromDom(t.childNodes[n]);if(e(r))return ut.some(r);var i=o(t.childNodes[n]);if(i.isSome())return i}return ut.none()})(n.dom))}),r=t(n);return o.each(function(t){Xc(e).filter(function(n){return Bo(n,t)}).fold(function(){Gc(t)},Y)}),r},Kc=function(t,n,e,o,r){return{position:t,left:n,top:e,right:o,bottom:r}},Jc=function(t,n){var e=function(t){return t+"px"};Mu(t,{position:ut.some(n.position),left:n.left.map(e),top:n.top.map(e),right:n.right.map(e),bottom:n.bottom.map(e)})},$c=Sn([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Qc=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g=n.x-e,p=n.y-o,h=r-(g+n.width),v=i-(p+n.height),b=ut.some(g),y=ut.some(p),x=ut.some(h),w=ut.some(v),S=ut.none();return u=function(){return Kc(t,b,y,S,S)},a=function(){return Kc(t,S,y,x,S)},c=function(){return Kc(t,b,S,S,w)},s=function(){return Kc(t,S,S,x,w)},l=function(){return Kc(t,b,y,S,S)},f=function(){return Kc(t,b,S,S,w)},d=function(){return Kc(t,b,y,S,S)},m=function(){return Kc(t,S,y,x,S)},n.direction.fold(u,a,c,s,l,f,d,m)},Zc=function(n,e){var o=t(ba,e),r=n.fold(o,o,function(){var t=da();return ba(e).translate(-t.left,-t.top)}),i=ca(e),u=ta(e);return ya(r.left,r.top,i,u)},ts=function(t,n,e){var o=ea(n,e);return t.fold(K(o),K(o),function(){var t=da();return o.translate(-t.left,-t.top)})},ns=($c.none,$c.relative),es=$c.fixed,os=function(t,n,e,o){var r=t+n;return o<r?e:r<e?o:r},rs=function(t,n,e){return Math.min(Math.max(t,n),e)},is=Sn([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),us=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y,x,w,S,k,C,O,_,T,E,B,D,A,M,F,I,R,V=t.x,P=t.y,H=t.bubble.offset,z=H.left,N=H.top,L=(r=o,i=t.boundsRestriction,u=H,c=(a=function(t,n){var e="top"===t||"bottom"===t?u.top:u.left;return yn(i,t).bind(J).bind(function(e){return"left"===t||"top"===t?n<=e?ut.some(e):ut.none():e<=n?ut.some(e):ut.none()}).map(function(t){return t+e}).getOr(n)})("left",r.x),s=a("top",r.y),l=a("right",r.right),f=a("bottom",r.bottom),ya(c,s,l-c,f-s)),j=L.y,U=L.bottom,W=L.x,G=L.right,X=P+N,Y=(d=V+z,m=X,g=n,p=e,v=(h=L).x,b=h.y,y=h.width,x=h.height,S=b<=m,k=(w=v<=d)&&S,C=d+g<=v+y&&m+p<=b+x,O=Math.abs(Math.min(g,w?v+y-d:v-(d+g))),_=Math.abs(Math.min(p,S?b+x-m:b-(m+p))),T=Math.max(h.x,h.right-g),E=Math.max(h.y,h.bottom-p),{originInBounds:k,sizeInBounds:C,limitX:rs(d,h.x,T),limitY:rs(m,h.y,E),deltaW:O,deltaH:_}),q=Y.originInBounds,$=Y.sizeInBounds,Q=Y.limitX,Z=Y.limitY,tt=Y.deltaW,nt=Y.deltaH,et=K(Z+nt-j),ot=(D=B=K(U-Z),A=et,t.direction.fold(B,B,A,A,B,A,D,D)),rt=K(Q+tt-W),it=K(G-Q),at={x:Q,y:Z,width:tt,height:nt,maxHeight:ot,maxWidth:(M=t.direction,I=F=it,R=rt,M.fold(F,R,F,R,I,I,F,R)),direction:t.direction,classes:{on:t.bubble.classesOn,off:t.bubble.classesOff},label:t.label,candidateYforTest:X};return q&&$?is.fit(at):is.nofit(at,tt,nt)},as=function(n,e,o,r){Pu(e,"max-height"),Pu(e,"max-width");var i,u,a,c,s,l,f,d,m,g={width:ca(i=e),height:ta(i)};return u=r.preference,a=n,c=g,s=o,l=r.bounds,f=c.width,d=c.height,m=function(t,n,e,o){var r=t(a,c,s);return us(r,f,d,l).fold(is.fit,function(t,r,i){return o<i||e<r?is.nofit(t,r,i):is.nofit(n,e,o)})},At(u,function(n,e){var o=t(m,e);return n.fold(is.fit,o)},is.nofit({x:a.x,y:a.y,width:c.width,height:c.height,maxHeight:c.height,maxWidth:c.width,direction:nc(),classes:{on:[],off:[]},label:"none",candidateYforTest:a.y},-1,-1)).fold(J,J)},cs=function(t,n,e){var o,r;Jc(t,(o=e.origin,r=n,o.fold(function(){return Kc("absolute",ut.some(r.x),ut.some(r.y),ut.none(),ut.none())},function(t,n,e,o){return Qc("absolute",r,t,n,e,o)},function(t,n,e,o){return Qc("fixed",r,t,n,e,o)})))},ss=function(t,n){var e,o,r;e=t,o=Math.floor(n),r=Qu.max(e,o,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]),Du(e,"max-height",r+"px")},ls=K(function(t,n){ss(t,n),Au(t,{"overflow-x":"hidden","overflow-y":"auto"})}),fs=K(function(t,n){ss(t,n)}),ds=function(t,n,e){return t[n]===undefined?e:t[n]},ms=function(t,n,e,o,r,i){var u,a=ds(i,"maxHeightFunction",ls()),c=ds(i,"maxWidthFunction",Y),s=t.anchorBox,l=t.origin,f={bounds:(u=l,r.fold(function(){return u.fold(Sa,Sa,ya)},function(t){return u.fold(t,t,function(){var n=t(),e=ts(u,n.x,n.y);return ya(e.left,e.top,n.width,n.height)})})),origin:l,preference:o,maxHeightFunction:a,maxWidthFunction:c};gs(s,n,e,f)},gs=function(t,n,e,o){var r,i,u,a,c,s,l=as(t,n,e,o);cs(n,l,o),r=n,i=l.classes,hu(r,i.off),pu(r,i.on),u=n,a=l,(0,o.maxHeightFunction)(u,a.maxHeight),c=n,s=l,(0,o.maxWidthFunction)(c,s.maxWidth)},ps=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],hs=function(t,n,e){var o=function(t){return yn(e,t).getOr([])},r=function(t,n,e){var r=Ht(ps,e);return{offset:ea(t,n),classesOn:Rt(e,o),classesOff:Rt(r,o)}};return{southeast:function(){return r(-t,n,["top","alignLeft"])},southwest:function(){return r(t,n,["top","alignRight"])},south:function(){return r(-t/2,n,["top","alignCentre"])},northeast:function(){return r(-t,-n,["bottom","alignLeft"])},northwest:function(){return r(t,-n,["bottom","alignRight"])},north:function(){return r(-t/2,-n,["bottom","alignCentre"])},east:function(){return r(t,-n/2,["valignCentre","left"])},west:function(){return r(-t,-n/2,["valignCentre","right"])},innerNorthwest:function(){return r(-t,n,["top","alignRight"])},innerNortheast:function(){return r(t,n,["top","alignLeft"])},innerNorth:function(){return r(-t/2,n,["top","alignCentre"])},innerSouthwest:function(){return r(-t,-n,["bottom","alignRight"])},innerSoutheast:function(){return r(t,-n,["bottom","alignLeft"])},innerSouth:function(){return r(-t/2,-n,["bottom","alignCentre"])},innerWest:function(){return r(t,-n/2,["valignCentre","right"])},innerEast:function(){
return r(-t,-n/2,["valignCentre","left"])}}},vs=function(){return hs(0,0,{})},bs=function(t,n){return function(e){return"rtl"===ys(e)?n:t}},ys=function(t){return"rtl"===Fu(t,"direction")?"rtl":"ltr"};(Ia=Fa=Fa||{}).TopToBottom="toptobottom",Ia.BottomToTop="bottomtotop";var xs="data-alloy-vertical-dir",ws=function(t){return Oa(t,function(t){return Qr(t)&&ki(t,"data-alloy-vertical-dir")===Fa.BottomToTop})},Ss=function(){return ze("layouts",[_e("onLtr"),_e("onRtl"),Ie("onBottomLtr"),Ie("onBottomRtl")])},ks=function(t,n,e,o,r,i,u){var a=u.map(ws).getOr(!1),c=n.layouts.map(function(n){return n.onLtr(t)}),s=n.layouts.map(function(n){return n.onRtl(t)}),l=a?n.layouts.bind(function(n){return n.onBottomLtr.map(function(n){return n(t)})}).or(c).getOr(r):c.getOr(e),f=a?n.layouts.bind(function(n){return n.onBottomRtl.map(function(n){return n(t)})}).or(s).getOr(i):s.getOr(o);return bs(l,f)(t)},Cs=[_e("hotspot"),Ie("bubble"),Ne("overrides",{}),Ss(),Ja("placement",function(t,n,e){var o=n.hotspot,r=Zc(e,o.element),i=ks(t.element,n,Ec(),Bc(),_c(),Tc(),ut.some(n.hotspot.element));return ut.some({anchorBox:r,bubble:n.bubble.getOr(vs()),overrides:n.overrides,layouts:i,placer:ut.none()})})],Os=[_e("x"),_e("y"),Ne("height",0),Ne("width",0),Ne("bubble",vs()),Ne("overrides",{}),Ss(),Ja("placement",function(t,n,e){var o=ts(e,n.x,n.y),r=ya(o.left,o.top,n.width,n.height),i=ks(t.element,n,Cc(),Oc(),Cc(),Oc(),ut.none());return ut.some({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:ut.none()})})],_s=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},Ts=Sn([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Es=(Ts.before,Ts.on,Ts.after,function(t){return t.fold(J,J,J)}),Bs=Sn([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ds={domRange:Bs.domRange,relative:Bs.relative,exact:Bs.exact,exactFromRange:function(t){return Bs.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var n=t.match({domRange:function(t){return $e.fromDom(t.startContainer)},relative:function(t){return Es(t)},exact:function(t){return t}});return ii(n)},range:_s},As=function(t,n,e){var o,r,i=t.document.createRange();return o=i,n.fold(function(t){o.setStartBefore(t.dom)},function(t,n){o.setStart(t.dom,n)},function(t){o.setStartAfter(t.dom)}),r=i,e.fold(function(t){r.setEndBefore(t.dom)},function(t,n){r.setEnd(t.dom,n)},function(t){r.setEndAfter(t.dom)}),i},Ms=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},Fs=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},Is=Sn([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Rs=function(t,n,e){return n($e.fromDom(e.startContainer),e.startOffset,$e.fromDom(e.endContainer),e.endOffset)},Vs=function(t,n){var e,o,r,i=(e=t,n.match({domRange:function(t){return{ltr:K(t),rtl:ut.none}},relative:function(t,n){return{ltr:Tn(function(){return As(e,t,n)}),rtl:Tn(function(){return ut.some(As(e,n,t))})}},exact:function(t,n,o,r){return{ltr:Tn(function(){return Ms(e,t,n,o,r)}),rtl:Tn(function(){return ut.some(Ms(e,o,r,t,n))})}}}));return(r=(o=i).ltr()).collapsed?o.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return Is.rtl($e.fromDom(t.endContainer),t.endOffset,$e.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return Rs(0,Is.ltr,r)}):Rs(0,Is.ltr,r)};Is.ltr,Is.rtl;var Ps,Hs,zs,Ns,Ls,js=(Ps=Zr,Hs="text",{get:function(t){if(!Ps(t))throw new Error("Can only get "+Hs+" value of a "+Hs+" node");return zs(t).getOr("")},getOption:zs=function(t){return Ps(t)?ut.from(t.dom.nodeValue):ut.none()},set:function(t,n){if(!Ps(t))throw new Error("Can only set raw "+Hs+" value of a "+Hs+" node");t.dom.nodeValue=n}}),Us=function(t){return js.getOption(t)},Ws=["img","br"],Gs=function(t){return Us(t).filter(function(t){return 0!==t.trim().length||-1<t.indexOf("\xa0")}).isSome()||St(Ws,Jr(t))},Xs=function(t,n){var e=function(t){for(var o=si(t),r=o.length-1;0<=r;r--){var i=o[r];if(n(i))return ut.some(i);var u=e(i);if(u.isSome())return u}return ut.none()};return e(t)},Ys=function(t,n){return e=n,r=(o=t)===undefined?document:o.dom,Eo(r)?[]:_t(r.querySelectorAll(e),$e.fromDom);var e,o,r},qs=function(t,n,e,o){var r,i,u,a,c,s=(i=n,u=e,a=o,(c=ei(r=t).dom.createRange()).setStart(r.dom,i),c.setEnd(u.dom,a),c),l=Bo(t,e)&&n===o;return s.collapsed&&!l},Ks=function(t){if(0<t.rangeCount){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return ut.some(_s($e.fromDom(n.startContainer),n.startOffset,$e.fromDom(e.endContainer),e.endOffset))}return ut.none()},Js=function(t){if(null===t.anchorNode||null===t.focusNode)return Ks(t);var n=$e.fromDom(t.anchorNode),e=$e.fromDom(t.focusNode);return qs(n,t.anchorOffset,e,t.focusOffset)?ut.some(_s(n,t.anchorOffset,e,t.focusOffset)):Ks(t)},$s=function(t){return n=t,ut.from(n.getSelection()).filter(function(t){return 0<t.rangeCount}).bind(Js);var n},Qs=function(t,n){var e,o,r,i;return 0<(i=0<(r=(o=Vs(e=t,n).match({ltr:function(t,n,o,r){var i=e.document.createRange();return i.setStart(t.dom,n),i.setEnd(o.dom,r),i},rtl:function(t,n,o,r){var i=e.document.createRange();return i.setStart(o.dom,r),i.setEnd(t.dom,n),i}})).getClientRects()).length?r[0]:o.getBoundingClientRect()).width||0<i.height?ut.some(i).map(Fs):ut.none()},Zs=function(t,n){return{element:t,offset:n}},tl=function(t,n){var e=si(t);if(0===e.length)return Zs(t,n);if(n<e.length)return Zs(e[n],0);var o,r=e[e.length-1],i=Zr(r)?(o=r,js.get(o).length):si(r).length;return Zs(r,i)},nl=Sn([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),el=function(t){return t.fold(J,function(t,n,e){return t.translate(-n,-e)})},ol=function(t){return t.fold(J,J)},rl=function(t){return At(t,function(t,n){return t.translate(n.left,n.top)},ea(0,0))},il=function(t){var n=_t(t,ol);return rl(n)},ul=nl.screen,al=nl.absolute,cl=function(t,n,e){var o,r,i=ei(t.element),u=da(i),a=(o=t,r=ii(e.root).dom,ut.from(r.frameElement).map($e.fromDom).filter(function(t){var n=ei(t),e=ei(o.element);return Bo(n,e)}).map(ra).getOr(u));return al(a,u.left,u.top)},sl=function(t,n,e,o){var r=t,i=n,u=e,a=o;t<0&&(r=0,u=e+t),n<0&&(i=0,a=o+n);var c=ul(ea(r,i));return ut.some({point:c,width:u,height:a})},ll=function(t,n,e,o,r){return t.map(function(t){var i,u,a,c=[n,t.point],s=(i=function(){return il(c)},u=function(){return il(c)},a=function(){return t=_t(c,el),rl(t);var t},o.fold(i,u,a)),l={x:s.left,y:s.top,width:t.width,height:t.height},f=(e.showAbove?_c:Ec)(),d=(e.showAbove?Tc:Bc)(),m=ks(r,e,f,d,f,d,ut.none());return{anchorBox:l,bubble:e.bubble.getOr(vs()),overrides:e.overrides,layouts:m,placer:ut.none()}})},fl=function(t,n){return Zr(t)?{element:t,offset:n}:tl(t,n)},dl=function(t,n){return n.getSelection.getOrThunk(function(){return function(){return $s(t)}})().map(function(t){var n=fl(t.start,t.soffset),e=fl(t.finish,t.foffset);return Ds.range(n.element,n.offset,e.element,e.offset)})},ml=[Ie("getSelection"),_e("root"),Ie("bubble"),Ss(),Ne("overrides",{}),Ne("showAbove",!1),Ja("placement",function(t,n,e){var o=ii(n.root).dom,r=cl(t,0,n),i=dl(o,n).bind(function(t){return Qs(o,Ds.exactFromRange(t)).orThunk(function(){var n=$e.fromText("\ufeff");return fi(t.start,n),Qs(o,Ds.exact(n,0,n,1)).map(function(t){return vi(n),t})}).bind(function(t){return sl(t.left,t.top,t.width,t.height)})}),u=dl(o,n).bind(function(t){return Qr(t.start)?ut.some(t.start):ai(t.start)}).getOr(t.element);return ll(i,r,n,e,u)})],gl=[_e("node"),_e("root"),Ie("bubble"),Ss(),Ne("overrides",{}),Ne("showAbove",!1),Ja("placement",function(t,n,e){var o=cl(t,0,n);return n.node.bind(function(r){var i=r.dom.getBoundingClientRect(),u=sl(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element);return ll(u,o,n,e,a)})})],pl=function(t){return t.x+t.width},hl=function(t,n){return t.x-n.width},vl=function(t,n){return t.y-n.height+t.height},bl=function(t){return t.y},yl=function(t,n,e){return Za(pl(t),bl(t),e.southeast(),nc(),sc(t,{left:0,top:2}),"link-layout-se")},xl=function(t,n,e){return Za(hl(t,n),bl(t),e.southwest(),ec(),sc(t,{right:1,top:2}),"link-layout-sw")},wl=function(t,n,e){return Za(pl(t),vl(t,n),e.northeast(),oc(),sc(t,{left:0,bottom:3}),"link-layout-ne")},Sl=function(t,n,e){return Za(hl(t,n),vl(t,n),e.northwest(),rc(),sc(t,{right:1,bottom:3}),"link-layout-nw")},kl=function(){return[yl,xl,wl,Sl]},Cl=function(){return[xl,yl,Sl,wl]},Ol=[_e("item"),Ss(),Ne("overrides",{}),Ja("placement",function(t,n,e){var o=Zc(e,n.item.element),r=ks(t.element,n,kl(),Cl(),kl(),Cl(),ut.none());return ut.some({anchorBox:o,bubble:vs(),overrides:n.overrides,layouts:r,placer:ut.none()})})],_l=he("anchor",{selection:ml,node:gl,hotspot:Cs,submenu:Ol,makeshift:Os}),Tl=function(t,n,e,o,r){var i={anchorBox:e.anchorBox,origin:n};ms(i,r.element,e.bubble,e.layouts,o,e.overrides)},El=function(t,n,e,o,r,i){var u=i.map(xa);return Bl(t,n,e,o,r,u)},Bl=function(t,n,e,o,r,i){var u=me("positioning anchor.info",_l,o);qc(function(){Du(r.element,"position","fixed");var e=Ru(r.element,"visibility");Du(r.element,"visibility","hidden");var o,a,c,s,l=n.useFixed()?(s=document.documentElement,es(0,0,s.clientWidth,s.clientHeight)):(a=ra((o=t).element),c=o.element.dom.getBoundingClientRect(),ns(a.left,a.top,c.width,c.height)),f=u.placement,d=i.map(K).or(n.getBounds);f(t,u,l).each(function(n){n.placer.getOr(Tl)(t,l,n,d,r)}),e.fold(function(){Pu(r.element,"visibility")},function(t){Du(r.element,"visibility",t)}),Ru(r.element,"left").isNone()&&Ru(r.element,"top").isNone()&&Ru(r.element,"right").isNone()&&Ru(r.element,"bottom").isNone()&&Ru(r.element,"position").is("fixed")&&Pu(r.element,"position")},r.element)},Dl=Object.freeze({__proto__:null,position:function(t,n,e,o,r){El(t,n,e,o,r,ut.none())},positionWithin:El,positionWithinBounds:Bl,getMode:function(t,n){return n.useFixed()?"fixed":"absolute"}}),Al=[Ne("useFixed",Z),Ie("getBounds")],Ml=zc({fields:Al,name:"positioning",active:Wc,apis:Dl}),Fl=function(t){Dr(t,wr());var n=t.components();Tt(n,Fl)},Il=function(t){var n=t.components();Tt(n,Il),Dr(t,xr())},Rl=function(t,n){gi(t.element,n.element)},Vl=function(t,n){var e,o=t.components();Tt((e=t).components(),function(t){return vi(t.element)}),hi(e.element),e.syncComponents();var r=Ht(o,n);Tt(r,function(n){Fl(n),t.getSystem().removeFromWorld(n)}),Tt(n,function(n){n.getSystem().isConnected()?Rl(t,n):(t.getSystem().addToWorld(n),Rl(t,n),Ou(t.element)&&Il(n)),t.syncComponents()})},Pl=function(t,n){Hl(t,n,gi)},Hl=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),Ou(t.element)&&Il(n),t.syncComponents()},zl=function(t){Fl(t),vi(t.element),t.getSystem().removeFromWorld(t)},Nl=function(t){var n=ui(t.element).bind(function(n){return t.getSystem().getByDom(n).toOptional()});zl(t),n.each(function(t){t.syncComponents()})},Ll=function(t){var n=t.components();Tt(n,zl),hi(t.element),t.syncComponents()},jl=function(t,n){Ul(t,n,gi)},Ul=function(t,n,e){e(t,n.element);var o=si(n.element);Tt(o,function(t){n.getByDom(t).each(Il)})},Wl=function(t){var n=si(t.element);Tt(n,function(n){t.getByDom(n).each(Fl)}),vi(t.element)},Gl=function(t,n,e,o){e.get().each(function(){Ll(t)});var r=n.getAttachPoint(t);Pl(r,t);var i=t.getSystem().build(o);return Pl(t,i),e.set(i),i},Xl=function(t,n,e,o){var r=Gl(t,n,e,o);return n.onOpen(t,r),r},Yl=function(t,n,e){e.get().each(function(o){Ll(t),Nl(t),n.onClose(t,o),e.clear()})},ql=function(t,n,e){return e.isOpen()},Kl=function(t,n){var e,o,r,i,u=n.getAttachPoint(t);Du(t.element,"position",Ml.getMode(u)),e=t,o="visibility",r=n.cloakVisibilityAttr,i="hidden",Ru(e.element,o).fold(function(){_i(e.element,r)},function(t){Si(e.element,r,t)}),Du(e.element,o,i)},Jl=function(t,n){var e,o,r,i;e=t.element,kt(["top","left","right","bottom"],function(t){return Ru(e,t).isSome()})||Pu(t.element,"position"),o=t,r="visibility",i=n.cloakVisibilityAttr,Ci(o.element,i).fold(function(){return Pu(o.element,r)},function(t){return Du(o.element,r,t)})},$l=Object.freeze({__proto__:null,cloak:Kl,decloak:Jl,open:Xl,openWhileCloaked:function(t,n,e,o,r){Kl(t,n),Xl(t,n,e,o),r(),Jl(t,n)},close:Yl,isOpen:ql,isPartOf:function(t,n,e,o){return ql(0,0,e)&&e.get().exists(function(e){return n.isPartOf(t,e,o)})},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map(function(){return Gl(t,n,e,o)})}}),Ql=Object.freeze({__proto__:null,events:function(t,n){return Vr([zr(mr(),function(e){Yl(e,t,n)})])}}),Zl=[Xa("onOpen"),Xa("onClose"),_e("isPartOf"),_e("getAttachPoint"),Ne("cloakVisibilityAttr","data-precloak-visibility")],tf=zc({fields:Zl,name:"sandboxing",active:Ql,apis:$l,state:Object.freeze({__proto__:null,init:function(){var t=Ke(ut.none()),n=K("not-implemented");return Ki({readState:n,isOpen:function(){return t.get().isSome()},clear:function(){t.set(ut.none())},set:function(n){t.set(ut.some(n))},get:function(){return t.get()}})}})}),nf=K("dismiss.popups"),ef=K("reposition.popups"),of=K("mouse.released"),rf=Kn([Ne("isExtraPart",Z),ze("fireEventInstead",[Ne("event",Sr())])]),uf=function(t){var n=me("Dismissal",rf,t),e={};return e[nf()]={schema:Kn([_e("target")]),onReceive:function(t,e){tf.isOpen(t)&&(tf.isPartOf(t,e.target)||n.isExtraPart(t,e.target)||n.fireEventInstead.fold(function(){return tf.close(t)},function(n){return Dr(t,n.event)}))}},e},af=Kn([ze("fireEventInstead",[Ne("event",kr())]),De("doReposition")]),cf=function(t){var n=me("Reposition",af,t),e={};return e[ef()]={onReceive:function(t){tf.isOpen(t)&&n.fireEventInstead.fold(function(){return n.doReposition(t)},function(n){return Dr(t,n.event)})}},e},sf=function(t,n,e){n.store.manager.onLoad(t,n,e)},lf=function(t,n,e){n.store.manager.onUnload(t,n,e)},ff=Object.freeze({__proto__:null,onLoad:sf,onUnload:lf,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),df=Object.freeze({__proto__:null,events:function(t,n){var e=t.resetOnDom?[Xr(function(e){sf(e,t,n)}),Yr(function(e){lf(e,t,n)})]:[Mc(t,n,sf)];return Vr(e)}}),mf=function(){var t=Ke(null);return Ki({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},gf=function(){var t=Ke({}),n=Ke({});return Ki({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return yn(t.get(),e).orThunk(function(){return yn(n.get(),e)})},update:function(e){var o=t.get(),r=n.get(),i={},u={};Tt(e,function(t){i[t.value]=t,yn(t,"meta").each(function(n){yn(n,"text").each(function(n){u[n]=t})})}),t.set(et(et({},o),i)),n.set(et(et({},r),u))},clear:function(){t.set({}),n.set({})}})},pf=Object.freeze({__proto__:null,memory:mf,dataset:gf,manual:function(){return Ki({readState:function(){}})},init:function(t){return t.store.manager.state(t)}}),hf=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},vf=[Ie("initialValue"),_e("getFallbackEntry"),_e("getDataKey"),_e("setValue"),Ja("manager",{setValue:hf,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).fold(function(){return o.getFallbackEntry(r)},function(t){return t})},onLoad:function(t,n,e){n.store.initialValue.each(function(o){hf(t,n,e,o)})},onUnload:function(t,n,e){e.clear()},state:gf})],bf=[_e("getValue"),Ne("setValue",Y),Ie("initialValue"),Ja("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n){return n.store.getValue(t)},onLoad:function(t,n){n.store.initialValue.each(function(e){n.store.setValue(t,e)})},onUnload:Y,state:qi.init})],yf=[Ie("initialValue"),Ja("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each(function(t){e.isNotSet()&&e.set(t)})},onUnload:function(t,n,e){e.clear()},state:mf})],xf=[Le("store",{mode:"memory"},he("mode",{memory:yf,manual:bf,dataset:vf})),Xa("onSetValue"),Ne("resetOnDom",!1)],wf=zc({fields:xf,name:"representing",active:df,apis:ff,extra:{setValueFrom:function(t,n){var e=wf.getValue(n);wf.setValue(t,e)}},state:pf}),Sf=function(t,n){return Ye(t,{},_t(n,function(n){return e=n.name(),o="Cannot configure "+n.name()+" for "+t,oe(e,e,An(),qn(function(){return rn("The field: "+e+" is forbidden. "+o)}));var e,o}).concat([qe("dump",J)]))},kf=function(t){return t.dump},Cf=function(t,n){return et(et({},t.dump),Pc(n))},Of=Sf,_f=Cf,Tf="placeholder",Ef=Sn([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Bf=function(t){return xn(t,"uiType")},Df=function(t,n,e,o){return Bf(e)&&e.uiType===Tf?(i=e,u=o,(r=t).exists(function(t){return t!==i.owner})?Ef.single(!0,K(i)):yn(u,i.name).fold(function(){throw new Error("Unknown placeholder component: "+i.name+"\nKnown: ["+ln(u)+"]\nNamespace: "+r.getOr("none")+"\nSpec: "+JSON.stringify(i,null,2))},function(t){return t.replace()})):Ef.single(!1,K(e));var r,i,u},Af=function(t,n,e,o){return Df(t,0,e,o).fold(function(r,i){var u=Bf(e)?i(n,e.config,e.validated):i(n),a=yn(u,"components").getOr([]),c=Rt(a,function(e){return Af(t,n,e,o)});return[et(et({},u),{components:c})]},function(t,o){if(Bf(e)){var r=o(n,e.config,e.validated);return e.validated.preprocess.getOr(J)(r)}return o(n)})},Mf=function(t,n,e,o){var r,i,u,a=mn(o,function(t,n){return o=t,r=!1,{name:K(e=n),required:function(){return o.fold(function(t){return t},function(t){return t})},used:function(){return r},replace:function(){if(r)throw new Error("Trying to use the same placeholder more than once: "+e);return r=!0,o}};var e,o,r}),c=(r=t,i=n,u=a,Rt(e,function(t){return Af(r,i,t,u)}));return dn(a,function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))}),c},Ff=Ef.single,If=Ef.multiple,Rf=K(Tf),Vf=Sn([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Pf=Ne("factory",{sketch:J}),Hf=Ne("schema",[]),zf=_e("name"),Nf=oe("pname","pname",Mn(function(t){return"<alloy."+Mi(t.name)+">"}),ve()),Lf=qe("schema",function(){return[Ie("preprocess")]}),jf=Ne("defaults",K({})),Uf=Ne("overrides",K({})),Wf=Jn([Pf,Hf,zf,Nf,jf,Uf]),Gf=Jn([Pf,Hf,zf,jf,Uf]),Xf=Jn([Pf,Hf,zf,Nf,jf,Uf]),Yf=Jn([Pf,Lf,zf,_e("unit"),Nf,jf,Uf]),qf=function(t){return t.fold(ut.some,ut.none,ut.some,ut.some)},Kf=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},Jf=function(t,n){return function(e){var o=me("Converting part type",n,e);return t(o)}},$f=Jf(Vf.required,Wf),Qf=Jf(Vf.external,Gf),Zf=Jf(Vf.optional,Xf),td=Jf(Vf.group,Yf),nd=K("entirety"),ed=Object.freeze({__proto__:null,required:$f,external:Qf,optional:Zf,group:td,asNamedPart:qf,name:Kf,asCommon:function(t){return t.fold(J,J,J,J)},original:nd}),od=function(t,n,e,o){return On(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},rd=function(t,n){var e={};return Tt(n,function(n){qf(n).each(function(n){var o=id(t,n.pname);e[n.name]=function(e){var r=me("Part: "+n.name+" in "+t,Jn(n.schema),e);return et(et({},o),{config:e,validated:r})}})}),e},id=function(t,n){return{uiType:Rf(),owner:t,name:n}},ud=function(t,n,e){return{uiType:Rf(),owner:t,name:n,config:e,validated:{}}},ad=function(t){return Rt(t,function(t){return t.fold(ut.none,ut.some,ut.none,ut.none).map(function(t){return Ae(t.name,t.schema.concat([$a(nd())]))}).toArray()})},cd=function(t){return _t(t,Kf)},sd=function(t,n,e){return o=n,r={},i={},Tt(e,function(t){t.fold(function(t){r[t.pname]=Ff(!0,function(n,e,o){return t.factory.sketch(od(n,t,e,o))})},function(t){var n=o.parts[t.name];i[t.name]=K(t.factory.sketch(od(o,t,n[nd()]),n))},function(t){r[t.pname]=Ff(!1,function(n,e,o){return t.factory.sketch(od(n,t,e,o))})},function(t){r[t.pname]=If(!0,function(n,e,o){var r=n[t.name];return _t(r,function(e){return t.factory.sketch(On(t.defaults(n,e,o),e,t.overrides(n,e)))})})})}),{internals:K(r),externals:K(i)};var o,r,i},ld=function(t,n,e){return Mf(ut.some(t),n,n.components,e)},fd=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()},dd=function(t,n,e){return fd(t,n,e).getOrDie("Could not find part: "+e)},md=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return Tt(e,function(t){o[t]=K(i.getByUid(r[t]))}),o},gd=function(t,n){var e=t.getSystem();return mn(n.partUids,function(t){return K(e.getByUid(t))})},pd=function(t){return ln(t.partUids)},hd=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return Tt(e,function(t){o[t]=K(i.getByUid(r[t]).getOrDie())}),o},vd=function(t,n){var e=cd(n);return Pn(_t(e,function(n){return{key:n,value:t+"-"+n}}))},bd=function(t){return oe("partUids","partUids",Fn(function(n){return vd(n.uid,t)}),ve())},yd=Object.freeze({__proto__:null,generate:rd,generateOne:ud,schemas:ad,names:cd,substitutes:sd,components:ld,defaultUids:vd,defaultUidsSchema:bd,getAllParts:gd,getAllPartNames:pd,getPart:fd,getPartOrDie:dd,getParts:md,getPartsOrDie:hd}),xd=function(t,n,e,o,r){var i,u,a=(u=r,(0<(i=o).length?[Ae("parts",i)]:[]).concat([_e("uid"),Ne("dom",{}),Ne("components",[]),$a("originalSpec"),Ne("debug.sketcher",{})]).concat(u));return me(t+" [SpecSchema]",Kn(a.concat(n)),e)},wd=function(t,n,e,o,r){var i=Sd(r),u=ad(e),a=bd(e),c=xd(t,n,i,u,[a]),s=sd(0,c,e);return o(c,ld(t,c,s.internals()),i,s.externals())},Sd=function(t){return xn(t,"uid")?t:et(et({},t),{uid:zi("uid")})},kd=Kn([_e("name"),_e("factory"),_e("configFields"),Ne("apis",{}),Ne("extraApis",{})]),Cd=Kn([_e("name"),_e("factory"),_e("configFields"),_e("partFields"),Ne("apis",{}),Ne("extraApis",{})]),Od=function(t){var n=me("Sketcher for "+t.name,kd,t),e=mn(n.apis,Yi),o=mn(n.extraApis,Wi);return et(et({name:n.name,configFields:n.configFields,sketch:function(t){return e=n.name,o=n.configFields,r=n.factory,i=Sd(t),r(xd(e,o,i,[],[]),i);var e,o,r,i}},e),o)},_d=function(t){var n=me("Sketcher for "+t.name,Cd,t),e=rd(n.name,n.partFields),o=mn(n.apis,Yi),r=mn(n.extraApis,Wi);return et(et({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return wd(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)},Td=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},Ed=function(t){return"input"===Jr(t)&&"radio"!==ki(t,"type")||"textarea"===Jr(t)},Bd=Object.freeze({__proto__:null,getCurrent:function(t,n){return n.find(t)}}),Dd=[_e("find")],Ad=zc({fields:Dd,name:"composing",apis:Bd}),Md=function(t,n,e,o){var r=Ys(t.element,"."+n.highlightClass);Tt(r,function(e){kt(o,function(t){return t.element===e})||(mu(e,n.highlightClass),t.getSystem().getByDom(e).each(function(e){n.onDehighlight(t,e),Dr(e,Br())}))})},Fd=function(t,n,e,o){Md(t,n,0,[o]),Id(t,n,e,o)||(fu(o.element,n.highlightClass),n.onHighlight(t,o),Dr(o,Er()))},Id=function(t,n,e,o){return gu(o.element,n.highlightClass)},Rd=function(t,n,e,o){var r=Ys(t.element,"."+n.itemClass);return ut.from(r[o]).fold(function(){return Xt.error("No element found with index "+o)},t.getSystem().getByDom)},Vd=function(t,n){return Ta(t.element,"."+n.itemClass).bind(function(n){return t.getSystem().getByDom(n).toOptional()})},Pd=function(t,n){var e=Ys(t.element,"."+n.itemClass);return(0<e.length?ut.some(e[e.length-1]):ut.none()).bind(function(n){return t.getSystem().getByDom(n).toOptional()})},Hd=function(t,n,e,o){var r=Ys(t.element,"."+n.itemClass);return Ft(r,function(t){return gu(t,n.highlightClass)}).bind(function(n){var e=os(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()})},zd=function(t,n){var e=Ys(t.element,"."+n.itemClass);return Td(_t(e,function(n){return t.getSystem().getByDom(n).toOptional()}))},Nd=Object.freeze({__proto__:null,dehighlightAll:function(t,n){return Md(t,n,0,[])},dehighlight:function(t,n,e,o){Id(t,n,e,o)&&(mu(o.element,n.highlightClass),n.onDehighlight(t,o),Dr(o,Br()))},highlight:Fd,highlightFirst:function(t,n,e){Vd(t,n).each(function(o){Fd(t,n,e,o)})},highlightLast:function(t,n,e){Pd(t,n).each(function(o){Fd(t,n,e,o)})},highlightAt:function(t,n,e,o){Rd(t,n,e,o).fold(function(t){throw new Error(t)},function(o){Fd(t,n,e,o)})},highlightBy:function(t,n,e,o){var r=zd(t,n);Mt(r,o).each(function(o){Fd(t,n,e,o)})},isHighlighted:Id,getHighlighted:function(t,n){return Ta(t.element,"."+n.highlightClass).bind(function(n){return t.getSystem().getByDom(n).toOptional()})},getFirst:Vd,getLast:Pd,getPrevious:function(t,n){return Hd(t,n,0,-1)},getNext:function(t,n){return Hd(t,n,0,1)},getCandidates:zd}),Ld=[_e("highlightClass"),_e("itemClass"),Xa("onHighlight"),Xa("onDehighlight")],jd=zc({fields:Ld,name:"highlighting",apis:Nd}),Ud=[8],Wd=[9],Gd=[13],Xd=[27],Yd=[32],qd=[37],Kd=[38],Jd=[39],$d=[40],Qd=function(t,n,e){var o=Pt(t.slice(0,n)),r=Pt(t.slice(n+1));return Mt(o.concat(r),e)},Zd=function(t,n,e){var o=Pt(t.slice(0,n));return Mt(o,e)},tm=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return Mt(r.concat(o),e)},nm=function(t,n,e){var o=t.slice(n+1);return Mt(o,e)},em=function(t){return function(n){var e=n.raw;return St(t,e.which)}},om=function(t){return function(n){return Vt(t,function(t){return t(n)})}},rm=function(t){return!0===t.raw.shiftKey},im=function(t){return!0===t.raw.ctrlKey},um=$(rm),am=function(t,n){return{matches:t,classification:n}},cm=function(t,n,e){n.exists(function(t){return e.exists(function(n){return Bo(n,t)})})||Ar(t,Cr(),{prevFocus:n,newFocus:e})},sm=function(){var t=function(t){return Yc(t.element)};return{get:t,set:function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element);var r=t(n);cm(n,o,r)}}},lm=function(){var t=function(t){return jd.getHighlighted(t).map(function(t){return t.element})};return{get:t,set:function(n,e){var o=t(n);n.getSystem().getByDom(e).fold(Y,function(t){jd.highlight(n,t)});var r=t(n);cm(n,o,r)}}};(Ls=Ns=Ns||{}).OnFocusMode="onFocus",Ls.OnEnterOrSpaceMode="onEnterOrSpace",Ls.OnApiMode="onApi";var fm,dm,mm,gm=function(t,n,e,o,r){var i=function(t,n,e,o,r){var i,u;return i=e(t,n,o,r),u=n.event,Mt(i,function(t){return t.matches(u)}).map(function(t){return t.classification}).bind(function(e){return e(t,n,o,r)})},u={schema:function(){return t.concat([Ne("focusManager",sm()),Le("focusInside","onFocus",se(function(t){return St(["onFocus","onEnterOrSpace","onApi"],t)?Xt.value(t):Xt.error("Invalid value for focusInside")})),Ja("handler",u),Ja("state",n),Ja("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==Ns.OnFocusMode?ut.none():r(t).map(function(e){return zr(ir(),function(o,r){e(o,t,n),r.stop()})}),a=[zr(Jo(),function(o,u){i(o,u,e,t,n).fold(function(){var e,i,a;e=o,i=u,a=em(Yd.concat(Gd))(i.event),t.focusInside===Ns.OnEnterOrSpaceMode&&a&&Ro(e,i)&&r(t).each(function(o){o(e,t,n),i.stop()})},function(){u.stop()})}),zr($o(),function(e,r){i(e,r,o,t,n).each(function(){r.stop()})})];return Vr(u.toArray().concat(a))}};return u},pm=function(n){var e=[Ie("onEscape"),Ie("onEnter"),Ne("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Ne("firstTabstop",0),Ne("useTabstopAt",tt),Ie("visibilitySelector")].concat([n]),o=function(t,n){var e=t.visibilitySelector.bind(function(t){return Ea(n,t)}).getOr(n);return 0<Zu(e)},r=function(t,n){var e,r,i;e=n,r=Ys(t.element,e.selector),i=Bt(r,function(t){return o(e,t)}),ut.from(i[e.firstTabstop]).each(function(e){n.focusManager.set(t,e)})},i=function(t,n,e,r,i){return i(n,e,function(t){return o(n=r,e=t)&&n.useTabstopAt(e);var n,e}).fold(function(){return r.cyclic?ut.some(!0):ut.none()},function(n){return r.focusManager.set(t,n),ut.some(!0)})},u=function(n,e,o,r){var u,a,c=Ys(n.element,o.selector);return u=n,(a=o).focusManager.get(u).bind(function(t){return Ea(t,a.selector)}).bind(function(e){return Ft(c,t(Bo,e)).bind(function(t){return i(n,c,t,o,r)})})},a=K([am(om([rm,em(Wd)]),function(t,n,e){var o=e.cyclic?Qd:Zd;return u(t,0,e,o)}),am(em(Wd),function(t,n,e){var o=e.cyclic?tm:nm;return u(t,0,e,o)}),am(em(Xd),function(t,n,e){return e.onEscape.bind(function(e){return e(t,n)})}),am(om([um,em(Gd)]),function(t,n,e){return e.onEnter.bind(function(e){return e(t,n)})})]),c=K([]);return gm(e,qi.init,a,c,function(){return ut.some(r)})},hm=pm(qe("cyclic",Z)),vm=pm(qe("cyclic",tt)),bm=function(t,n,e){return Ed(e)&&em(Yd)(n.event)?ut.none():(Fr(t,e,sr()),ut.some(!0))},ym=function(){return ut.some(!0)},xm=[Ne("execute",bm),Ne("useSpace",!1),Ne("useEnter",!0),Ne("useControlEnter",!1),Ne("useDown",!1)],wm=function(t,n,e){return e.execute(t,n,t.element)},Sm=gm(xm,qi.init,function(t,n,e){var o=e.useSpace&&!Ed(t.element)?Yd:[],r=e.useEnter?Gd:[],i=e.useDown?$d:[],u=o.concat(r).concat(i);return[am(em(u),wm)].concat(e.useControlEnter?[am(om([im,em(Gd)]),wm)]:[])},function(t,n,e){return e.useSpace&&!Ed(t.element)?[am(em(Yd),ym)]:[]},function(){return ut.none()}),km=function(){var t=Ke(ut.none());return Ki({readState:function(){return t.get().map(function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}}).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set(ut.some({numRows:n,numColumns:e}))},getNumRows:function(){return t.get().map(function(t){return t.numRows})},getNumColumns:function(){return t.get().map(function(t){return t.numColumns})}})},Cm=Object.freeze({__proto__:null,flatgrid:km,init:function(t){return t.state(t)}}),Om=function(t){return function(n,e,o,r){var i=t(n.element);return Bm(i,n,e,o,r)}},_m=function(t,n){var e=bs(t,n);return Om(e)},Tm=function(t,n){var e=bs(n,t);return Om(e)},Em=function(t){return function(n,e,o,r){return Bm(t,n,e,o,r)}},Bm=function(t,n,e,o,r){return o.focusManager.get(n).bind(function(e){return t(n.element,e,o,r)}).map(function(t){return o.focusManager.set(n,t),!0})},Dm=Em,Am=Em,Mm=Em,Fm=function(t){return!((n=t.dom).offsetWidth<=0&&n.offsetHeight<=0);var n},Im=function(t,n,e){var o,r=Ys(t,e),i=Bt(r,Fm);return Ft(o=i,function(t){return Bo(t,n)}).map(function(t){return{index:t,candidates:o}})},Rm=function(t,n){return Ft(t,function(t){return Bo(n,t)})},Vm=function(t,n,e,o){return o(Math.floor(n/e),n%e).bind(function(n){var o=n.row*e+n.column;return 0<=o&&o<t.length?ut.some(t[o]):ut.none()})},Pm=function(t,n,e,o,r){return Vm(t,n,o,function(n,i){var u=n===e-1?t.length-n*o:o,a=os(i,r,0,u-1);return ut.some({row:n,column:a})})},Hm=function(t,n,e,o,r){return Vm(t,n,o,function(n,i){var u=os(n,r,0,e-1),a=u===e-1?t.length-u*o:o,c=rs(i,0,a-1);return ut.some({row:u,column:c})})},zm=[_e("selector"),Ne("execute",bm),Ya("onEscape"),Ne("captureTab",!1),Qa()],Nm=function(t,n){Ta(t.element,n.selector).each(function(e){n.focusManager.set(t,e)})},Lm=function(t){return function(n,e,o,r){return Im(n,e,o.selector).bind(function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))})}},jm=function(t,n,e){return e.captureTab?ut.some(!0):ut.none()},Um=Lm(function(t,n,e,o){return Pm(t,n,e,o,-1)}),Wm=Lm(function(t,n,e,o){return Pm(t,n,e,o,1)}),Gm=Lm(function(t,n,e,o){return Hm(t,n,e,o,-1)}),Xm=Lm(function(t,n,e,o){return Hm(t,n,e,o,1)}),Ym=K([am(em(qd),_m(Um,Wm)),am(em(Jd),Tm(Um,Wm)),am(em(Kd),Dm(Gm)),am(em($d),Am(Xm)),am(om([rm,em(Wd)]),jm),am(om([um,em(Wd)]),jm),am(em(Xd),function(t,n,e){return e.onEscape(t,n)}),am(em(Yd.concat(Gd)),function(t,n,e){return o=t,(r=e).focusManager.get(o).bind(function(t){return Ea(t,r.selector)}).bind(function(o){return e.execute(t,n,o)});var o,r})]),qm=K([am(em(Yd),ym)]),Km=gm(zm,km,Ym,qm,function(){return ut.some(Nm)}),Jm=function(t,n,e,o){var r=function(t,n,e){var i,u=os(n,o,0,e.length-1);return u===t?ut.none():(i=e[u],"button"===Jr(i)&&"disabled"===ki(i,"disabled")?r(t,u,e):ut.from(e[u]))};return Im(t,e,n).bind(function(t){var n=t.index,e=t.candidates;return r(n,n,e)})},$m=[_e("selector"),Ne("getInitial",ut.none),Ne("execute",bm),Ya("onEscape"),Ne("executeOnMove",!1),Ne("allowVertical",!0)],Qm=function(t,n,e){return o=t,(r=e).focusManager.get(o).bind(function(t){return Ea(t,r.selector)}).bind(function(o){return e.execute(t,n,o)});var o,r},Zm=function(t,n){n.getInitial(t).orThunk(function(){return Ta(t.element,n.selector)}).each(function(e){n.focusManager.set(t,e)})},tg=function(t,n,e){return Jm(t,e.selector,n,-1)},ng=function(t,n,e){return Jm(t,e.selector,n,1)},eg=function(t){return function(n,e,o,r){return t(n,e,o,r).bind(function(){return o.executeOnMove?Qm(n,e,o):ut.some(!0)})}},og=function(t,n,e){return e.onEscape(t,n)},rg=K([am(em(Yd),ym)]),ig=gm($m,qi.init,function(t,n,e){var o=qd.concat(e.allowVertical?Kd:[]),r=Jd.concat(e.allowVertical?$d:[]);return[am(em(o),eg(_m(tg,ng))),am(em(r),eg(Tm(tg,ng))),am(em(Gd),Qm),am(em(Yd),Qm),am(em(Xd),og)]},rg,function(){return ut.some(Zm)}),ug=function(t,n,e){return ut.from(t[n]).bind(function(t){return ut.from(t[e]).map(function(t){return{rowIndex:n,columnIndex:e,cell:t}})})},ag=function(t,n,e,o){var r=t[n].length,i=os(e,o,0,r-1);return ug(t,n,i)
},cg=function(t,n,e,o){var r=os(e,o,0,t.length-1),i=t[r].length,u=rs(n,0,i-1);return ug(t,r,u)},sg=function(t,n,e,o){var r=t[n].length,i=rs(e+o,0,r-1);return ug(t,n,i)},lg=function(t,n,e,o){var r=rs(e+o,0,t.length-1),i=t[r].length,u=rs(n,0,i-1);return ug(t,r,u)},fg=[Ae("selectors",[_e("row"),_e("cell")]),Ne("cycles",!0),Ne("previousSelector",ut.none),Ne("execute",bm)],dg=function(t,n){n.previousSelector(t).orThunk(function(){var e=n.selectors;return Ta(t.element,e.cell)}).each(function(e){n.focusManager.set(t,e)})},mg=function(t,n){return function(e,o,r){var i=r.cycles?t:n;return Ea(o,r.selectors.row).bind(function(t){var n=Ys(t,r.selectors.cell);return Rm(n,o).bind(function(n){var o=Ys(e,r.selectors.row);return Rm(o,t).bind(function(t){var e,u=(e=r,_t(o,function(t){return Ys(t,e.selectors.cell)}));return i(u,t,n).map(function(t){return t.cell})})})})}},gg=mg(function(t,n,e){return ag(t,n,e,-1)},function(t,n,e){return sg(t,n,e,-1)}),pg=mg(function(t,n,e){return ag(t,n,e,1)},function(t,n,e){return sg(t,n,e,1)}),hg=mg(function(t,n,e){return cg(t,e,n,-1)},function(t,n,e){return lg(t,e,n,-1)}),vg=mg(function(t,n,e){return cg(t,e,n,1)},function(t,n,e){return lg(t,e,n,1)}),bg=K([am(em(qd),_m(gg,pg)),am(em(Jd),Tm(gg,pg)),am(em(Kd),Dm(hg)),am(em($d),Am(vg)),am(em(Yd.concat(Gd)),function(t,n,e){return Yc(t.element).bind(function(o){return e.execute(t,n,o)})})]),yg=K([am(em(Yd),ym)]),xg=gm(fg,qi.init,bg,yg,function(){return ut.some(dg)}),wg=[_e("selector"),Ne("execute",bm),Ne("moveOnTab",!1)],Sg=function(t,n,e){return e.focusManager.get(t).bind(function(o){return e.execute(t,n,o)})},kg=function(t,n){Ta(t.element,n.selector).each(function(e){n.focusManager.set(t,e)})},Cg=function(t,n,e){return Jm(t,e.selector,n,-1)},Og=function(t,n,e){return Jm(t,e.selector,n,1)},_g=K([am(em(Kd),Mm(Cg)),am(em($d),Mm(Og)),am(om([rm,em(Wd)]),function(t,n,e,o){return e.moveOnTab?Mm(Cg)(t,n,e,o):ut.none()}),am(om([um,em(Wd)]),function(t,n,e,o){return e.moveOnTab?Mm(Og)(t,n,e,o):ut.none()}),am(em(Gd),Sg),am(em(Yd),Sg)]),Tg=K([am(em(Yd),ym)]),Eg=gm(wg,qi.init,_g,Tg,function(){return ut.some(kg)}),Bg=[Ya("onSpace"),Ya("onEnter"),Ya("onShiftEnter"),Ya("onLeft"),Ya("onRight"),Ya("onTab"),Ya("onShiftTab"),Ya("onUp"),Ya("onDown"),Ya("onEscape"),Ne("stopSpaceKeyup",!1),Ie("focusIn")],Dg=gm(Bg,qi.init,function(t,n,e){return[am(em(Yd),e.onSpace),am(om([um,em(Gd)]),e.onEnter),am(om([rm,em(Gd)]),e.onShiftEnter),am(om([rm,em(Wd)]),e.onShiftTab),am(om([um,em(Wd)]),e.onTab),am(em(Kd),e.onUp),am(em($d),e.onDown),am(em(qd),e.onLeft),am(em(Jd),e.onRight),am(em(Yd),e.onSpace),am(em(Xd),e.onEscape)]},function(t,n,e){return e.stopSpaceKeyup?[am(em(Yd),ym)]:[]},function(t){return t.focusIn}),Ag=hm.schema(),Mg=vm.schema(),Fg=ig.schema(),Ig=Km.schema(),Rg=xg.schema(),Vg=Sm.schema(),Pg=Eg.schema(),Hg=Dg.schema(),zg=Lc({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Ag,cyclic:Mg,flow:Fg,flatgrid:Ig,matrix:Rg,execution:Vg,menu:Pg,special:Hg}),name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold(function(){t.getSystem().triggerFocus(t.element,t.element)},function(o){o(t,n,e)})},setGridSize:function(t,n,e,o,r){wn(e,"setGridSize")?e.setGridSize(o,r):console.error("Layout does not support setGridSize")}},state:Cm}),Ng=function(t,n,e,o){var r=t.getSystem().build(o);Hl(t,r,e)},Lg=function(t,n,e,o){var r=jg(t);Mt(r,function(t){return Bo(o.element,t.element)}).each(Nl)},jg=function(t){return t.components()},Ug=function(t,n,e,o,r){var i=jg(t);return ut.from(i[o]).map(function(n){return Lg(t,0,0,n),r.each(function(n){Ng(t,0,function(t,n){var e,r;r=n,li(e=t,o).fold(function(){gi(e,r)},function(t){fi(t,r)})},n)}),n})},Wg=zc({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(t,n,e,o){Ng(t,0,gi,o)},prepend:function(t,n,e,o){Ng(t,0,mi,o)},remove:Lg,replaceAt:Ug,replaceBy:function(t,n,e,o,r){var i=jg(t);return Ft(i,o).bind(function(n){return Ug(t,0,0,n,r)})},set:function(t,n,e,o){qc(function(){var n=_t(o,t.getSystem().build);Vl(t,n)},t.element)},contents:jg})}),Gg=function(t,n){var e,o;return{key:t,value:{config:{},me:(e=t,o=Vr(n),zc({fields:[_e("enabled")],name:e,active:{events:K(o)}})),configAsRaw:K({}),initialConfig:{},state:qi}}},Xg=function(t,n){n.ignore||(Gc(t.element),n.onFocus(t))},Yg=Object.freeze({__proto__:null,focus:Xg,blur:function(t,n){n.ignore||t.element.dom.blur()},isFocused:function(t){return n=t.element,e=wu(n).dom,n.dom===e.activeElement;var n,e}}),qg=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return $i(e)},events:function(t){return Vr([zr(ir(),function(n,e){Xg(n,t),e.stop()})].concat(t.stopMousedown?[zr(Uo(),function(t,n){n.event.prevent()})]:[]))}}),Kg=[Xa("onFocus"),Ne("stopMousedown",!1),Ne("ignore",!1)],Jg=zc({fields:Kg,name:"focusing",active:qg,apis:Yg}),$g=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},Qg=function(t,n,e){n.toggleClass.each(function(n){(e.get()?fu:mu)(t.element,n)})},Zg=function(t,n,e){ep(t,n,e,!e.get())},tp=function(t,n,e){e.set(!0),Qg(t,n,e),$g(t,n,e)},np=function(t,n,e){e.set(!1),Qg(t,n,e),$g(t,n,e)},ep=function(t,n,e,o){(o?tp:np)(t,n,e)},op=function(t,n,e){ep(t,n,e,n.selected)},rp=Object.freeze({__proto__:null,onLoad:op,toggle:Zg,isOn:function(t,n,e){return e.get()},on:tp,off:np,set:ep}),ip=Object.freeze({__proto__:null,exhibit:function(){return $i({})},events:function(t,n){var e,o,r,i=(e=t,o=n,r=Zg,Kr(function(t){r(t,e,o)})),u=Mc(t,n,op);return Vr(It([t.toggleOnExecute?[i]:[],[u]]))}}),up=function(t,n,e){Si(t.element,"aria-expanded",e)},ap=[Ne("selected",!1),Ie("toggleClass"),Ne("toggleOnExecute",!0),Le("aria",{mode:"none"},he("mode",{pressed:[Ne("syncWithExpanded",!1),Ja("update",function(t,n,e){Si(t.element,"aria-pressed",e),n.syncWithExpanded&&up(t,n,e)})],checked:[Ja("update",function(t,n,e){Si(t.element,"aria-checked",e)})],expanded:[Ja("update",up)],selected:[Ja("update",function(t,n,e){Si(t.element,"aria-selected",e)})],none:[Ja("update",Y)]}))],cp=zc({fields:ap,name:"toggling",active:ip,apis:rp,state:(fm=!1,{init:function(){var t=Ke(fm);return{get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(fm)},readState:function(){return t.get()}}}})}),sp=function(){var t=function(t,n){n.stop(),Mr(t)};return[zr(tr(),t),zr(fr(),t),Wr(zo()),Wr(Uo())]},lp=function(t){return Vr(It([t.map(function(t){return Kr(function(n,e){t(n),e.stop()})}).toArray(),sp()]))},fp="alloy.item-hover",dp="alloy.item-focus",mp=function(t){(Yc(t.element).isNone()||Jg.isFocused(t))&&(Jg.isFocused(t)||Jg.focus(t),Ar(t,fp,{item:t}))},gp=function(t){Ar(t,dp,{item:t})},pp=K(fp),hp=K(dp),vp=[_e("data"),_e("components"),_e("dom"),Ne("hasSubmenu",!1),Ie("toggling"),Of("itemBehaviours",[cp,Jg,zg,wf]),Ne("ignoreFocus",!1),Ne("domModification",{}),Ja("builder",function(t){return{dom:t.dom,domModification:et(et({},t.domModification),{attributes:et(et(et({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:_f(t.itemBehaviours,[t.toggling.fold(cp.revoke,function(t){return cp.config(et({aria:{mode:"checked"}},t))}),Jg.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){gp(t)}}),zg.config({mode:"execution"}),wf.config({store:{mode:"memory",initialValue:t.data}}),Gg("item-type-events",e(sp(),[zr(Yo(),mp),zr(lr(),Jg.focus)]))]),components:t.components,eventOrder:t.eventOrder}}),Ne("eventOrder",{})],bp=[_e("dom"),_e("components"),Ja("builder",function(t){return{dom:t.dom,components:t.components,events:Vr([(n=lr(),zr(n,function(t,n){n.stop()}))])};var n})],yp=function(){return"item-widget"},xp=K([$f({name:"widget",overrides:function(t){return{behaviours:Pc([wf.config({store:{mode:"manual",getValue:function(){return t.data},setValue:function(){}}})])}}})]),wp=[_e("uid"),_e("data"),_e("components"),_e("dom"),Ne("autofocus",!1),Ne("ignoreFocus",!1),Of("widgetBehaviours",[wf,Jg,zg]),Ne("domModification",{}),bd(xp()),Ja("builder",function(t){var n=sd(yp(),t,xp()),e=ld(yp(),t,n.internals()),o=function(n){return fd(n,t,"widget").map(function(t){return zg.focusIn(t),t})},r=function(n,e){return Ed(e.event.target)||t.autofocus&&e.setSource(n.element),ut.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:Vr([Kr(function(t,n){o(t).each(function(){n.stop()})}),zr(Yo(),mp),zr(lr(),function(n){t.autofocus?o(n):Jg.focus(n)})]),behaviours:_f(t.widgetBehaviours,[wf.config({store:{mode:"memory",initialValue:t.data}}),Jg.config({ignore:t.ignoreFocus,onFocus:function(t){gp(t)}}),zg.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:jc(),onLeft:r,onRight:r,onEscape:function(n,e){return Jg.isFocused(n)||t.autofocus?(t.autofocus&&e.setSource(n.element),ut.none()):(Jg.focus(n),ut.some(!0))}})])}})],Sp=he("type",{widget:wp,item:vp,separator:bp}),kp=K([td({factory:{sketch:function(t){var n=me("menu.spec item",Sp,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return n.hasOwnProperty("uid")?n:et(et({},n),{uid:zi("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Cp=K([_e("value"),_e("items"),_e("dom"),_e("components"),Ne("eventOrder",{}),Sf("menuBehaviours",[jd,wf,Ad,zg]),Le("movement",{mode:"menu",moveOnTab:!0},he("mode",{grid:[Qa(),Ja("config",function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}})],matrix:[Ja("config",function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}}),_e("rowSelector")],menu:[Ne("moveOnTab",!0),Ja("config",function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}})]})),Te("markers",La()),Ne("fakeFocus",!1),Ne("focusManager",sm()),Xa("onHighlight")]),Op=K("alloy.menu-focus"),_p=_d({name:"Menu",configFields:Cp(),partFields:kp(),factory:function(t,n){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Cf(t.menuBehaviours,[jd.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),wf.config({store:{mode:"memory",initialValue:t.value}}),Ad.config({find:ut.some}),zg.config(t.movement.config(t,t.movement))]),events:Vr([zr(hp(),function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each(function(e){jd.highlight(t,e),n.stop(),Ar(t,Op(),{menu:t,item:e})})}),zr(pp(),function(t,n){var e=n.event.item;jd.highlight(t,e)})]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Tp=function(t,n,e,o){return yn(e,o).bind(function(o){return yn(t,o).bind(function(o){var r=Tp(t,n,e,o);return ut.some([o].concat(r))})}).getOr([])},Ep=function(t,n){var e={};dn(t,function(t,n){Tt(t,function(t){e[t]=n})});var o=n,r=gn(n,function(t,n){return{k:t,v:n}}),i=mn(r,function(t,n){return[n].concat(Tp(e,o,r,n))});return mn(e,function(t){return yn(i,t).getOr([t])})},Bp=function(t){return"prepared"===t.type?ut.some(t.menu):ut.none()},Dp={init:function(){var t=Ke({}),n=Ke({}),e=Ke({}),o=Ke(ut.none()),r=Ke({}),i=function(n,e,o){return u(n).bind(function(r){return i=n,vn(t.get(),function(t){return t===i}).bind(function(t){return e(t).map(function(t){return{triggeredMenu:r,triggeringItem:t,triggeringPath:o}})});var i})},u=function(t){return a(t).bind(Bp)},a=function(t){return yn(n.get(),t)},c=function(n){return yn(t.get(),n)};return{setMenuBuilt:function(t,e){var o;n.set(et(et({},n.get()),((o={})[t]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(ut.some(i)),t.set(a),n.set(u),r.set(c);var s=Ep(c,a);e.set(s)},expand:function(n){return yn(t.get(),n).map(function(t){var o=yn(e.get(),n).getOr([]);return[t].concat(o)})},refresh:function(t){return yn(e.get(),t)},collapse:function(t){return yn(e.get(),t).bind(function(t){return 1<t.length?ut.some(t.slice(1)):ut.none()})},lookupMenu:a,lookupItem:c,otherMenus:function(t){var n=r.get();return Ht(ln(n),t)},getPrimary:function(){return o.get().bind(u)},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),o.set(ut.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(t,n){var r=Bt(c(t).toArray(),function(t){return u(t).isSome()});return yn(e.get(),t).bind(function(t){var e=Pt(r.concat(t));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return ut.none();n.push(o.getOrDie())}return ut.some(n)}(Rt(e,function(t,r){return i(t,n,e.slice(0,r+1)).fold(function(){return o.get().is(t)?[]:[ut.none()]},function(t){return[ut.some(t)]})}))})}}},extractPreparedMenu:Bp},Ap=K("collapse-item"),Mp=Od({name:"TieredMenu",configFields:[Ka("onExecute"),Ka("onEscape"),qa("onOpenMenu"),qa("onOpenSubmenu"),Xa("onRepositionMenu"),Xa("onCollapseMenu"),Ne("highlightImmediately",!0),Ae("data",[_e("primary"),_e("menus"),_e("expansions")]),Ne("fakeFocus",!1),Xa("onHighlight"),Xa("onHover"),Ua(),_e("dom"),Ne("navigateOnHover",!0),Ne("stayInDom",!1),Sf("tmenuBehaviours",[zg,jd,Ad,Wg]),Ne("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(t){var n,e,o=Ke(ut.none()),r=Dp.init(),i=function(n){var e,o,i,u=(e=n,o=t.data.primary,i=t.data.menus,mn(i,function(n,r){var i=function(){return _p.sketch(et(et({},n),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:(t.fakeFocus?lm:sm)()}))};return r===o?{type:"prepared",menu:e.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}})),c=a();return r.setContents(t.data.primary,u,t.data.expansions,c),r.getPrimary()},u=function(t){return wf.getValue(t).value},a=function(){return mn(t.data.menus,function(t){return Rt(t.items,function(t){return"separator"===t.type?[]:[t.data.value]})})},c=function(t,n){jd.highlight(t,n),jd.getHighlighted(n).orThunk(function(){return jd.getFirst(n)}).each(function(n){Fr(t,n.element,lr())})},s=function(t,n){return Td(_t(n,function(n){return t.lookupMenu(n).bind(function(t){return"prepared"===t.type?ut.some(t.menu):ut.none()})}))},l=function(n,e,o){var r=s(e,e.otherMenus(o));Tt(r,function(e){hu(e.element,[t.markers.backgroundMenu]),t.stayInDom||Wg.remove(n,e)})},f=function(n,e){var r,i=(r=n,o.get().getOrThunk(function(){var n={},e=Ys(r.element,"."+t.markers.item),i=Bt(e,function(t){return"true"===ki(t,"aria-haspopup")});return Tt(i,function(t){r.getSystem().getByDom(t).each(function(t){var e=u(t);n[e]=t})}),o.set(ut.some(n)),n}));dn(i,function(t,n){var o=St(e,n);Si(t.element,"aria-expanded",o)})},d=function(n,e,o){return ut.from(o[0]).bind(function(r){return e.lookupMenu(r).bind(function(r){if("notbuilt"===r.type)return ut.none();var i=r.menu,u=s(e,o.slice(1));return Tt(u,function(n){fu(n.element,t.markers.backgroundMenu)}),Ou(i.element)||Wg.append(n,$u(i)),hu(i.element,[t.markers.backgroundMenu]),c(n,i),l(n,e,o),ut.some(i)})})};(e=n=n||{})[e.HighlightSubmenu=0]="HighlightSubmenu",e[e.HighlightParent=1]="HighlightParent";var m=function(e,o,i){void 0===i&&(i=n.HighlightSubmenu);var a=u(o);return r.expand(a).bind(function(u){return f(e,u),ut.from(u[0]).bind(function(a){return r.lookupMenu(a).bind(function(c){var s=function(t,n,e){if("notbuilt"!==e.type)return e.menu;var o=t.getSystem().build(e.nbMenu());return r.setMenuBuilt(n,o),o}(e,a,c);return Ou(s.element)||Wg.append(e,$u(s)),t.onOpenSubmenu(e,o,s,Pt(u)),i===n.HighlightSubmenu?(jd.highlightFirst(s),d(e,r,u)):(jd.dehighlightAll(s),ut.some(o))})})})},g=function(n,e){var o=u(e);return r.collapse(o).bind(function(o){return f(n,o),d(n,r,o).map(function(o){return t.onCollapseMenu(n,e,o),o})})},p=function(n){return function(e,o){return Ea(o.getSource(),"."+t.markers.item).bind(function(t){return e.getSystem().getByDom(t).toOptional().bind(function(t){return n(e,t).map(function(){return!0})})})}},h=Vr([zr(Op(),function(t,n){var e=n.event.item;r.lookupItem(u(e)).each(function(){var e=n.event.menu;jd.highlight(t,e);var o=u(n.event.item);r.refresh(o).each(function(n){return l(t,r,n)})})}),Kr(function(e,o){var r=o.event.target;e.getSystem().getByDom(r).each(function(o){0===u(o).indexOf("collapse-item")&&g(e,o),m(e,o,n.HighlightSubmenu).fold(function(){t.onExecute(e,o)},function(){})})}),Xr(function(n){i(n).each(function(e){Wg.append(n,$u(e)),t.onOpenMenu(n,e),t.highlightImmediately&&c(n,e)})})].concat(t.navigateOnHover?[zr(pp(),function(e,o){var i,a,c=o.event.item;i=e,a=u(c),r.refresh(a).bind(function(t){return f(i,t),d(i,r,t)}),m(e,c,n.HighlightParent),t.onHover(e,c)})]:[])),v=function(t){return jd.getHighlighted(t).bind(jd.getHighlighted)},b={collapseMenu:function(t){v(t).each(function(n){g(t,n)})},highlightPrimary:function(t){r.getPrimary().each(function(n){c(t,n)})},repositionMenus:function(n){r.getPrimary().bind(function(t){return v(n).bind(function(t){var n=u(t),e=bn(r.getMenus()),o=Td(_t(e,Dp.extractPreparedMenu));return r.getTriggeringPath(n,function(t){return n=t,Ut(o,function(t){if(!t.getSystem().isConnected())return ut.none();var e=jd.getCandidates(t);return Mt(e,function(t){return u(t)===n})});var n})}).map(function(n){return{primary:t,triggeringPath:n}})}).fold(function(){var e;e=n,ut.from(e.components()[0]).filter(function(t){return"menu"===ki(t.element,"role")}).each(function(e){t.onRepositionMenu(n,e,[])})},function(e){var o=e.primary,r=e.triggeringPath;t.onRepositionMenu(n,o,r)})}};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Cf(t.tmenuBehaviours,[zg.config({mode:"special",onRight:p(function(t,e){return Ed(e.element)?ut.none():m(t,e,n.HighlightSubmenu)}),onLeft:p(function(t,n){return Ed(n.element)?ut.none():g(t,n)}),onEscape:p(function(n,e){return g(n,e).orThunk(function(){return t.onEscape(n,e).map(function(){return n})})}),focusIn:function(t){r.getPrimary().each(function(n){Fr(t,n.element,lr())})}}),jd.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),Ad.config({find:function(t){return jd.getHighlighted(t)}}),Wg.config({})]),eventOrder:t.eventOrder,apis:b,events:h}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:Vn(t,n),expansions:{}}},collapseItem:function(t){return{value:Mi(Ap()),meta:{text:t}}}}}),Fp=Od({name:"InlineView",configFields:[_e("lazySink"),Xa("onShow"),Xa("onHide"),He("onEscape"),Sf("inlineBehaviours",[tf,wf,Uc]),ze("fireDismissalEventInstead",[Ne("event",Sr())]),ze("fireRepositionEventInstead",[Ne("event",kr())]),Ne("getRelated",ut.none),Ne("isExtraPart",Z),Ne("eventOrder",ut.none)],factory:function(t,n){var e=function(t,n,e,r){o(t,n,e,function(){return r.map(xa)})},o=function(n,e,o,r){var i=t.lazySink(n).getOrDie();tf.openWhileCloaked(n,o,function(){return Ml.positionWithinBounds(i,e,n,r())}),wf.setValue(n,ut.some({mode:"position",anchor:e,getBounds:r}))},r=function(n,e,o,r){var i,u,a,c,s,l,f,d,m=(i=t,u=n,a=e,s=r,l=function(){return i.lazySink(u)},f="horizontal"===(c=o).type?{layouts:{onLtr:Ec,onRtl:Bc}}:{},d=function(t){return 2===t.length?f:{}},Mp.sketch({dom:{tag:"div"},data:c.data,markers:c.menu.markers,highlightImmediately:c.menu.highlightImmediately,onEscape:function(){return tf.close(u),i.onEscape.map(function(t){return t(u)}),ut.some(!0)},onExecute:function(){return ut.some(!0)},onOpenMenu:function(t,n){Ml.positionWithinBounds(l().getOrDie(),a,n,s())},onOpenSubmenu:function(t,n,e,o){var r=l().getOrDie();Ml.position(r,et({anchor:"submenu",item:n},d(o)),e)},onRepositionMenu:function(t,n,e){var o=l().getOrDie();Ml.positionWithinBounds(o,a,n,s()),Tt(e,function(t){var n=d(t.triggeringPath);Ml.position(o,et({anchor:"submenu",item:t.triggeringItem},n),t.triggeredMenu)})}}));tf.open(n,m),wf.setValue(n,ut.some({mode:"menu",menu:m}))},i=function(n){tf.isOpen(n)&&wf.getValue(n).each(function(e){switch(e.mode){case"menu":tf.getState(n).each(function(t){Mp.repositionMenus(t)});break;case"position":var o=t.lazySink(n).getOrDie();Ml.positionWithinBounds(o,e.anchor,n,e.getBounds())}})},u={setContent:function(t,n){tf.setContent(t,n)},showAt:function(t,n,o){e(t,n,o,ut.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(t,n,e){r(t,n,e,function(){return ut.none()})},showMenuWithinBounds:r,hide:function(t){tf.isOpen(t)&&(wf.setValue(t,ut.none()),tf.close(t))},getContent:function(t){return tf.getState(t)},reposition:i,isOpen:tf.isOpen};return{uid:t.uid,dom:t.dom,behaviours:Cf(t.inlineBehaviours,[tf.config({isPartOf:function(n,e,o){return Aa(e,o)||(r=n,i=o,t.getRelated(r).exists(function(t){return Aa(t,i)}));var r,i},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),wf.config({store:{mode:"memory",initialValue:ut.none()}}),Uc.config({channels:et(et({},uf(et({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),cf(et(et({},t.fireRepositionEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})),{doReposition:i})))})]),eventOrder:t.eventOrder,apis:u}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),Ip=function(t){return t.x},Rp=function(t,n){return t.x+t.width/2-n.width/2},Vp=function(t,n){return t.x+t.width-n.width},Pp=function(t){return t.y},Hp=function(t,n){return t.y+t.height-n.height},zp=function(t,n,e){return Za(Vp(t,n),Hp(t,n),e.innerSoutheast(),rc(),sc(t,{right:0,bottom:3}),"layout-inner-se")},Np=function(t,n,e){return Za(Ip(t),Hp(t,n),e.innerSouthwest(),oc(),sc(t,{left:1,bottom:3}),"layout-inner-sw")},Lp=function(t,n,e){return Za(Vp(t,n),Pp(t),e.innerNortheast(),ec(),sc(t,{right:0,top:2}),"layout-inner-ne")},jp=function(t,n,e){return Za(Ip(t),Pp(t),e.innerNorthwest(),nc(),sc(t,{left:1,top:2}),"layout-inner-nw")},Up=function(t,n,e){return Za(Rp(t,n),Pp(t),e.innerNorth(),ic(),sc(t,{top:2}),"layout-inner-n")},Wp=function(t,n,e){return Za(Rp(t,n),Hp(t,n),e.innerSouth(),uc(),sc(t,{bottom:3}),"layout-inner-s")},Gp=tinymce.util.Tools.resolve("tinymce.util.Delay"),Xp=Od({name:"Button",factory:function(t){var n=lp(t.action),e=t.dom.tag,o=function(n){return yn(t.dom,"attributes").bind(function(t){return yn(t,n)})};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:_f(t.buttonBehaviours,[Jg.config({}),zg.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"!==e)return{role:o("role").getOr("button")};var t=o("type").getOr("button"),n=o("role").map(function(t){return{role:t}}).getOr({});return et({type:t},n)}()},eventOrder:t.eventOrder}},configFields:[Ne("uid",undefined),_e("dom"),Ne("components",[]),Of("buttonBehaviours",[Jg,zg]),Ie("action"),Ie("role"),Ne("eventOrder",{})]}),Yp=function(t){var n=t.uid!==undefined&&wn(t,"uid")?t.uid:zi("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return et(et({},t),{uid:n})}}},qp=function(t){return ut.from(t()["temporary-placeholder"]).getOr("!not found!")},Kp=function(t,n){return ut.from(n()[t.toLowerCase()]).getOrThunk(function(){return qp(n)})},Jp={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},$p=Od({name:"Notification",factory:function(t){var n,e,o=Yp({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:Pc([Wg.config({})])}),r=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},i=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},u=Yp({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(0)]},i(0)],behaviours:Pc([Wg.config({})])}),a={updateProgress:function(t,n){t.getSystem().isConnected()&&u.getOpt(t).each(function(t){Wg.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[r(n)]},i(n)])})},updateText:function(t,n){var e;t.getSystem().isConnected()&&(e=o.get(t),Wg.set(e,[Yu(n)]))}},c=It([t.icon.toArray(),t.level.toArray(),t.level.bind(function(t){return ut.from(Jp[t])}).toArray()]),s=Yp(Xp.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Kp("close",t.iconProvider),attributes:{"aria-label":t.translationProvider("Close")}}}],action:function(n){t.onAction(n)}})),l=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:(n=c,e=t.iconProvider,Ut(n,function(t){return ut.from(e()[t.toLowerCase()])}).getOrThunk(function(){return qp(e)}))}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[o.asSpec()],behaviours:Pc([Wg.config({})])}];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map(function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]}).getOr(["tox-notification","tox-notification--in"])},behaviours:Pc([Jg.config({}),Gg("notification-events",[zr(qo(),function(t){s.getOpt(t).each(Jg.focus)})])]),components:l.concat(t.progress?[u.asSpec()]:[]).concat(t.closeButton?[s.asSpec()]:[]),apis:a}},configFields:[Ie("level"),_e("progress"),_e("icon"),_e("onAction"),_e("text"),_e("iconProvider"),_e("translationProvider"),Ge("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}}),Qp=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},throttle:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null!==e&&clearTimeout(e),e=setTimeout(function(){t.apply(null,o),e=null},n)}}},Zp=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),th=function(t,n,e,o,r){var i=Zp(t,function(n){return o=n,(e=t).isBlock(o)||St(["BR","IMG","HR","INPUT"],o.nodeName)||"false"===e.getContentEditable(o);var e,o});return ut.from(i.backwards(n,e,o,r))},nh=function(t,n){return eh($e.fromDom(t.selection.getNode())).getOrThunk(function(){var e=$e.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return gi(e,$e.fromDom(n.extractContents())),n.insertNode(e.dom),ui(e).each(function(t){return t.dom.normalize()}),Xs(e,Gs).map(function(n){var e;t.selection.setCursorLocation(n.dom,"img"===Jr(e=n)?1:Us(e).fold(function(){return si(e).length},function(t){return t.length}))}),e})},eh=function(t){return Ea(t,"[data-mce-autocompleter]")},oh=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},rh=function(t){return""!==t&&-1!==" \xa0\f\n\r\t\x0B".indexOf(t)},ih=function(t,n){return t.substring(n.length)},uh=function(t,n,e,o){if(void 0===o&&(o=0),!(r=n).collapsed||3!==r.startContainer.nodeType)return ut.none();var r,i=t.getParent(n.startContainer,t.isBlock)||t.getRoot();return th(t,n.startContainer,n.startOffset,function(t,n,o){return function(t,n,e){for(var o=n-1;0<=o;o--){var r=t.charAt(o);if(rh(r))return ut.none();if(r===e)break}return ut.some(o)}(o,n,e).getOr(n)},i).bind(function(t){var r=n.cloneRange();if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return ut.none();var i=oh(r);return 0!==i.lastIndexOf(e)||ih(i,e).length<o?ut.none():ut.some({text:ih(i,e),range:r,triggerChar:e})})},ah=function(t,n,e,o){return void 0===o&&(o=0),eh($e.fromDom(n.startContainer)).fold(function(){return uh(t,n,e,o)},function(n){var o=t.createRng();o.selectNode(n.dom);var r=oh(o);return ut.some({range:o,text:ih(r,e),triggerChar:e})})},ch=function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){Ar(t,Jo(),{raw:n})};n.on("keydown",function(n){var o=function(){return t.getView().bind(jd.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(Mr),n.preventDefault()):40===n.which?(o().fold(function(){t.getView().each(jd.highlightFirst)},function(t){e(t,n)}),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each(function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()}):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())}),n.on("NodeChange",function(n){t.isActive()&&!t.isProcessingAction()&&eh($e.fromDom(n.element)).isNone()&&t.cancelIfNecessary()})},sh=tinymce.util.Tools.resolve("tinymce.util.Promise"),lh=function(t,n){return{container:t,offset:n}},fh=function(t){if(3===t.nodeType)return lh(t,t.data.length);var n=t.childNodes;return 0<n.length?fh(n[n.length-1]):lh(t,n.length)},dh=function(t,n){var e=t.childNodes;return 0<e.length&&n<e.length?dh(e[n],0):0<e.length&&1===t.nodeType&&e.length===n?fh(e[e.length-1]):lh(t,n)},mh=function(t){return function(n){var e,o,r=dh(n.startContainer,n.startOffset);return!th(e=t,(o=r).container,o.offset,function(t,n){return 0===n?-1:n},e.getRoot()).filter(function(t){var n=t.container.data.charAt(t.offset-1);return!rh(n)}).isSome()}},gh=function(t,n){var e,o,r=n(),i=t.selection.getRng();return e=t.dom,o=i,Ut(r.triggerChars,function(t){return ah(e,o,t)}).bind(function(e){return ph(t,n,e)})},ph=function(t,n,e,o){void 0===o&&(o={});var r=n(),i=t.selection.getRng().startContainer.nodeValue,u=Bt(r.lookupByChar(e.triggerChar),function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk(function(){return mh(t.dom)})(e.range,i,e.text)});if(0===u.length)return ut.none();var a=sh.all(_t(u,function(t){return t.fetch(e.text,t.maxResults,o).then(function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction}})}));return ut.some({lookupData:a,context:e})},hh=Jn([Ee("type"),Pe("text")]),vh=Jn([Ne("type","autocompleteitem"),Ne("active",!1),Ne("disabled",!1),Ne("meta",{}),Ee("value"),Pe("text"),Pe("icon")]),bh=Jn([Ee("type"),Ee("ch"),je("minChars",1),Ne("columns",1),je("maxResults",10),He("matches"),De("fetch"),De("onAction")]),yh=[Ge("disabled",!1),Pe("tooltip"),Pe("icon"),Pe("text"),Xe("onSetup",function(){return Y})],xh=Jn([Ee("type"),De("onAction")].concat(yh)),wh=function(t){return fe("toolbarbutton",xh,t)},Sh=[Ge("active",!1)].concat(yh),kh=Jn(Sh.concat([Ee("type"),De("onAction")])),Ch=function(t){return fe("ToggleButton",kh,t)},Oh=[Xe("predicate",function(){return!1}),We("scope","node",["node","editor"]),We("position","selection",["node","selection","line"])],_h=yh.concat([Ne("type","contextformbutton"),Ne("primary",!1),De("onAction"),qe("original",J)]),Th=Sh.concat([Ne("type","contextformbutton"),Ne("primary",!1),De("onAction"),qe("original",J)]),Eh=yh.concat([Ne("type","contextformbutton")]),Bh=Sh.concat([Ne("type","contextformtogglebutton")]),Dh=he("type",{contextformbutton:_h,contextformtogglebutton:Th}),Ah=Jn([Ne("type","contextform"),Xe("initValue",function(){return""}),Pe("label"),Fe("commands",Dh),Re("launch",he("type",{contextformbutton:Eh,contextformtogglebutton:Bh}))].concat(Oh)),Mh=Jn([Ne("type","contexttoolbar"),Ee("items")].concat(Oh)),Fh=function(t){var n,e,o=t.ui.registry.getAll().popups,r=mn(o,function(t){return fe("Autocompleter",bh,t).fold(function(t){throw new Error(ge(t))},function(t){return t})}),i=(n=hn(r,function(t){return t.ch}),e={},Tt(n,function(t){e[t]={}}),ln(e)),u=bn(r);return{dataset:r,triggerChars:i,lookupByChar:function(t){return Bt(u,function(n){return n.ch===t})}}};(mm=dm=dm||{})[mm.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",mm[mm.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX";var Ih,Rh,Vh=dm,Ph="tox-menu-nav__js",Hh="tox-collection__item",zh="tox-swatch",Nh={normal:Ph,color:zh},Lh="tox-collection__item--enabled",jh="tox-collection__item-label",Uh="tox-collection__item-caret",Wh="tox-collection__item--active",Gh=function(t){return yn(Nh,t).getOr(Ph)},Xh=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:"color"===t?"tox-swatches":"tox-menu",tieredMenu:"tox-tiered-menu"}},Yh=function(t){var n=Xh(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:Gh(t)}},qh=[_p.parts.items({})],Kh=function(t,n,e){var o=Xh(e);return{dom:{tag:"div",classes:It([[o.tieredMenu]])},markers:Yh(e)}},Jh=function(t,n){return function(e){var o=Ot(e,n);return _t(o,function(n){return{
dom:t,components:n}})}},$h=function(t,n){var e=[],o=[];return Tt(t,function(t,r){n(t,r)?(0<o.length&&e.push(o),o=[],xn(t.dom,"innerHtml")&&o.push(t)):o.push(t)}),0<o.length&&e.push(o),_t(e,function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}})},Qh=function(t,n){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[_p.parts.items({preprocess:function(e){return"auto"!==t&&1<t?Jh({tag:"div",classes:["tox-collection__group"]},t)(e):$h(e,function(t,e){return"separator"===n[e].type})}})]}},Zh=function(t){return kt(t,function(t){return"icon"in t&&t.icon!==undefined})},tv=function(t){return console.error(ge(t)),console.log(t),ut.none()},nv=function(t,n,e){var o,r=(o=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[_p.parts.items({preprocess:function(t){return $h(t,function(t,n){return"separator"===o[n].type})}})]});return{value:t,dom:r.dom,components:r.components,items:e}},ev=function(t,n,e,o,r){var i,u,a,c,s,l;return"color"===r?{value:t,dom:(i=o,a={dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[_p.parts.items({preprocess:"auto"!==i?Jh({tag:"div",classes:["tox-swatches__row"]},i):J})]}]}).dom,components:a.components,items:e}:"normal"===r&&"auto"===o?{value:t,dom:(a=Qh(o,e)).dom,components:a.components,items:e}:"normal"===r&&1===o?{value:t,dom:(a=Qh(1,e)).dom,components:a.components,items:e}:"normal"===r?{value:t,dom:(a=Qh(o,e)).dom,components:a.components,items:e}:"listpreview"!==r||"auto"===o?{value:t,dom:(c=n,s=o,l=Xh(r),{tag:"div",classes:It([[l.menu,"tox-menu-"+s+"-column"],c?[l.hasIcons]:[]])}),components:qh,items:e}:{value:t,dom:(u=o,a={dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[_p.parts.items({preprocess:Jh({tag:"div",classes:["tox-collection__group"]},u)})]}).dom,components:a.components,items:e}},ov=[Ge("disabled",!1),Pe("text"),Pe("shortcut"),oe("value","value",Mn(function(){return Mi("menuitem-value")}),ve()),Ne("meta",{})],rv=Jn([Ee("type"),Ge("active",!1),Pe("icon")].concat(ov)),iv=Jn([Ee("type"),Be("fancytype",["inserttable","colorswatch"]),Xe("onAction",Y)]),uv=Jn([Ee("type"),Xe("onSetup",function(){return Y}),Xe("onAction",Y),Pe("icon")].concat(ov)),av=Jn([Ee("type"),De("getSubmenuItems"),Xe("onSetup",function(){return Y}),Pe("icon")].concat(ov)),cv=Jn([Ee("type"),Pe("icon"),Ge("active",!1),Xe("onSetup",function(){return Y}),De("onAction")].concat(ov)),sv=function(t,n,e){var o=Ys(t.element,"."+e);if(0<o.length){var r=Ft(o,function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>n}).getOr(o.length);return ut.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return ut.none()},lv=function(t,n){return Pc([Gg(t,n)])},fv=function(t){return lv(Mi("unnamed-events"),t)},dv=[_e("lazySink"),_e("tooltipDom"),Ne("exclusive",!0),Ne("tooltipComponents",[]),Ne("delay",300),We("mode","normal",["normal","follow-highlight"]),Ne("anchor",function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:K([wc,xc,hc,bc,vc,yc]),onRtl:K([wc,xc,hc,bc,vc,yc])}}}),Xa("onHide"),Xa("onShow")],mv=Object.freeze({__proto__:null,init:function(){var t=Ke(ut.none()),n=Ke(ut.none()),e=function(){t.get().each(function(t){clearTimeout(t)})},o=K("not-implemented");return Ki({getTooltip:function(){return n.get()},isShowing:function(){return n.get().isSome()},setTooltip:function(t){n.set(ut.some(t))},clearTooltip:function(){n.set(ut.none())},clearTimer:e,resetTimer:function(n,o){e(),t.set(ut.some(setTimeout(function(){n()},o)))},readState:o})}}),gv=Mi("tooltip.exclusive"),pv=Mi("tooltip.show"),hv=Mi("tooltip.hide"),vv=function(t){t.getSystem().broadcastOn([gv],{})},bv=Object.freeze({__proto__:null,hideAllExclusive:vv,setComponents:function(t,n,e,o){e.getTooltip().each(function(t){t.getSystem().isConnected()&&Wg.set(t,o)})}}),yv=zc({fields:dv,name:"tooltipping",active:Object.freeze({__proto__:null,events:function(t,n){var e=function(e){n.getTooltip().each(function(o){Nl(o),t.onHide(e,o),n.clearTooltip()}),n.clearTimer()};return Vr(It([[zr(pv,function(e){n.resetTimer(function(){var o,r,i;o=e,n.isShowing()||(vv(o),r=t.lazySink(o).getOrDie(),i=o.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:Vr("normal"===t.mode?[zr(Yo(),function(){Dr(o,pv)}),zr(Go(),function(){Dr(o,hv)})]:[]),behaviours:Pc([Wg.config({})])}),n.setTooltip(i),Pl(r,i),t.onShow(o,i),Ml.position(r,t.anchor(o),i))},t.delay)}),zr(hv,function(o){n.resetTimer(function(){e(o)},t.delay)}),zr(cr(),function(t,n){n.universal||St(n.channels,gv)&&e(t)}),Yr(function(t){e(t)})],"normal"===t.mode?[zr(qo(),function(t){Dr(t,pv)}),zr(ur(),function(t){Dr(t,hv)}),zr(Yo(),function(t){Dr(t,pv)}),zr(Go(),function(t){Dr(t,hv)})]:[zr(Er(),function(t){Dr(t,pv)}),zr(Br(),function(t){Dr(t,hv)})]]))}}),state:mv,apis:bv}),xv=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),wv=tinymce.util.Tools.resolve("tinymce.util.I18n"),Sv=["input","button","textarea","select"],kv=function(t,n){(n.disabled()?Bv:Dv)(t,n)},Cv=function(t,n){return!0===n.useNative&&St(Sv,Jr(t.element))},Ov=function(t){Si(t.element,"disabled","disabled")},_v=function(t){_i(t.element,"disabled")},Tv=function(t){Si(t.element,"aria-disabled","true")},Ev=function(t){Si(t.element,"aria-disabled","false")},Bv=function(t,n){n.disableClass.each(function(n){fu(t.element,n)}),(Cv(t,n)?Ov:Tv)(t),n.onDisabled(t)},Dv=function(t,n){n.disableClass.each(function(n){mu(t.element,n)}),(Cv(t,n)?_v:Ev)(t),n.onEnabled(t)},Av=function(t,n){return Cv(t,n)?Oi(t.element,"disabled"):"true"===ki(t.element,"aria-disabled")},Mv=Object.freeze({__proto__:null,enable:Dv,disable:Bv,isDisabled:Av,onLoad:kv,set:function(t,n,e,o){(o?Bv:Dv)(t,n)}}),Fv=Object.freeze({__proto__:null,exhibit:function(t,n){return $i({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(t,n){return Vr([Pr(sr(),function(n){return Av(n,t)}),Mc(t,n,kv)])}}),Iv=[Xe("disabled",Z),Ne("useNative",!0),Ie("disableClass"),Xa("onDisabled"),Xa("onEnabled")],Rv=zc({fields:Iv,name:"disabling",active:Fv,apis:Mv}),Vv=tinymce.util.Tools.resolve("tinymce.EditorManager"),Pv=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},Hv=function(t){return t.getParam("width",xv.DOM.getStyle(t.getElement(),"width"))},zv=function(t){return ut.from(t.getParam("min_width")).filter(ht)},Nv=function(t){return ut.from(t.getParam("min_height")).filter(ht)},Lv=function(t){return ut.from(t.getParam("max_width")).filter(ht)},jv=function(t){return ut.from(t.getParam("max_height")).filter(ht)},Uv=function(t){return!1!==t.getParam("menubar",!0,"boolean")},Wv=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=st(n),r=ft(n)&&0<n.length;return!Xv(t)&&(r||o||e)},Gv=function(t){var n=Ct(9,function(n){return t.getParam("toolbar"+(n+1),!1,"string")}),e=Bt(n,function(t){return"string"==typeof t});return 0<e.length?ut.some(e):ut.none()},Xv=function(t){return Gv(t).fold(function(){return 0<t.getParam("toolbar",[],"string[]").length},function(){return!0})};(Rh=Ih=Ih||{})["default"]="wrap",Rh.floating="floating",Rh.sliding="sliding",Rh.scrolling="scrolling";var Yv,qv,Kv=function(t){return t.getParam("toolbar_mode","","string")};(qv=Yv=Yv||{}).auto="auto",qv.top="top",qv.bottom="bottom";var Jv,$v,Qv,Zv=function(t){return t.getParam("toolbar_location",Yv.auto,"string")},tb=function(t){return Zv(t)===Yv.bottom},nb=function(t){var n=t.getParam("fixed_toolbar_container","","string");return 0<n.length&&t.inline?Ta(_u(),n):ut.none()},eb=function(t){return t.inline&&nb(t).isSome()},ob=function(t){return t.inline&&!Uv(t)&&!Wv(t)&&!Xv(t)},rb=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!eb(t)&&!ob(t)},ib="silver.readonly",ub=Jn([Te("readonly",we)]),ab=function(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([nf()],{target:e}),t.uiMothership.broadcastOn([nf()],{target:e})),t.mothership.broadcastOn([ib],{readonly:n}),t.uiMothership.broadcastOn([ib],{readonly:n})},cb=function(t,n){t.on("init",function(){t.mode.isReadOnly()&&ab(n,!0)}),t.on("SwitchMode",function(){return ab(n,t.mode.isReadOnly())}),t.getParam("readonly",!1,"boolean")&&t.setMode("readonly")},sb=function(){var t;return Uc.config({channels:((t={})[ib]={schema:ub,onReceive:function(t,n){Rv.set(t,n.readonly)}},t)})},lb=function(t){return Rv.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},fb=function(t){return Rv.config({disabled:t})},db=function(t){return Rv.config({disabled:t,disableClass:"tox-tbtn--disabled"})},mb=function(t){return Rv.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},gb=function(t,n){var e=t.getApi(n);return function(t){t(e)}},pb=function(t,n){return Xr(function(e){gb(t,e)(function(e){var o=t.onSetup(e);null!==o&&o!==undefined&&n.set(o)})})},hb=function(t,n){return Yr(function(e){return gb(t,e)(n.get())})},vb=((Jv={})[sr()]=["disabling","alloy.base.behaviour","toggling","item-events"],Jv),bb=function(t){return Rt(t,function(t){return t.toArray()})},yb=function(t,n,e,o){var r,i,u=Ke(Y);return{type:"item",dom:n.dom,components:bb(n.optComponents),data:t.data,eventOrder:vb,hasSubmenu:t.triggersSubmenu,itemBehaviours:Pc([Gg("item-events",[(r=t,i=e,Kr(function(t,n){gb(r,t)(r.onAction),r.triggersSubmenu||i!==Vh.CLOSE_ON_EXECUTE||(Dr(t,mr()),n.stop())})),pb(t,u),hb(t,u)]),lb(function(){return t.disabled||o.isReadOnly()}),sb(),Wg.config({})].concat(t.itemBehaviours))}},xb=function(t){return{value:t.value,meta:et({text:t.text.getOr("")},t.meta)}},wb=tinymce.util.Tools.resolve("tinymce.Env"),Sb=function(t){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:t}}},kb=function(t){return{dom:{tag:"div",classes:[jh]},components:[Yu(wv.translate(t))]}},Cb=function(t,n){return{dom:{tag:"div",classes:[jh]},components:[{dom:{tag:t.tag,styles:t.styles},components:[Yu(wv.translate(n))]}]}},Ob=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:(n=t,e=wb.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},o=n.split("+"),r=_t(o,function(t){var n=t.toLowerCase().trim();return xn(e,n)?e[n]:t}),wb.mac?r.join(""):r.join("+"))}};var n,e,o,r},_b=function(t){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:Kp("checkmark",t)}}},Tb=function(t,n,e,o,r){var i=e?n.or(ut.some("")).map(Sb):ut.none(),u=t.checkMark,a=t.ariaLabel.map(function(t){return{attributes:{title:wv.translate(t)}}}).getOr({});return{dom:et({tag:"div",classes:[Ph,Hh].concat(r?["tox-collection__item-icon-rtl"]:[])},a),optComponents:[i,t.htmlContent.fold(function(){return t.textContent.map(o)},function(t){return ut.some({dom:{tag:"div",classes:[jh],innerHtml:t}})}),t.shortcutContent.map(Ob),u,t.caret]}},Eb=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],Bb=["list-bull-circle","list-bull-default","list-bull-square"],Db=function(n,o,r,i){void 0===i&&(i=ut.none());var u,a,c,s,l,f=wv.isRtl()&&n.iconContent.exists(function(t){return St(Bb,t)}),d=n.iconContent.map(function(t){return wv.isRtl()&&St(Eb,t)?t+"-rtl":t}).map(function(t){return n=t,e=o.icons,r=i,ut.from(e()[n.toLowerCase()]).or(r).getOrThunk(function(){return qp(e)});var n,e,r}),m=ut.from(n.meta).fold(function(){return kb},function(n){return xn(n,"style")?t(Cb,n.style):kb});return"color"===n.presets?(u=n.ariaLabel,a=n.value,c=o,{dom:(s=d.getOr(""),l={tag:"div",attributes:u.map(function(t){return{title:c.translate(t)}}).getOr({}),classes:["tox-swatch"]},et(et({},l),"custom"===a?{tag:"button",classes:e(l.classes,["tox-swatches__picker-btn"]),innerHtml:s}:"remove"===a?{classes:e(l.classes,["tox-swatch--remove"]),innerHtml:s}:{attributes:et(et({},l.attributes),{"data-mce-color":a}),styles:{"background-color":a}})),optComponents:[]}):Tb(n,d,r,m,f)},Ab=function(t,n){var e,o=(e=wv.translate(t),xv.DOM.encode(e));if(0<n.length){var r=new RegExp(n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");return o.replace(r,function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"})}return o},Mb=rd(yp(),xp()),Fb=function(t){return{value:t}},Ib=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,Rb=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Vb=function(t){return Ib.test(t)||Rb.test(t)},Pb=function(t){var n={value:t.value.replace(Ib,function(t,n,e,o){return n+n+e+e+o+o})},e=Rb.exec(n.value);return null===e?["FFFFFF","FF","FF","FF"]:e},Hb=function(t){var n=t.toString(16);return 1===n.length?"0"+n:n},zb=function(t){var n=Hb(t.red)+Hb(t.green)+Hb(t.blue);return Fb(n)},Nb=Math.min,Lb=Math.max,jb=Math.round,Ub=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Wb=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Gb=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},Xb=function(t){var n=parseInt(t,10);return n.toString()===t&&0<=n&&n<=255},Yb=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;i=Lb(0,Nb(i,1)),u=Lb(0,Nb(u,1));if(0===i)return n=e=o=jb(255*u),Gb(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),l=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=jb(255*(n+l)),e=jb(255*(e+l)),o=jb(255*(o+l)),Gb(n,e,o,1)},qb=function(t){var n=Pb(t),e=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16);return Gb(e,o,r,1)},Kb=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return Gb(r,i,u,a)},Jb=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},$b=Gb(255,0,0,1),Qb=function(t,n){return t.fire("ResizeContent",n)},Zb=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),ty="tinymce-custom-colors",ny="choiceitem",ey=[{type:ny,text:"Light Green",value:"#BFEDD2"},{type:ny,text:"Light Yellow",value:"#FBEEB8"},{type:ny,text:"Light Red",value:"#F8CAC6"},{type:ny,text:"Light Purple",value:"#ECCAFA"},{type:ny,text:"Light Blue",value:"#C2E0F4"},{type:ny,text:"Green",value:"#2DC26B"},{type:ny,text:"Yellow",value:"#F1C40F"},{type:ny,text:"Red",value:"#E03E2D"},{type:ny,text:"Purple",value:"#B96AD9"},{type:ny,text:"Blue",value:"#3598DB"},{type:ny,text:"Dark Turquoise",value:"#169179"},{type:ny,text:"Orange",value:"#E67E23"},{type:ny,text:"Dark Red",value:"#BA372A"},{type:ny,text:"Dark Purple",value:"#843FA1"},{type:ny,text:"Dark Blue",value:"#236FA1"},{type:ny,text:"Light Gray",value:"#ECF0F1"},{type:ny,text:"Medium Gray",value:"#CED4D9"},{type:ny,text:"Gray",value:"#95A5A6"},{type:ny,text:"Dark Gray",value:"#7E8C8D"},{type:ny,text:"Navy Blue",value:"#34495E"},{type:ny,text:"Black",value:"#000000"},{type:ny,text:"White",value:"#ffffff"}],oy=function(t){void 0===t&&(t=10);var n,e=Zb.getItem(ty),o=st(e)?JSON.parse(e):[],r=t-(n=o).length<0?n.slice(0,t):n,i=function(t){r.splice(t,1)};return{add:function(n){var e;(-1===(e=wt(r,n))?ut.none():ut.some(e)).each(i),r.unshift(n),r.length>t&&r.pop(),Zb.setItem(ty,JSON.stringify(r))},state:function(){return r.slice(0)}}}(10),ry=function(t){return!1!==t.getParam("custom_colors")},iy=function(t){var n=t.getParam("color_map");return n!==undefined?function(t){var n=[],e=document.createElement("canvas");e.height=1,e.width=1;for(var o=e.getContext("2d"),r=function(t,n){var e=n/255;return("0"+Math.round(t*e+255*(1-e)).toString(16)).slice(-2).toUpperCase()},i=0;i<t.length;i+=2)n.push({text:t[i+1],value:function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase();o.clearRect(0,0,e.width,e.height),o.fillStyle="#FFFFFF",o.fillStyle=t,o.fillRect(0,0,1,1);var n=o.getImageData(0,0,1,1).data,i=n[0],u=n[1],a=n[2],c=n[3];return"#"+r(i,c)+r(u,c)+r(a,c)}(t[i]),type:"choiceitem"});return n}(n):ey},uy=function(t){oy.add(t)},ay=function(t){t.addCommand("mceApplyTextcolor",function(n,e){var o,r,i;r=n,i=e,(o=t).undoManager.transact(function(){o.focus(),o.formatter.apply(r,{value:i}),o.nodeChanged()})}),t.addCommand("mceRemoveTextcolor",function(n){var e,o;o=n,(e=t).undoManager.transact(function(){e.focus(),e.formatter.remove(o,{value:null},null,!0),e.nodeChanged()})})},cy=function(t){var n,e;return e=(n=iy(t).length,Math.max(5,Math.ceil(Math.sqrt(n)))),t.getParam("color_cols",e,"number")},sy=function(t,n,e,o){"custom"===e?py(t)(function(e){e.each(function(e){uy(e),t.execCommand("mceApplyTextcolor",n,e),o(e)})},"#000000"):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},ly=function(t,n){return t.concat(_t(oy.state(),function(t){return{type:ny,text:t,value:t}}).concat((o={type:e="choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},n?[o,{type:e,text:"Custom color",icon:"color-picker",value:"custom"}]:[o])));var e,o},fy=function(t,n){return function(e){e(ly(t,n))}},dy=function(t,n,e){var o,r;o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",r=e,t.setIconFill(o,r),t.setIconStroke(o,r)},my=function(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){var o,r,i;return ut.from((r=e,(o=t).dom.getParents(o.selection.getStart(),function(t){var n;(n=t.style["forecolor"===r?"color":"background-color"])&&(i=i||n)}),i)).bind(function(t){return function(t){if("transparent"===t)return ut.some(Gb(0,0,0,0));var n=Ub.exec(t);if(null!==n)return ut.some(Kb(n[1],n[2],n[3],"1"));var e=Wb.exec(t);return null!==e?ut.some(Kb(e[1],e[2],e[3],e[4])):ut.none()}(t).map(function(t){var e=zb(t).value;return io(n.toLowerCase(),e)})}).getOr(!1)},columns:cy(t),fetch:fy(iy(t),ry(t)),onAction:function(){null!==r.get()&&sy(t,e,r.get(),function(){})},onItemAction:function(o,i){sy(t,e,i,function(e){var o;r.set(e),o={name:n,color:e},t.fire("TextColorChange",o)})},onSetup:function(e){null!==r.get()&&dy(e,n,r.get());var o=function(t){t.name===n&&dy(e,t.name,t.color)};return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},gy=function(t,n,e,o){t.ui.registry.addNestedMenuItem(n,{text:o,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){sy(t,e,n.value,Y)}}]}})},py=function(t){return function(n,e){var o,r={colorpicker:e},i=(o=n,function(t){var n=t.getData();o(ut.from(n.colorpicker)),t.close()});t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:function(t,n){"hex-valid"===n.name&&(n.value?t.enable("ok"):t.disable("ok"))},onSubmit:i,onClose:function(){},onCancel:function(){n(ut.none())}})}},hy=function(t,n,e,o,r,i,u,a){var c=Zh(n),s=vy(n,e,o,"color"!==r?"normal":"color",i,u,a);return ev(t,c,s,o,r)},vy=function(t,n,e,o,r,i,u){return Td(_t(t,function(a){return"choiceitem"===a.type?fe("choicemenuitem",rv,a).fold(tv,function(c){return ut.some(function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=Db({presets:e,textContent:n?t.text:ut.none(),htmlContent:ut.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:ut.none(),checkMark:n?ut.some(_b(u.icons)):ut.none(),caret:ut.none(),value:t.value},u,a);return On(yb({data:xb(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){cp.set(t,n)},isActive:function(){return cp.isOn(t)},isDisabled:function(){return Rv.isDisabled(t)},setDisabled:function(n){return Rv.set(t,n)}}},onAction:function(){return o(t.value)},onSetup:function(t){return t.setActive(r),function(){}},triggersSubmenu:!1,itemBehaviours:[]},c,i,u),{toggling:{toggleClass:Lh,toggleOnExecute:!1,selected:t.active}})}(c,1===e,o,n,i(a.value),r,u,Zh(t)))}):ut.none()}))},by=function(t,n){var e=Yh(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},yy=Mi("cell-over"),xy=Mi("cell-execute"),wy=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(function(t,n,e){var o,r=function(e){return Ar(e,xy,{row:t,col:n})},i=function(t,n){n.stop(),r(t)};return Ju({dom:{tag:"div",attributes:((o={role:"button"})["aria-labelledby"]=e,o)},behaviours:Pc([Gg("insert-table-picker-cell",[zr(Yo(),Jg.focus),zr(sr(),r),zr(tr(),i),zr(fr(),i)]),cp.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),Jg.config({onFocus:function(e){return Ar(e,yy,{row:t,col:n})}})])})}(r,u,t));o.push(i)}return o},Sy={inserttable:function(t){var n=Mi("size-label"),e=wy(n,10,10),o=Yp({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[Yu("0x0")],behaviours:Pc([Wg.config({})])});return{type:"widget",data:{value:Mi("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Mb.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:Rt(e,function(t){return _t(t,$u)}).concat(o.asSpec()),behaviours:Pc([Gg("insert-table-picker",[Ur(yy,function(t,n,r){var i=r.event.row,u=r.event.col;!function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)cp.set(t[i][u],i<=n&&u<=e)}(e,i,u,10,10),Wg.set(o.get(t),[Yu(u+1+"x"+(i+1))])}),Ur(xy,function(n,e,o){t.onAction({numRows:o.event.row+1,numColumns:o.event.col+1}),Dr(n,mr())})]),zg.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e=ly(n.colorinput.getColors(),n.colorinput.hasCustomColors()),o=n.colorinput.getColorCols(),r=hy(Mi("menu-value"),e,function(n){t.onAction({value:n})},o,"color",Vh.CLOSE_ON_EXECUTE,function(){return!1},n.shared.providers),i=et(et({},r),{markers:Yh("color"),movement:by(o,"color")});return{type:"widget",data:{value:Mi("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[Mb.widget(_p.sketch(i))]}}},ky=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c,s,l=Db({presets:o,textContent:ut.none(),htmlContent:e?t.text.map(function(t){return Ab(t,n)}):ut.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:ut.none(),checkMark:ut.none(),caret:ut.none(),value:t.value},u.providers,a,t.icon);return yb({data:xb(t),disabled:t.disabled,getApi:function(){return{}},onAction:function(){return r(t.value,t.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:(c=t.meta,s=u,yn(c,"tooltipWorker").map(function(t){return[yv.config({lazySink:s.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:fs}}},mode:"follow-highlight",onShow:function(n){t(function(t){yv.setComponents(n,[qu({element:$e.fromDom(t)})])})}})]}).getOr([]))},l,i,u.providers)},Cy=function(t){var n=t.text.fold(function(){return{}},function(t){return{innerHtml:t}});return{type:"separator",dom:et({tag:"div",classes:[Hh,"tox-collection__group-heading"]},n),components:[]}},Oy=function(t,n,e,o){void 0===o&&(o=!0);var r=Db({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:ut.none(),ariaLabel:t.text,caret:ut.none(),checkMark:ut.none(),shortcutContent:t.shortcut},e,o);return yb({data:xb(t),getApi:function(t){return{isDisabled:function(){return Rv.isDisabled(t)},setDisabled:function(n){return Rv.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)},_y=function(t,n,e,o,r){void 0===o&&(o=!0),void 0===r&&(r=!1);var i,u,a=r?(u=e.icons,{dom:{tag:"div",classes:[Uh],innerHtml:Kp("chevron-down",u)}}):(i=e.icons,{dom:{tag:"div",classes:[Uh],innerHtml:Kp("chevron-right",i)}}),c=Db({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:ut.none(),ariaLabel:t.text,caret:ut.some(a),checkMark:ut.none(),shortcutContent:t.shortcut},e,o);return yb({data:xb(t),getApi:function(t){return{isDisabled:function(){return Rv.isDisabled(t)},setDisabled:function(n){return Rv.set(t,n)}}},disabled:t.disabled,onAction:Y,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},c,n,e)},Ty=function(t,n,e,o){void 0===o&&(o=!0);var r=Db({iconContent:t.icon,textContent:t.text,htmlContent:ut.none(),ariaLabel:t.text,checkMark:ut.some(_b(e.icons)),caret:ut.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return On(yb({data:xb(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){cp.set(t,n)},isActive:function(){return cp.isOn(t)},isDisabled:function(){return Rv.isDisabled(t)},setDisabled:function(n){return Rv.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:Lh,toggleOnExecute:!1,selected:t.active}})},Ey=function(t,n){return e=Sy,o=t.fancytype,(Object.prototype.hasOwnProperty.call(e,o)?ut.some(e[o]):ut.none()).map(function(e){return e(t,n)});var e,o};(Qv=$v=$v||{})[Qv.ContentFocus=0]="ContentFocus",Qv[Qv.UiFocus=1]="UiFocus";var By,Dy,Ay,My,Fy=function(t,n,e,o,r){var i=e.shared.providers,u=function(t){return r?et(et({},t),{shortcut:ut.none(),icon:t.text.isSome()?ut.none():t.icon}):t};switch(t.type){case"menuitem":return fe("menuitem",uv,t).fold(tv,function(t){return ut.some(Oy(u(t),n,i,o))});case"nestedmenuitem":return fe("nestedmenuitem",av,t).fold(tv,function(t){return ut.some(_y(u(t),n,i,o,r))});case"togglemenuitem":return fe("togglemenuitem",cv,t).fold(tv,function(t){return ut.some(Ty(u(t),n,i,o))});case"separator":return fe("separatormenuitem",hh,t).fold(tv,function(t){return ut.some(Cy(t))});case"fancymenuitem":return fe("fancymenuitem",iv,t).fold(tv,function(t){return Ey(u(t),e)});default:return console.error("Unknown item in general menu",t),ut.none()}},Iy=function(t,n,e,o,r,i){var u=1===o,a=!u||Zh(t);return Td(_t(t,function(t){return"separator"===t.type?fe("Autocompleter.Separator",hh,t).fold(tv,function(t){return ut.some(Cy(t))}):fe("Autocompleter.Item",vh,t).fold(tv,function(t){return ut.some(ky(t,n,u,"normal",e,r,i,a))})}))},Ry=function(t,n,e,o,r){var i=Zh(n),u=Td(_t(n,function(t){var n=function(t){return Fy(t,e,o,r?!t.hasOwnProperty("text"):i,r)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(et(et({},t),{disabled:!0})):n(t)}));return(r?nv:ev)(t,i,u,1,"normal")},Vy=function(t){return Mp.singleData(t.value,t)},Py=function(t,n){var e=Ke(ut.none()),o=Ke(!1),r=Ju(Fp.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:Pc([Gg("dismissAutocompleter",[zr(Sr(),function(){return a()})])]),lazySink:n.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&Fp.hide(r)},a=function(){var n;i()&&(n=e.get().map(function(t){return t.element}),eh(n.getOr($e.fromDom(t.selection.getNode()))).each(bi),u(),e.set(ut.none()),o.set(!1))},c=Tn(function(){return Fh(t)}),s=function(n,e,o,i){n.matchLength=e.text.length;var u,a,c,s,l,f,d,m=Ut(o,function(t){return ut.from(t.columns)}).getOr(1);Fp.showAt(r,{anchor:"node",root:$e.fromDom(t.getBody()),node:ut.from(n.element)},_p.sketch((u=ev("autocompleter-value",!0,i,m,"normal"),a=m,s="normal",l=((c=$v.ContentFocus)===$v.ContentFocus?lm:sm)(),f=by(a,s),d=Yh(s),{dom:u.dom,components:u.components,items:u.items,value:u.value,markers:{selectedItem:d.selectedItem,item:d.item},movement:f,fakeFocus:c===$v.ContentFocus,focusManager:l,menuBehaviours:fv("auto"!==a?[]:[Xr(function(t){sv(t,4,d.item).each(function(n){var e=n.numColumns,o=n.numRows;zg.setGridSize(t,o,e)})})])}))),Fp.getContent(r).each(jd.highlightFirst)},l=function(r){var f;f=r,e.get().map(function(n){return ah(t.dom,t.selection.getRng(),n.triggerChar).bind(function(n){return ph(t,c,n,f)})}).getOrThunk(function(){return gh(t,c)}).fold(a,function(r){var c,f;c=r.context,i()||(f=nh(t,c.range),e.set(ut.some({triggerChar:c.triggerChar,element:f,matchLength:c.text.length})),o.set(!1)),r.lookupData.then(function(i){e.get().map(function(e){var c,f,d,m,g=r.context;e.triggerChar===g.triggerChar&&(f=g.triggerChar,m=Ut(d=i,function(t){return ut.from(t.columns)}).getOr(1),0<(c=Rt(d,function(e){var r=e.items;return Iy(r,e.matchText,function(n,r){var i=t.selection.getRng();ah(t.dom,i,f).fold(function(){return console.error("Lost context. Cursor probably moved")},function(t){var i=t.range,c={hide:function(){a()},reload:function(t){u(),l(t)}};o.set(!0),e.onAction(c,i,n,r),o.set(!1)})},m,Vh.BUBBLE_TO_SANDBOX,n)})).length?s(e,g,i,c):(10<=g.text.length-e.matchLength?a:u)())})})})},f={onKeypress:Qp(function(t){27!==t.which&&l()},50),cancelIfNecessary:a,isMenuOpen:function(){return Fp.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return Fp.getContent(r)}};ch(f,t)},Hy=tt,zy=function(t,n,e){return la(t,n,Hy,e,!1)},Ny=function(t,n,e){return la(t,n,Hy,e,!0)},Ly=sa,jy=function(t,n,e){return Ea(t,n,e).isSome()},Uy=function(t){var n=t.raw;return n.touches===undefined||1!==n.touches.length?ut.none():ut.some(n.touches[0])},Wy=function(t){var n=Ke(ut.none()),e=Ke(!1),o=u(function(n){t.triggerEvent(dr(),n),e.set(!0)},400),r=Pn([{key:zo(),value:function(t){return Uy(t).each(function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:t.target};o.schedule(t),e.set(!1),n.set(ut.some(i))}),ut.none()}},{key:No(),value:function(t){return o.cancel(),Uy(t).each(function(t){n.get().each(function(e){var o,r,i,u;o=t,r=e,i=Math.abs(o.clientX-r.x),u=Math.abs(o.clientY-r.y),(5<i||5<u)&&n.set(ut.none())})}),ut.none()}},{key:Lo(),value:function(r){return o.cancel(),n.get().filter(function(t){return Bo(t.target,r.target)}).map(function(){return e.get()?(r.prevent(),!1):t.triggerEvent(fr(),r)})}}]);return{fireIfReady:function(t,n){return yn(r,n).bind(function(n){return n(t)})}}},Gy=function(){return _o().browser.isFirefox()},Xy=Kn([De("triggerEvent"),Ne("stopBackspace",!0)]),Yy=function(t,n){var e,o,r,i,u=me("Getting GUI events settings",Xy,n),a=Wy(u),c=_t(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),function(n){return zy(t,n,function(t){a.fireIfReady(t,n).each(function(n){n&&t.kill()}),u.triggerEvent(n,t)&&t.kill()})}),s=Ke(ut.none()),l=zy(t,"paste",function(t){a.fireIfReady(t,"paste").each(function(n){n&&t.kill()}),u.triggerEvent("paste",t)&&t.kill(),s.set(ut.some(setTimeout(function(){u.triggerEvent(ar(),t)},0)))}),f=zy(t,"keydown",function(t){var n;u.triggerEvent("keydown",t)?t.kill():!0!==u.stopBackspace||(n=t).raw.which!==Ud[0]||St(["input","textarea"],Jr(n.target))||jy(n.target,'[contenteditable="true"]')||t.prevent()}),d=(e=t,o=function(t){u.triggerEvent("focusin",t)&&t.kill()},Gy()?Ny(e,"focus",o):zy(e,"focusin",o)),m=Ke(ut.none()),g=(r=t,i=function(t){u.triggerEvent("focusout",t)&&t.kill(),m.set(ut.some(setTimeout(function(){u.triggerEvent(ur(),t)},0)))},Gy()?Ny(r,"blur",i):zy(r,"focusout",i));return{unbind:function(){Tt(c,function(t){t.unbind()}),f.unbind(),d.unbind(),g.unbind(),l.unbind(),s.get().each(clearTimeout),m.get().each(clearTimeout)}}},qy=function(t,n){var e=yn(t,"target").getOr(n);return Ke(e)},Ky=Sn([{stopped:[]},{resume:["element"]},{complete:[]}]),Jy=function(t,n,e,o,r,i){var u,a,c,s,l=t(n,o),f=(u=e,a=r,c=Ke(!1),s=Ke(!1),{stop:function(){c.set(!0)},cut:function(){s.set(!0)},isStopped:c.get,isCut:s.get,event:u,setSource:a.set,getSource:a.get});return l.fold(function(){return i.logEventNoHandlers(n,o),Ky.complete()},function(t){var e=t.descHandler;return Zi(e)(f),f.isStopped()?(i.logEventStopped(n,t.element,e.purpose),Ky.stopped()):f.isCut()?(i.logEventCut(n,t.element,e.purpose),Ky.complete()):ui(t.element).fold(function(){return i.logNoParent(n,t.element,e.purpose),Ky.complete()},function(o){return i.logEventResponse(n,t.element,e.purpose),Ky.resume(o)})})},$y=function(t,n,e,o,r,i){return Jy(t,n,e,o,r,i).fold(function(){return!0},function(o){return $y(t,n,e,o,r,i)},function(){return!1})},Qy=function(t,n){var e,o,r=(e=n,o=Ke(!1),{stop:function(){o.set(!0)},cut:Y,isStopped:o.get,isCut:Z,event:e,setSource:Q("Cannot set source of a broadcasted event"),getSource:Q("Cannot get source of a broadcasted event")});return Tt(t,function(t){var n=t.descHandler;Zi(n)(r)}),r.isStopped()},Zy=function(t,n,e,o,r){var i=qy(e,o);return $y(t,n,e,o,i,r)},tx=function(t,n){return{element:t,descHandler:n}},nx=function(t,n){return{id:t,descHandler:n}},ex=Od({name:"Container",factory:function(t){var e=t.dom,o=e.attributes,r=n(e,["attributes"]);return{uid:t.uid,dom:et({tag:"div",attributes:et({role:"presentation"},o)},r),components:t.components,
behaviours:kf(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[Ne("components",[]),Sf("containerBehaviours",[]),Ne("events",{}),Ne("domModification",{}),Ne("eventOrder",{})]}),ox=function(t){var n=function(n){return ui(t.element).fold(function(){return!0},function(t){return Bo(n,t)})},e=c(),o=function(t,o){return e.find(n,t,o)},r=Yy(t.element,{triggerEvent:function(t,n){return Pa(t,n.target,function(e){return i=e,Zy(o,t,r=n,r.target,i);var r,i})}}),i={debugInfo:K("real"),triggerEvent:function(t,n,e){Pa(t,n,function(r){return Zy(o,t,e,n,r)})},triggerFocus:function(t,n){Hi(t).fold(function(){Gc(t)},function(){Pa(ir(),t,function(e){var r,i,u,a,c,s;return r=o,i=ir(),c=e,s=qy(u={originator:n,kill:Y,prevent:Y,target:t},a=t),Jy(r,i,u,a,s,c),!1})})},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return p(t)},getByDom:function(t){return h(t)},build:Ju,addToGui:function(t){s(t)},removeFromGui:function(t){l(t)},addToWorld:function(t){u(t)},removeFromWorld:function(t){a(t)},broadcast:function(t){d(t)},broadcastOn:function(t,n){m(t,n)},broadcastEvent:function(t,n){g(t,n)},isConnected:tt},u=function(t){t.connect(i),Zr(t.element)||(e.register(t),Tt(t.components(),u),i.triggerEvent(pr(),t.element,{target:t.element}))},a=function(t){Zr(t.element)||(Tt(t.components(),a),e.unregister(t)),t.disconnect()},s=function(n){Pl(t,n)},l=function(t){Nl(t)},f=function(t){var n=e.filter(cr());Tt(n,function(n){var e=n.descHandler;Zi(e)(t)})},d=function(t){f({universal:!0,data:t})},m=function(t,n){f({universal:!1,channels:t,data:n})},g=function(t,n){var o=e.filter(t);return Qy(o,n)},p=function(t){return e.getById(t).fold(function(){return Xt.error(new Error('Could not find component with uid: "'+t+'" in system.'))},Xt.value)},h=function(t){var n=Hi(t).getOr("not found");return p(n)};return u(t),{root:t,element:t.element,destroy:function(){r.unbind(),vi(t.element)},add:s,remove:l,getByUid:p,getByDom:h,addToWorld:u,removeFromWorld:a,broadcast:d,broadcastOn:m,broadcastEvent:g}},rx=K([Ne("prefix","form-field"),Sf("fieldBehaviours",[Ad,wf])]),ix=K([Zf({schema:[_e("dom")],name:"label"}),Zf({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[_e("text")],name:"aria-descriptor"}),$f({factory:{sketch:function(t){var n=Rn(t,["factory"]);return t.factory.sketch(n)}},schema:[_e("factory")],name:"field"})]),ux=_d({name:"FormField",configFields:rx(),partFields:ix(),factory:function(t,n){var e=Cf(t.fieldBehaviours,[Ad.config({find:function(n){return fd(n,t,"field")}}),wf.config({store:{mode:"manual",getValue:function(t){return Ad.getCurrent(t).bind(wf.getValue)},setValue:function(t,n){Ad.getCurrent(t).each(function(t){wf.setValue(t,n)})}}})]),o=Vr([Xr(function(n){var e=md(n,t,["label","field","aria-descriptor"]);e.field().each(function(n){var o=Mi(t.prefix);e.label().each(function(t){Si(t.element,"for",o),Si(n.element,"id",o)}),e["aria-descriptor"]().each(function(e){var o=Mi(t.prefix);Si(e.element,"id",o),Si(n.element,"aria-describedby",o)})})})]),r={getField:function(n){return fd(n,t,"field")},getLabel:function(n){return fd(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:e,events:o,apis:r}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),ax=Object.freeze({__proto__:null,exhibit:function(t,n){return $i({attributes:Pn([{key:n.tabAttr,value:"true"}])})}}),cx=[Ne("tabAttr","data-alloy-tabstop")],sx=zc({fields:cx,name:"tabstopping",active:ax}),lx=function(t,n,e,o){var r=fx(t,n,e,o);return ux.sketch(r)},fx=function(t,n,e,o){return{dom:dx(e),components:t.toArray().concat([n]),fieldBehaviours:Pc(o)}},dx=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},mx=function(t,n){return ux.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},gx=Mi("form-component-change"),px=Mi("form-close"),hx=Mi("form-cancel"),vx=Mi("form-action"),bx=Mi("form-submit"),yx=Mi("form-block"),xx=Mi("form-unblock"),wx=Mi("form-tabchange"),Sx=Mi("form-resize"),kx=function(t,n){var e,o,r,i=t.label.map(function(t){return mx(t,n)}),u=function(t){return function(n,e){Ea(e.event.target,"[data-collection-item-value]").each(function(o){t(n,e,o,ki(o,"data-collection-item-value"))})}},a=function(e,o){var r=_t(o,function(e){var o,r=wv.translate(e.text),i=1===t.columns?'<div class="tox-collection__item-label">'+r+"</div>":"",u='<div class="tox-collection__item-icon">'+e.icon+"</div>",a={_:" "," - ":" ","-":" "},c=r.replace(/\_| \- |\-/g,function(t){return a[t]});return'<div class="tox-collection__item'+(n.isReadOnly()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+('"'===(o=e.value)?"&quot;":o)+'" title="'+c+'" aria-label="'+c+'">'+u+i+"</div>"}),i="auto"!==t.columns&&1<t.columns?Ot(r,t.columns):[r],u=_t(i,function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"});xi(e.element,u.join(""))},c=u(function(e,o,r,i){o.stop(),n.isReadOnly()||Ar(e,vx,{name:t.name,value:i})}),s=[zr(Yo(),u(function(t,n,e){Gc(e)})),zr(tr(),c),zr(fr(),c),zr(qo(),u(function(t,n,e){Ta(t.element,"."+Wh).each(function(t){mu(t,Wh)}),fu(e,Wh)})),zr(Ko(),u(function(t){Ta(t.element,"."+Wh).each(function(t){mu(t,Wh)})})),Kr(u(function(n,e,o,r){Ar(n,vx,{name:t.name,value:r})}))],l=function(t,n){return _t(Ys(t.element,".tox-collection__item"),n)},f=ux.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:J},behaviours:Pc([Rv.config({disabled:n.isReadOnly,onDisabled:function(t){l(t,function(t){fu(t,"tox-collection__item--state-disabled"),Si(t,"aria-disabled",!0)})},onEnabled:function(t){l(t,function(t){mu(t,"tox-collection__item--state-disabled"),_i(t,"aria-disabled")})}}),sb(),Wg.config({}),wf.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,e){a(n,e),"auto"===t.columns&&sv(n,5,"tox-collection__item").each(function(t){var e=t.numRows,o=t.numColumns;zg.setGridSize(n,e,o)}),Dr(n,Sx)}}),sx.config({}),zg.config((o=t.columns,r="normal",1===o?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===o?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===r?".tox-swatches__row":".tox-collection__group",cell:"color"===r?"."+zh:"."+Hh}})),Gg("collection-events",s)]),eventOrder:((e={})[sr()]=["disabling","alloy.base.behaviour","collection-events"],e)});return lx(i,f,["tox-form__group--collection"],[])},Cx=K([Ie("data"),Ne("inputAttributes",{}),Ne("inputStyles",{}),Ne("tag","input"),Ne("inputClasses",[]),Xa("onSetValue"),Ne("styles",{}),Ne("eventOrder",{}),Sf("inputBehaviours",[wf,Jg]),Ne("selectOnFocus",!0)]),Ox=function(t){return Pc([Jg.config({onFocus:t.selectOnFocus?function(t){var n=t.element,e=zu(n);n.dom.setSelectionRange(0,e.length)}:Y})])},_x=function(t){return{tag:t.tag,attributes:et({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},Tx=Od({name:"Input",configFields:Cx(),factory:function(t){return{uid:t.uid,dom:_x(t),components:[],behaviours:et(et({},Ox(n=t)),Cf(n.inputBehaviours,[wf.config({store:et(et({mode:"manual"},n.data.map(function(t){return{initialValue:t}}).getOr({})),{getValue:function(t){return zu(t.element)},setValue:function(t,n){zu(t.element)!==n&&Nu(t.element,n)}}),onSetValue:n.onSetValue})])),eventOrder:t.eventOrder};var n}}),Ex={},Bx={exports:Ex};By=undefined,Dy=Ex,Ay=Bx,My=undefined,function(t){"object"==typeof Dy&&void 0!==Ay?Ay.exports=t():"function"==typeof By&&By.amd?By([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=t()}(function(){return function t(n,e,o){function r(u,a){if(!e[u]){if(!n[u]){var c="function"==typeof My&&My;if(!a&&c)return c(u,!0);if(i)return i(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var l=e[u]={exports:{}};n[u][0].call(l.exports,function(t){return r(n[u][1][t]||t)},l,l.exports,t,n,e,o)}return e[u].exports}for(var i="function"==typeof My&&My,u=0;u<o.length;u++)r(o[u]);return r}({1:[function(t,n){function e(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function r(t){if(s===setTimeout)return setTimeout(t,0);if((s===e||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function i(){g&&d&&(g=!1,d.length?m=d.concat(m):p=-1,m.length&&u())}function u(){if(!g){var t=r(i);g=!0;for(var n=m.length;n;){for(d=m,m=[];++p<n;)d&&d[p].run();p=-1,n=m.length}d=null,g=!1,function(t){if(l===clearTimeout)return clearTimeout(t);if((l===o||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}(t)}}function a(t,n){this.fun=t,this.array=n}function c(){}var s,l,f=n.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:e}catch(t){s=e}try{l="function"==typeof clearTimeout?clearTimeout:o}catch(t){l=o}}();var d,m=[],g=!1,p=-1;f.nextTick=function(t){var n=new Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];m.push(new a(t,n)),1!==m.length||g||r(u)},a.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(){return[]},f.binding=function(){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},{}],2:[function(t,n){(function(t){function e(){}function o(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=undefined,this._deferreds=[],s(t,this)}function r(t,n){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,o._immediateFn(function(){var e,o=1===t._state?n.onFulfilled:n.onRejected;if(null!==o){try{e=o(t._value)}catch(f){return void u(n.promise,f)}i(n.promise,e)}else(1===t._state?i:u)(n.promise,t._value)})):t._deferreds.push(n)}function i(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof o)return t._state=3,t._value=n,void a(t);if("function"==typeof e)return void s((r=e,c=n,function(){r.apply(c,arguments)}),t)}t._state=1,t._value=n,a(t)}catch(i){u(t,i)}var r,c}function u(t,n){t._state=2,t._value=n,a(t)}function a(t){2===t._state&&0===t._deferreds.length&&o._immediateFn(function(){t._handled||o._unhandledRejectionFn(t._value)});for(var n=0,e=t._deferreds.length;n<e;n++)r(t,t._deferreds[n]);t._deferreds=null}function c(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function s(t,n){var o=!1;try{t(function(t){o||(o=!0,i(n,t))},function(t){o||(o=!0,u(n,t))})}catch(e){if(o)return;o=!0,u(n,e)}}var l,f;l=this,f=setTimeout,o.prototype["catch"]=function(t){return this.then(null,t)},o.prototype.then=function(t,n){var o=new this.constructor(e);return r(this,new c(t,n,o)),o},o.all=function(t){var n=Array.prototype.slice.call(t);return new o(function(t,o){if(0===n.length)return t([]);for(var r=n.length,i=0;i<n.length;i++)!function u(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,function(t){u(i,t)},o)}n[i]=a,0==--r&&t(n)}catch(e){o(e)}}(i,n[i])})},o.resolve=function(t){return t&&"object"==typeof t&&t.constructor===o?t:new o(function(n){n(t)})},o.reject=function(t){return new o(function(n,e){e(t)})},o.race=function(t){return new o(function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)})},o._immediateFn="function"==typeof t?function(n){t(n)}:function(t){f(t,0)},o._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},o._setImmediateFn=function(t){o._immediateFn=t},o._setUnhandledRejectionFn=function(t){o._unhandledRejectionFn=t},void 0!==n&&n.exports?n.exports=o:l.Promise||(l.Promise=o)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,n,e){(function(n,o){function r(t,n){this._id=t,this._clearFn=n}var i=t("process/browser.js").nextTick,u=Function.prototype.apply,a=Array.prototype.slice,c={},s=0;e.setTimeout=function(){return new r(u.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new r(u.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;0<=n&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},n))},e.setImmediate="function"==typeof n?n:function(t){var n=s++,o=!(arguments.length<2)&&a.call(arguments,1);return c[n]=!0,i(function(){c[n]&&(o?t.apply(null,o):t.call(null),e.clearImmediate(n))}),n},e.clearImmediate="function"==typeof o?o:function(t){delete c[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,n){var e=t("promise-polyfill"),o="undefined"!=typeof window?window:Function("return this;")();n.exports={boltExport:o.Promise||e}},{"promise-polyfill":2}]},{},[4])(4)});var Dx,Ax,Mx=Bx.exports.boltExport,Fx=function(t){var n=ut.none(),e=[],o=function(t){r()?u(t):e.push(t)},r=function(){return n.isSome()},i=function(t){Tt(t,u)},u=function(t){n.each(function(n){setTimeout(function(){t(n)},0)})};return t(function(t){r()||(n=ut.some(t),i(e),e=[])}),{get:o,map:function(t){return Fx(function(n){o(function(e){n(t(e))})})},isReady:r}},Ix={nu:Fx,pure:function(t){return Fx(function(n){n(t)})}},Rx=function(t){setTimeout(function(){throw t},0)},Vx=function(t){var n=function(n){t().then(n,Rx)};return{map:function(n){return Vx(function(){return t().then(n)})},bind:function(n){return Vx(function(){return t().then(function(t){return n(t).toPromise()})})},anonBind:function(n){return Vx(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return Ix.nu(n)},toCached:function(){var n=null;return Vx(function(){return null===n&&(n=t()),n})},toPromise:t,get:n}},Px=function(t){return Vx(function(){return new Mx(t)})},Hx=function(t){return Vx(function(){return Mx.resolve(t)})},zx=["input","textarea"],Nx=function(t){var n=Jr(t);return St(zx,n)},Lx=function(t,n){var e=n.getRoot(t).getOr(t.element);mu(e,n.invalidClass),n.notify.each(function(n){Nx(t.element)&&Si(t.element,"aria-invalid",!1),n.getContainer(t).each(function(t){xi(t,n.validHtml)}),n.onValid(t)})},jx=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element);fu(r,n.invalidClass),n.notify.each(function(n){Nx(t.element)&&Si(t.element,"aria-invalid",!0),n.getContainer(t).each(function(t){xi(t,o)}),n.onInvalid(t,o)})},Ux=function(t,n){return n.validator.fold(function(){return Hx(Xt.value(!0))},function(n){return n.validate(t)})},Wx=function(t,n){return n.notify.each(function(n){n.onValidate(t)}),Ux(t,n).map(function(e){return t.getSystem().isConnected()?e.fold(function(e){return jx(t,n,0,e),Xt.error(e)},function(e){return Lx(t,n),Xt.value(e)}):Xt.error("No longer in system")})},Gx=Object.freeze({__proto__:null,markValid:Lx,markInvalid:jx,query:Ux,run:Wx,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element);return gu(e,n.invalidClass)}}),Xx=Object.freeze({__proto__:null,events:function(t){return t.validator.map(function(n){return Vr([zr(n.onEvent,function(n){Wx(n,t).get(J)})].concat(n.validateOnLoad?[Xr(function(n){Wx(n,t).get(Y)})]:[]))}).getOr({})}}),Yx=[_e("invalidClass"),Ne("getRoot",ut.none),ze("notify",[Ne("aria","alert"),Ne("getContainer",ut.none),Ne("validHtml",""),Xa("onValid"),Xa("onInvalid"),Xa("onValidate")]),ze("validator",[_e("validate"),Ne("onEvent","input"),Ne("validateOnLoad",!0)])],qx=zc({fields:Yx,name:"invalidating",active:Xx,apis:Gx,extra:{validation:function(t){return function(n){var e=wf.getValue(n);return Hx(t(e))}}}}),Kx=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),Jx=[Te("others",le(Xt.value,ve()))],$x=zc({fields:Jx,name:"coupling",apis:Kx,state:Object.freeze({__proto__:null,init:function(){var t={},n=K({});return Ki({readState:n,getOrCreate:function(n,e,o){var r=ln(e.others);if(r)return yn(t,o).getOrThunk(function(){var r=yn(e.others,o).getOrDie("No information found for coupled component: "+o)(n),i=n.getSystem().build(r);return t[o]=i});throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}})}),Qx=K("sink"),Zx=K(Zf({name:Qx(),overrides:K({dom:{tag:"div"},behaviours:Pc([Ml.config({useFixed:tt})]),events:Vr([Wr(Jo()),Wr(Uo()),Wr(tr())])})}));(Ax=Dx=Dx||{})[Ax.HighlightFirst=0]="HighlightFirst",Ax[Ax.HighlightNone=1]="HighlightNone";var tw,nw,ew,ow,rw,iw,uw,aw,cw,sw,lw,fw,dw=function(t,n){var e=t.getHotspot(n).getOr(n),o=t.getAnchorOverrides();return t.layouts.fold(function(){return{anchor:"hotspot",hotspot:e,overrides:o}},function(t){return{anchor:"hotspot",hotspot:e,overrides:o,layouts:t}})},mw=function(t,n,e,o,r,i,u){var a,c,s,l,f,d,m,g,p,h,v=dw(t,e);return(c=v,l=o,f=r,d=u,m=n,g=s=e,p=(0,(a=t).fetch)(g).map(m),h=vw(s,a),p.map(function(t){return t.bind(function(t){return ut.from(Mp.sketch(et(et({},f.menu()),{uid:zi(""),data:t,highlightImmediately:d===Dx.HighlightFirst,onOpenMenu:function(t,n){var e=h().getOrDie();Ml.position(e,c,n),tf.decloak(l)},onOpenSubmenu:function(t,n,e){var o=h().getOrDie();Ml.position(o,{anchor:"submenu",item:n},e),tf.decloak(l)},onRepositionMenu:function(t,n,e){var o=h().getOrDie();Ml.position(o,c,n),Tt(e,function(t){Ml.position(o,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)})},onEscape:function(){return Jg.focus(s),tf.close(l),ut.some(!0)}})))})})).map(function(t){return t.fold(function(){tf.isOpen(o)&&tf.close(o)},function(t){tf.cloak(o),tf.open(o,t),i(o)}),o})},gw=function(t,n,e,o){return tf.close(o),Hx(o)},pw=function(t,n,e,o,r,i){var u=$x.getCoupled(e,"sandbox");return(tf.isOpen(u)?gw:mw)(t,n,e,u,o,r,i)},hw=function(t,n,e){var o,r,i=Ad.getCurrent(n).getOr(n),u=aa(t.element);e?Du(i.element,"min-width",u+"px"):(o=i.element,r=u,ua.set(o,r))},vw=function(t,n){return t.getSystem().getByUid(n.uid+"-"+Qx()).map(function(t){return function(){return Xt.value(t)}}).getOrThunk(function(){return n.lazySink.fold(function(){return function(){return Xt.error(new Error("No internal sink is specified, nor could an external sink be found"))}},function(n){return function(){return n(t)}})})},bw=function(t){tf.getState(t).each(function(t){Mp.repositionMenus(t)})},yw=function(t,n,e){var o=Ba(),r=vw(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:_f(t.sandboxBehaviours,[wf.config({store:{mode:"memory",initialValue:n}}),tf.config({onOpen:function(r,i){var u=dw(t,n);o.link(n.element),t.matchWidth&&hw(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),e!==undefined&&e.onOpen!==undefined&&e.onOpen(r,i)},onClose:function(t,r){o.unlink(n.element),e!==undefined&&e.onClose!==undefined&&e.onClose(t,r)},isPartOf:function(t,e,o){return Aa(e,o)||Aa(n,o)},getAttachPoint:function(){return r().getOrDie()}}),Ad.config({find:function(t){return tf.getState(t).bind(function(t){return Ad.getCurrent(t)})}}),Uc.config({channels:et(et({},uf({isExtraPart:Z})),cf({doReposition:bw}))})])}},xw=function(t){var n=$x.getCoupled(t,"sandbox");bw(n)},ww=function(){return[Ne("sandboxClasses",[]),Of("sandboxBehaviours",[Ad,Uc,tf,wf])]},Sw=K([_e("dom"),_e("fetch"),Xa("onOpen"),Ya("onExecute"),Ne("getHotspot",ut.some),Ne("getAnchorOverrides",K({})),Ss(),Sf("dropdownBehaviours",[cp,$x,zg,Jg]),_e("toggleClass"),Ne("eventOrder",{}),Ie("lazySink"),Ne("matchWidth",!1),Ne("useMinWidth",!1),Ie("role")].concat(ww())),kw=K([Qf({schema:[Ua()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),Zx()]),Cw=_d({name:"Dropdown",configFields:Sw(),partFields:kw(),factory:function(t,n,e,o){var r,i,u=function(t){tf.getState(t).each(function(t){Mp.highlightPrimary(t)})},a={expand:function(n){cp.isOn(n)||pw(t,function(t){return t},n,o,Y,Dx.HighlightNone).get(Y)},open:function(n){cp.isOn(n)||pw(t,function(t){return t},n,o,Y,Dx.HighlightFirst).get(Y)},isOpen:cp.isOn,close:function(n){cp.isOn(n)&&pw(t,function(t){return t},n,o,Y,Dx.HighlightFirst).get(Y)},repositionMenus:function(t){cp.isOn(t)&&xw(t)}},c=function(t){return Mr(t),ut.some(!0)};return{uid:t.uid,dom:t.dom,components:n,behaviours:Cf(t.dropdownBehaviours,[cp.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),$x.config({others:{sandbox:function(n){return yw(t,n,{onOpen:function(){cp.on(n)},onClose:function(){cp.off(n)}})}}}),zg.config({mode:"special",onSpace:c,onEnter:c,onDown:function(t){var n;return Cw.isOpen(t)?(n=$x.getCoupled(t,"sandbox"),u(n)):Cw.open(t),ut.some(!0)},onEscape:function(t){return Cw.isOpen(t)?(Cw.close(t),ut.some(!0)):ut.none()}}),Jg.config({})]),events:lp(ut.some(function(n){pw(t,function(t){return t},n,o,u,Dx.HighlightFirst).get(Y)})),eventOrder:et(et({},t.eventOrder),((r={})[sr()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:a,domModification:{attributes:et(et({"aria-haspopup":"true"},t.role.fold(function(){return{}},function(t){return{role:t}})),"button"===t.dom.tag?{type:(i="type",yn(t.dom,"attributes").bind(function(t){return yn(t,i)}).getOr("button"))}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),Ow=zc({fields:[],name:"unselecting",active:Object.freeze({__proto__:null,events:function(){return Vr([Pr(er(),tt)])},exhibit:function(){return $i({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}})}),_w=Mi("color-input-change"),Tw=Mi("color-swatch-change"),Ew=Mi("color-picker-cancel"),Bw=function(t,n,e){var o,r,i=ux.parts.field({factory:Tx,inputClasses:["tox-textfield"],onSetValue:function(t){return qx.run(t).get(function(){})},inputBehaviours:Pc([Rv.config({disabled:n.providers.isReadOnly}),sb(),sx.config({}),qx.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return ui(t.element)},notify:{onValid:function(t){var n=wf.getValue(t);Ar(t,_w,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=wf.getValue(t);if(0===n.length)return Hx(Xt.value(!0));var e=$e.fromTag("span");Du(e,"background-color",n);var o=Ru(e,"background-color").fold(function(){return Xt.error("blah")},function(){return Xt.value(n)});return Hx(o)}}})]),selectOnFocus:!1}),u=t.label.map(function(t){return mx(t,n.providers)}),a=function(t,n){Ar(t,Tw,{value:n})},c=Yp((o={dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[vc,hc,wc]},onLtr:function(){return[hc,vc,wc]}},components:[],fetch:fy(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:function(t,n){c.getOpt(t).each(function(t){"custom"===n?e.colorPicker(function(n){n.fold(function(){return Dr(t,Ew)},function(n){a(t,n),uy(n)})},"#ffffff"):a(t,"remove"===n?"":n)})}},r=n,Cw.sketch({dom:o.dom,components:o.components,toggleClass:"mce-active",dropdownBehaviours:Pc([fb(r.providers.isReadOnly),sb(),Ow.config({}),sx.config({})]),layouts:o.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:r.getSink,fetch:function(t){return Px(function(t){return o.fetch(t)}).map(function(n){return ut.from(Vy(On(hy(Mi("menu-value"),n,function(n){o.onItemAction(t,n)},o.columns,o.presets,Vh.CLOSE_ON_EXECUTE,function(){return!1},r.providers),{movement:by(o.columns,o.presets)})))})},parts:{menu:Kh(0,0,o.presets)}})));return ux.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:u.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[i,c.asSpec()]}]),fieldBehaviours:Pc([Gg("form-field-events",[zr(_w,function(n,e){c.getOpt(n).each(function(t){Du(t.element,"background-color",e.event.color)}),Ar(n,gx,{name:t.name})}),zr(Tw,function(t,n){ux.getField(t).each(function(e){wf.setValue(e,n.event.value),Ad.getCurrent(t).each(Jg.focus)})}),zr(Ew,function(t){ux.getField(t).each(function(){Ad.getCurrent(t).each(Jg.focus)})})])])})},Dw=function(t,n,e){return{hue:t,saturation:n,value:e}},Aw=Mi("rgb-hex-update"),Mw=Mi("slider-update"),Fw=Mi("palette-update"),Iw=Zf({schema:[_e("dom")],name:"label"}),Rw=function(t){return Zf({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold(function(){return{}},function(t){return{events:Vr([Nr(zo(),function(n,e,o){return t(n,o)},[n]),Nr(Uo(),function(n,e,o){return t(n,o)},[n]),Nr(Wo(),function(n,e,o){o.mouseIsDown.get()&&t(n,o)},[n])])}})}})},Vw=Rw("top-left"),Pw=Rw("top"),Hw=Rw("top-right"),zw=Rw("right"),Nw=Rw("bottom-right"),Lw=Rw("bottom"),jw=Rw("bottom-left"),Uw=[Iw,Rw("left"),zw,Pw,Lw,Vw,Hw,jw,Nw,$f({name:"thumb",defaults:K({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:Vr([jr(zo(),t,"spectrum"),jr(No(),t,"spectrum"),jr(Lo(),t,"spectrum"),jr(Uo(),t,"spectrum"),jr(Wo(),t,"spectrum"),jr(Xo(),t,"spectrum")])}}}),$f({schema:[qe("mouseIsDown",function(){return Ke(!1)})],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,o){return n.getValueFromEvent(o).map(function(o){return n.setValueFrom(e,t,o)})};return{behaviours:Pc([zg.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),Jg.config({})]),events:Vr([zr(zo(),e),zr(No(),e),zr(Uo(),e),zr(Wo(),function(n,o){t.mouseIsDown.get()&&e(n,o)})])}}})],Ww=K("slider.change.value"),Gw=function(t){var n=t.event.raw;return-1===n.type.indexOf("touch")?n.clientX!==undefined?ut.some(n).map(function(t){return ea(t.clientX,t.clientY)}):ut.none():n.touches!==undefined&&1===n.touches.length?ut.some(n.touches[0]).map(function(t){return ea(t.clientX,t.clientY)}):ut.none()},Xw=function(t){return t.model.minX},Yw=function(t){return t.model.minY},qw=function(t){return t.model.minX-1},Kw=function(t){return t.model.minY-1},Jw=function(t){return t.model.maxX},$w=function(t){return t.model.maxY},Qw=function(t){return t.model.maxX+1},Zw=function(t){return t.model.maxY+1},tS=function(t,n,e){return n(t)-e(t)},nS=function(t){return tS(t,Jw,Xw)},eS=function(t){return tS(t,$w,Yw)},oS=function(t){return nS(t)/2},rS=function(t){return eS(t)/2},iS=function(t){return t.stepSize},uS=function(t){return t.snapToGrid},aS=function(t){return t.snapStart},cS=function(t){return t.rounded},sS=function(t,n){return t[n+"-edge"]!==undefined},lS=function(t){return sS(t,"left")},fS=function(t){return sS(t,"right")},dS=function(t){return sS(t,"top")},mS=function(t){return sS(t,"bottom")},gS=function(t){return t.model.value.get()},pS=function(t){return{x:t}},hS=function(t){return{y:t}},vS=function(t,n){return{x:t,y:n}},bS=function(t,n){Ar(t,Ww(),{value:n})},yS=function(t,n,e,o){return t<n?t:e<t?e:t===n?n-1:Math.max(n,t-o)},xS=function(t,n,e,o){return e<t?t:t<n?n:t===e?e+1:Math.min(e,t+o)},wS=function(t,n,e){return Math.max(n,Math.min(e,t))},SS=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=l?e+1:e;if(r<f)return g;if(d<r)return p;var h,v,b,y,x,w,S,k=(x=r,w=f,S=d,Math.min(S,Math.max(x,w))-w),C=wS(k/m*o+n,g,p);return u&&n<=C&&C<=e?(h=C,v=n,b=e,y=i,a.fold(function(){var t=h-v,n=Math.round(t/y)*y;return wS(v+n,v-1,b+1)},function(t){var n=(h-t)%y,e=Math.round(n/y),o=Math.floor((h-t)/y),r=Math.floor((b-t)/y),i=t+Math.min(r,o+e)*y;return Math.max(t,i)})):c?Math.round(C):C},kS=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,l=t.centerMaxEdge;return r<n?i?0:s:e<r?u?a:l:(r-n)/o*c},CS="left",OS=function(t){return t.element.dom.getBoundingClientRect()},_S=function(t,n){return t[n]},TS=function(t){var n=OS(t);return _S(n,CS)},ES=function(t){var n=OS(t);return _S(n,"right")},BS=function(t){var n=OS(t);return _S(n,"top")},DS=function(t){var n=OS(t);return _S(n,"bottom")},AS=function(t){var n=OS(t);return _S(n,"width")},MS=function(t){var n=OS(t);return _S(n,"height")},FS=function(t,n,e){return(t+n)/2-e},IS=function(t,n){var e=OS(t),o=OS(n),r=_S(e,CS),i=_S(e,"right"),u=_S(o,CS);return FS(r,i,u)},RS=function(t,n){var e=OS(t),o=OS(n),r=_S(e,"top"),i=_S(e,"bottom"),u=_S(o,"top");return FS(r,i,u)},VS=function(t,n){Ar(t,Ww(),{value:n})},PS=function(t){return{x:t}},HS=function(t,n,e){var o={min:Xw(n),max:Jw(n),range:nS(n),value:e,step:iS(n),snap:uS(n),snapStart:aS(n),rounded:cS(n),hasMinEdge:lS(n),hasMaxEdge:fS(n),minBound:TS(t),maxBound:ES(t),screenRange:AS(t)};return SS(o)},zS=function(t){return function(n,e){return o=n,i=(0<t?xS:yS)(gS(r=e).x,Xw(r),Jw(r),iS(r)),VS(o,PS(i)),ut.some(i).map(function(){return!0});var o,r,i}},NS=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=AS(u=n),d=s.bind(function(t){return ut.some(IS(t,u))}).getOr(0),m=l.bind(function(t){return ut.some(IS(t,u))}).getOr(f),g={min:Xw(a),max:Jw(a),range:nS(a),value:c,hasMinEdge:lS(a),hasMaxEdge:fS(a),minBound:TS(u),minOffset:0,maxBound:ES(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},kS(g));return TS(n)-TS(t)+p},LS=zS(-1),jS=zS(1),US=ut.none,WS=ut.none,GS={"top-left":ut.none(),top:ut.none(),"top-right":ut.none(),right:ut.some(function(t,n){bS(t,pS(Qw(n)))}),"bottom-right":ut.none(),bottom:ut.none(),"bottom-left":ut.none(),left:ut.some(function(t,n){bS(t,pS(qw(n)))})},XS=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=HS(t,n,e),r=PS(o);return VS(t,r),o},setToMin:function(t,n){var e=Xw(n);VS(t,PS(e))},setToMax:function(t,n){var e=Jw(n);VS(t,PS(e))},findValueOfOffset:HS,getValueFromEvent:function(t){return Gw(t).map(function(t){return t.left})},findPositionOfValue:NS,setPositionFromValue:function(t,n,e,o){var r=gS(e),i=NS(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=aa(n.element)/2;Du(n.element,"left",i-u+"px")},onLeft:LS,onRight:jS,onUp:US,onDown:WS,edgeActions:GS}),YS=function(t,n){Ar(t,Ww(),{value:n})},qS=function(t){return{y:t}},KS=function(t,n,e){var o={min:Yw(n),max:$w(n),range:eS(n),value:e,step:iS(n),snap:uS(n),snapStart:aS(n),rounded:cS(n),hasMinEdge:dS(n),hasMaxEdge:mS(n),minBound:BS(t),maxBound:DS(t),screenRange:MS(t)};return SS(o)},JS=function(t){return function(n,e){return o=n,i=(0<t?xS:yS)(gS(r=e).y,Yw(r),$w(r),iS(r)),YS(o,qS(i)),ut.some(i).map(function(){return!0});var o,r,i}},$S=function(t,n,e,o,r,i){var u,a,c,s,l,f,d,m,g,p=(a=i,c=e,s=o,l=r,f=MS(u=n),d=s.bind(function(t){return ut.some(RS(t,u))}).getOr(0),m=l.bind(function(t){return ut.some(RS(t,u))}).getOr(f),g={min:Yw(a),max:$w(a),range:eS(a),value:c,hasMinEdge:dS(a),hasMaxEdge:mS(a),minBound:BS(u),minOffset:0,maxBound:DS(u),maxOffset:f,centerMinEdge:d,centerMaxEdge:m},kS(g));return BS(n)-BS(t)+p},QS=ut.none,ZS=ut.none,tk=JS(-1),nk=JS(1),ek={"top-left":ut.none(),top:ut.some(function(t,n){bS(t,hS(Kw(n)))}),"top-right":ut.none(),right:ut.none(),"bottom-right":ut.none(),bottom:ut.some(function(t,n){bS(t,hS(Zw(n)))}),"bottom-left":ut.none(),left:ut.none()},ok=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=KS(t,n,e),r=qS(o);return YS(t,r),o},setToMin:function(t,n){var e=Yw(n);YS(t,qS(e))},setToMax:function(t,n){var e=$w(n);YS(t,qS(e))},findValueOfOffset:KS,getValueFromEvent:function(t){return Gw(t).map(function(t){return t.top})},findPositionOfValue:$S,setPositionFromValue:function(t,n,e,o){var r=gS(e),i=$S(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=Zu(n.element)/2;Du(n.element,"top",i-u+"px")},onLeft:QS,onRight:ZS,onUp:tk,onDown:nk,edgeActions:ek}),rk=function(t,n){Ar(t,Ww(),{value:n})},ik=function(t,n){return{x:t,y:n}},uk=function(t,n){return function(e,o){return i=e,u=o,a=0<t?xS:yS,c=(r=n)?gS(u).x:a(gS(u).x,Xw(u),Jw(u),iS(u)),s=r?a(gS(u).y,Yw(u),$w(u),iS(u)):gS(u).y,rk(i,ik(c,s)),ut.some(c).map(function(){return!0});var r,i,u,a,c,s}
},ak=Gw,ck=uk(-1,!1),sk=uk(1,!1),lk=uk(-1,!0),fk=uk(1,!0),dk={"top-left":ut.some(function(t,n){bS(t,vS(qw(n),Kw(n)))}),top:ut.some(function(t,n){bS(t,vS(oS(n),Kw(n)))}),"top-right":ut.some(function(t,n){bS(t,vS(Qw(n),Kw(n)))}),right:ut.some(function(t,n){bS(t,vS(Qw(n),rS(n)))}),"bottom-right":ut.some(function(t,n){bS(t,vS(Qw(n),Zw(n)))}),bottom:ut.some(function(t,n){bS(t,vS(oS(n),Zw(n)))}),"bottom-left":ut.some(function(t,n){bS(t,vS(qw(n),Zw(n)))}),left:ut.some(function(t,n){bS(t,vS(qw(n),rS(n)))})},mk=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=HS(t,n,e.left),r=KS(t,n,e.top),i=ik(o,r);return rk(t,i),i},setToMin:function(t,n){var e=Xw(n),o=Yw(n);rk(t,ik(e,o))},setToMax:function(t,n){var e=Jw(n),o=$w(n);rk(t,ik(e,o))},getValueFromEvent:ak,setPositionFromValue:function(t,n,e,o){var r=gS(e),i=NS(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=$S(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=aa(n.element)/2,c=Zu(n.element)/2;Du(n.element,"left",i-a+"px"),Du(n.element,"top",u-c+"px")},onLeft:ck,onRight:sk,onUp:lk,onDown:fk,edgeActions:dk}),gk=_d({name:"Slider",configFields:[Ne("stepSize",1),Ne("onChange",Y),Ne("onChoose",Y),Ne("onInit",Y),Ne("onDragStart",Y),Ne("onDragEnd",Y),Ne("snapToGrid",!1),Ne("rounded",!0),Ie("snapStart"),Te("model",he("mode",{x:[Ne("minX",0),Ne("maxX",100),qe("value",function(t){return Ke(t.mode.minX)}),_e("getInitialValue"),Ja("manager",XS)],y:[Ne("minY",0),Ne("maxY",100),qe("value",function(t){return Ke(t.mode.minY)}),_e("getInitialValue"),Ja("manager",ok)],xy:[Ne("minX",0),Ne("maxX",100),Ne("minY",0),Ne("maxY",100),qe("value",function(t){return Ke({x:t.mode.minX,y:t.mode.minY})}),_e("getInitialValue"),Ja("manager",mk)]})),Sf("sliderBehaviours",[zg,wf]),qe("mouseIsDown",function(){return Ke(!1)})],partFields:Uw,factory:function(t,n){var e,o=function(n){return dd(n,t,"thumb")},r=function(n){return dd(n,t,"spectrum")},i=function(n){return fd(n,t,"left-edge")},u=function(n){return fd(n,t,"right-edge")},a=function(n){return fd(n,t,"top-edge")},c=function(n){return fd(n,t,"bottom-edge")},s=t.model,l=s.manager,f=function(n,e){l.setPositionFromValue(n,e,t,{getLeftEdge:i,getRightEdge:u,getTopEdge:a,getBottomEdge:c,getSpectrum:r})},d=function(n,e){s.value.set(e);var r=o(n);return f(n,r),t.onChange(n,r,e),ut.some(!0)},m=function(n){var e=t.mouseIsDown.get();t.mouseIsDown.set(!1),e&&fd(n,t,"thumb").each(function(e){var o=s.value.get();t.onChoose(n,e,o)})},g=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,o(n))},p=function(n,e){e.stop(),t.onDragEnd(n,o(n)),m(n)};return{uid:t.uid,dom:t.dom,components:n,behaviours:Cf(t.sliderBehaviours,[zg.config({mode:"special",focusIn:function(n){return fd(n,t,"spectrum").map(zg.focusIn).map(tt)}}),wf.config({store:{mode:"manual",getValue:function(){return s.value.get()}}}),Uc.config({channels:((e={})[of()]={onReceive:m},e)})]),events:Vr([zr(Ww(),function(t,n){d(t,n.event.value)}),Xr(function(n){var e=s.getInitialValue();s.value.set(e);var i=o(n);f(n,i);var u=r(n);t.onInit(n,i,u,s.value.get())}),zr(zo(),g),zr(Lo(),p),zr(Uo(),g),zr(Xo(),p)]),apis:{resetToMin:function(n){l.setToMin(n,t)},resetToMax:function(n){l.setToMax(n,t)},changeValue:d,refresh:f},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),pk=[Sf("formBehaviours",[wf])],hk=function(t){return"<alloy.field."+t+">"},vk=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:Cf(t.formBehaviours,[wf.config({store:{mode:"manual",getValue:function(n){var e=gd(n,t);return mn(e,function(t,n){return t().bind(function(t){var e,o;return e=Ad.getCurrent(t),o=new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+Ei(t.element)),e.fold(function(){return Xt.error(o)},Xt.value)}).map(wf.getValue)})},setValue:function(n,e){dn(e,function(e,o){fd(n,t,o).each(function(t){Ad.getCurrent(t).each(function(t){wf.setValue(t,e)})})})}}})]),apis:{getField:function(n,e){return fd(n,t,e).bind(Ad.getCurrent)}}}},bk={getField:Yi(function(t,n,e){return t.getField(n,e)}),sketch:function(t){var n,e=(n=[],{field:function(t,e){return n.push(t),ud("form",hk(t),e)},record:function(){return n}}),o=t(e),r=e.record(),i=_t(r,function(t){return $f({name:t,pname:hk(t)})});return wd("form",pk,i,vk,o)}},yk=Mi("valid-input"),xk=Mi("invalid-input"),wk=Mi("validating-input"),Sk="colorcustom.rgb.",kk=function(t,n,e,o){var r=function(e,o,r,i,u){var a,c,s=t(Sk+"range"),l=[ux.parts.label({dom:{tag:"label",innerHtml:r,attributes:{"aria-label":i}}}),ux.parts.field({data:u,factory:Tx,inputAttributes:et({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:Pc([(a=o,c=e,qx.config({invalidClass:n("invalid"),notify:{onValidate:function(t){Ar(t,wk,{type:a})},onValid:function(t){Ar(t,yk,{type:a,value:wf.getValue(t)})},onInvalid:function(t){Ar(t,xk,{type:a,value:wf.getValue(t)})}},validator:{validate:function(n){var e=wf.getValue(n),o=c(e)?Xt.value(!0):Xt.error(t("aria.input.invalid"));return Hx(o)},validateOnLoad:!1}})),sx.config({})]),onSetValue:function(t){qx.isInvalid(t)&&qx.run(t).get(Y)}})],f="hex"!==o?[ux.parts["aria-descriptor"]({text:s})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:l.concat(f)}},i=function(t,n){var e=n.red,o=n.green,r=n.blue;wf.setValue(t,{red:e,green:o,blue:r})},u=Yp({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),a=function(t,n){u.getOpt(t).each(function(t){Du(t.element,"background-color","#"+n.value)})};return Od({factory:function(){var c={red:Ke(ut.some(255)),green:Ke(ut.some(255)),blue:Ke(ut.some(255)),hex:Ke(ut.some("ffffff"))},s=function(t){return c[t].get()},l=function(t,n){c[t].set(n)},f=function(t){var n=t.red,e=t.green,o=t.blue;l("red",ut.some(n)),l("green",ut.some(e)),l("blue",ut.some(o))},d=function(t,n){var e=n.event;"hex"!==e.type?l(e.type,ut.none()):o(t)},m=function(t,n,e){var o=parseInt(e,10);l(n,ut.some(o)),s("red").bind(function(t){return s("green").bind(function(n){return s("blue").map(function(e){return Gb(t,n,e,1)})})}).each(function(n){var e,o,r=(e=t,o=zb(n),bk.getField(e,"hex").each(function(t){Jg.isFocused(t)||wf.setValue(e,{hex:o.value})}),o);a(t,r)})},g=function(t,n){var o=n.event;"hex"===o.type?function(t,n){e(t);var o=Fb(n);l("hex",ut.some(n));var r=qb(o);i(t,r),f(r),Ar(t,Aw,{hex:o}),a(t,o)}(t,o.value):m(t,o.type,o.value)},p=function(n){return{label:t(Sk+n+".label"),description:t(Sk+n+".description")}},h=p("red"),v=p("green"),b=p("blue"),y=p("hex");return On(bk.sketch(function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",ux.sketch(r(Xb,"red",h.label,h.description,255))),e.field("green",ux.sketch(r(Xb,"green",v.label,v.description,255))),e.field("blue",ux.sketch(r(Xb,"blue",b.label,b.description,255))),e.field("hex",ux.sketch(r(Vb,"hex",y.label,y.description,"ffffff"))),u.asSpec()],formBehaviours:Pc([qx.config({invalidClass:n("form-invalid")}),Gg("rgb-form-events",[zr(yk,g),zr(xk,d),zr(wk,d)])])}}),{apis:{updateHex:function(t,n){var e,o;wf.setValue(t,{hex:n.value}),e=t,o=qb(n),i(e,o),f(o),a(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},Ck=function(t,n){var e=gk.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),o=gk.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(t,n){var e,o,r=t.width,i=t.height,u=t.getContext("2d");null!==u&&(u.fillStyle=n,u.fillRect(0,0,r,i),(e=u.createLinearGradient(0,0,r,0)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(1,"rgba(255,255,255,0)"),u.fillStyle=e,u.fillRect(0,0,r,i),(o=u.createLinearGradient(0,0,0,i)).addColorStop(0,"rgba(0,0,0,0)"),o.addColorStop(1,"rgba(0,0,0,1)"),u.fillStyle=o,u.fillRect(0,0,r,i))};return Od({factory:function(){var t=K({x:0,y:0}),i=Pc([Ad.config({find:ut.some}),Jg.config({})]);return gk.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:t},rounded:!1,components:[e,o],onChange:function(t,n,e){Ar(t,Fw,{value:e})},onInit:function(t,n,e){r(e.element.dom,Jb($b))},sliderBehaviours:i})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(t,n,e){var o,i;o=e,i=n.components()[0].element.dom,r(i,Jb(o))}},extraApis:{}})},Ok=function(t,n){return Od({name:"ColourPicker",configFields:[_e("dom"),Ne("onValidHex",Y),Ne("onInvalidHex",Y)],factory:function(e){var o,r,i,u,a,c=kk(t,n,e.onValidHex,e.onInvalidHex),s=Ck(0,n),l={paletteRgba:Ke($b)},f=Yp(s.sketch({})),d=Yp(c.sketch({})),m=function(t,n){f.getOpt(t).each(function(t){var e=qb(n);l.paletteRgba.set(e),s.setRgba(t,e)})},g=function(t,n){d.getOpt(t).each(function(t){c.updateHex(t,n)})},p=function(t,n,e){Tt(e,function(e){e(t,n)})};return{uid:e.uid,dom:e.dom,components:[f.asSpec(),(i=n,u=gk.parts.spectrum({dom:{tag:"div",classes:[i("hue-slider-spectrum")],attributes:{role:"presentation"}}}),a=gk.parts.thumb({dom:{tag:"div",classes:[i("hue-slider-thumb")],attributes:{role:"presentation"}}}),gk.sketch({dom:{tag:"div",classes:[i("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:K({y:0})},components:[u,a],sliderBehaviours:Pc([Jg.config({})]),onChange:function(t,n,e){Ar(t,Mw,{value:e})}})),d.asSpec()],behaviours:Pc([Gg("colour-picker-events",[zr(Fw,(r=[g],function(t,n){var e,o,i,u,a,c,s,f,d,m=n.event.value,g=(u=i=0,a=(e=l.paletteRgba.get()).red/255,c=e.green/255,s=e.blue/255,(f=Math.min(a,Math.min(c,s)))===(d=Math.max(a,Math.max(c,s)))?Dw(0,0,100*(u=f)):(i=60*((i=a===f?3:s===f?1:5)-(a===f?c-s:s===f?a-c:s-a)/(d-f)),o=(d-f)/d,u=d,Dw(Math.round(i),Math.round(100*o),Math.round(100*u)))),h=Dw(g.hue,m.x,100-m.y),v=Yb(h),b=zb(v);p(t,b,r)})),zr(Mw,(o=[m,g],function(t,n){var e,r,i,u=(e=n.event.value.y,r=Dw((100-e)/100*360,100,100),i=Yb(r),zb(i));p(t,u,o)}))]),Ad.config({find:function(t){return d.getOpt(t)}}),zg.config({mode:"acyclic"})])}}})},_k=function(){return Ad.config({find:ut.some})},Tk=function(t){return Ad.config({find:t.getOpt})},Ek=function(t){return Ad.config({find:function(n){return li(n.element,t).bind(function(t){return n.getSystem().getByDom(t).toOptional()})}})},Bk={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},Dk=function(t){return Bk[t]},Ak=tinymce.util.Tools.resolve("tinymce.Resource"),Mk=Jn([Ne("preprocess",J),Ne("postprocess",J)]),Fk=function(t,n,e){return wf.config(On({store:{mode:"manual",getValue:n,setValue:e}},t.map(function(t){return{store:{initialValue:t}}}).getOr({})))},Ik=function(t,n,e){return Fk(t,function(t){return n(t.element)},function(t,n){return e(t.element,n)})},Rk=function(t,n){var e=me("RepresentingConfigs.memento processors",Mk,n);return wf.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=wf.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);wf.setValue(i,r)}}})},Vk=Fk,Pk=function(t){return Ik(t,yi,xi)},Hk=function(t){return wf.config({store:{mode:"memory",initialValue:t}})},zk=function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){Tt(t,function(t){t(n,e)})}},r=function(t,n){var e;Rv.isDisabled(t)||(e=n.event.raw,u(t,e.dataTransfer.files))},i=function(t,n){var e=n.event.raw.target;u(t,e.files)},u=function(n,e){var o,r;wf.setValue(n,(o=e,r=new RegExp("("+".jpg,.jpeg,.png,.gif".split(/\s*,\s*/).join("|")+")$","i"),Bt(jt(o),function(t){return r.test(t.name)}))),Ar(n,gx,{name:t.name})},a=Yp({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:Pc([Gg("input-file-events",[Wr(tr()),Wr(fr())])])}),c=t.label.map(function(t){return mx(t,n)}),s=ux.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:Pc([Hk([]),_k(),Rv.config({}),cp.config({toggleClass:"dragenter",toggleOnExecute:!1}),Gg("dropzone-events",[zr("dragenter",o([e,cp.toggle])),zr("dragleave",o([e,cp.toggle])),zr("dragover",e),zr("drop",o([e,r])),zr(Zo(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},Xp.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element.dom.click()},buttonBehaviours:Pc([sx.config({}),fb(n.isReadOnly),sb()])})]}]}}}});return lx(c,s,["tox-form__group--stretched"],[])},Nk=Mi("alloy-fake-before-tabstop"),Lk=Mi("alloy-fake-after-tabstop"),jk=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:Pc([Jg.config({ignore:!0}),sx.config({})])}},Uk=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[jk([Nk]),t,jk([Lk])],behaviours:Pc([Ek(1)])}},Wk=function(t,n){Ar(t,Jo(),{raw:{which:9,shiftKey:n}})},Gk=function(t,n){var e=n.element;gu(e,Nk)?Wk(t,!0):gu(e,Lk)&&Wk(t,!1)},Xk=function(t){return jy(t,["."+Nk,"."+Lk].join(","),Z)},Yk=!(_o().browser.isIE()||_o().browser.isEdge()),qk=function(t,n){var e,o,r=Yk&&t.sandboxed,i=et(et({},t.label.map(function(t){return{title:t}}).getOr({})),r?{sandbox:"allow-scripts allow-same-origin"}:{}),u=(e=r,o=Ke(""),{getValue:function(){return o.get()},setValue:function(t,n){var r;e?Si(t.element,"srcdoc",n):(Si(t.element,"src","javascript:''"),(r=t.element.dom.contentWindow.document).open(),r.write(n),r.close()),o.set(n)}}),a=t.label.map(function(t){return mx(t,n)}),c=ux.parts.field({factory:{sketch:function(t){return Uk({uid:t.uid,dom:{tag:"iframe",attributes:i},behaviours:Pc([sx.config({}),Jg.config({}),Vk(ut.none(),u.getValue,u.setValue)])})}}});return lx(a,c,["tox-form__group--stretched"],[])},Kk=window.Promise?window.Promise:(tw=function(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],w(t,p(v,this),p(b,this))},nw=window,ew=tw.immediateFn||"function"==typeof nw.setImmediate&&nw.setImmediate||function(t){setTimeout(t,1)},ow=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},tw.prototype["catch"]=function(t){return this.then(null,t)},tw.prototype.then=function(t,n){var e=this;return new tw(function(o,r){h.call(e,new x(t,n,o,r))})},tw.all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var e=Array.prototype.slice.call(1===t.length&&ow(t[0])?t[0]:t);return new tw(function(t,n){if(0===e.length)return t([]);for(var o=e.length,r=0;r<e.length;r++)!function i(r,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,function(t){i(r,t)},n)}e[r]=u,0==--o&&t(e)}catch(U){n(U)}}(r,e[r])})},tw.resolve=function(t){return t&&"object"==typeof t&&t.constructor===tw?t:new tw(function(n){n(t)})},tw.reject=function(t){return new tw(function(n,e){e(t)})},tw.race=function(t){return new tw(function(n,e){for(var o=0,r=t;o<r.length;o++)r[o].then(n,e)})},tw),Jk=_,$k=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],Qk=(rw=[-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1],function(t){return A(t,rw)}),Zk=F(function(t,n){return D(t,[1,0,0,0,n=E(255*n,-255,255),0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])}),tC=F(function(t,n){var e;return n=E(n,-1,1),D(t,[(e=(n*=100)<0?127+n/100*127:127*(e=0==(e=n%1)?$k[n]:$k[Math.floor(n)]*(1-e)+$k[Math.floor(n)+1]*e)+127)/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])}),nC=(iw=[0,-1,0,-1,5,-1,0,-1,0],function(t){return M(t,iw)}),eC=(uw=function(t,n){return 255*Math.pow(t/255,1-n)},aw=function(t,n,e){for(var o=f(t),r=new Array(256),i=0;i<r.length;i++)r[i]=uw(i,e);var u=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(o.getImageData(0,0,t.width,t.height),r);return o.putImageData(u,0,0),T(t,n)},function(t,n){return t.toCanvas().then(function(e){return aw(e,t.getType(),n)})}),oC=function(t){return Qk(t)},rC=function(t){return nC(t)},iC=function(t,n){return eC(t,n)},uC=function(t,n,e,o){return A(t,(r=e,i=o,D(B(),[E(n,0,2),0,0,0,0,0,r=E(r,0,2),0,0,0,0,0,i=E(i,0,2),0,0,0,0,0,1,0,0,0,0,0,1])));var r,i},aC=function(t,n){return Zk(t,n)},cC=function(t,n){return tC(t,n)},sC=V,lC=P,fC=function(t,n,e){return r=n,i=e,(o=t).toCanvas().then(function(t){return I(t,r,i).then(function(t){return T(t,o.getType())})});var o,r,i},dC=R,mC=function(t,n){return et({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},n)},gC=function(t,n){return mC(Kp(t,n),{})},pC=function(t,n){return mC(Kp(t,n),{behaviours:Pc([Wg.config({})])})},hC=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:Pc([Wg.config({})])}},vC=Mi("toolbar.button.execute"),bC=((cw={})[sr()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],cw),yC=Mi("update-menu-text"),xC=Mi("update-menu-icon"),wC=function(n,o,r){var i=Ke(Y),u=n.text.map(function(t){return Yp(hC(t,o,r.providers))}),a=n.icon.map(function(t){return Yp(pC(t,r.providers.icons))}),c=function(t,n){var e=wf.getValue(t);return Jg.focus(e),Ar(e,"keydown",{raw:n.event.raw}),Cw.close(e),ut.some(!0)},s=n.role.fold(function(){return{}},function(t){return{role:t}}),l=n.tooltip.fold(function(){return{}},function(t){var n=r.providers.translate(t);return{title:n,"aria-label":n}});return Yp(Cw.sketch(et(et(et({},n.uid?{uid:n.uid}:{}),s),{dom:{tag:"button",classes:[o,o+"--select"].concat(_t(n.classes,function(t){return o+"--"+t})),attributes:et({},l)},components:bb([a.map(function(t){return t.asSpec()}),u.map(function(t){return t.asSpec()}),ut.some({dom:{tag:"div",classes:[o+"__select-chevron"],innerHtml:Kp("chevron-down",r.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:Pc(e(n.dropdownBehaviours,[fb(function(){return n.disabled||r.providers.isReadOnly()}),sb(),Ow.config({}),Wg.config({}),Gg("dropdown-events",[pb(n,i),hb(n,i)]),Gg("menubutton-update-display-text",[zr(yC,function(t,n){u.bind(function(n){return n.getOpt(t)}).each(function(t){Wg.set(t,[Yu(r.providers.translate(n.event.text))])})}),zr(xC,function(t,n){a.bind(function(n){return n.getOpt(t)}).each(function(t){Wg.set(t,[pC(n.event.icon,r.providers.icons)])})})])])),eventOrder:On(bC,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:Pc([zg.config({mode:"special",onLeft:c,onRight:c})]),lazySink:r.getSink,toggleClass:o+"--active",parts:{menu:Kh(0,n.columns,n.presets)},fetch:function(e){return Px(t(n.fetch,e))}}))).asSpec()},SC=function(t){return"separator"===t.type},kC={type:"separator"},CC=function(t,n){var e=At(t,function(t,e){return st(e)?""===e?t:"|"===e?0<t.length&&!SC(t[t.length-1])?t.concat([kC]):t:xn(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])},[]);return 0<e.length&&SC(e[e.length-1])&&e.pop(),e},OC=function(t,n){return xn(t,"getSubmenuItems")?(o=n,r=(e=t).getSubmenuItems(),i=_C(r,o),{item:e,menus:On(i.menus,Vn(e.value,i.items)),expansions:On(i.expansions,Vn(e.value,e.value))}):{item:t,menus:{},expansions:{}};var e,o,r,i},_C=function(t,n){var e=CC(st(t)?t.split(" "):t,n);return Dt(e,function(t,e){var o=function(t){if(SC(t))return t;var n=yn(t,"value").getOrThunk(function(){return Mi("generated-menu-item")});return On({value:n},t)}(e),r=OC(o,n);return{menus:On(t.menus,r.menus),items:[r.item].concat(t.items),expansions:On(t.expansions,r.expansions)}},{menus:{},expansions:{},items:[]})},TC=function(t,n,e,o){var r=Mi("primary-menu"),i=_C(t,e.shared.providers.menuItems());if(0===i.items.length)return ut.none();var u=Ry(r,i.items,n,e,o),a=mn(i.menus,function(t,o){return Ry(o,t,n,e,!1)}),c=On(a,Vn(r,u));return ut.from(Mp.tieredData(r,c,i.expansions))},EC=function(t){return{isDisabled:function(){return Rv.isDisabled(t)},setDisabled:function(n){return Rv.set(t,n)},setActive:function(n){var e=t.element;n?(fu(e,"tox-tbtn--enabled"),Si(e,"aria-pressed",!0)):(mu(e,"tox-tbtn--enabled"),_i(e,"aria-pressed"))},isActive:function(){return gu(t.element,"tox-tbtn--enabled")}}},BC=function(t,n,e,o){return wC({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch(function(t){o(TC(t,Vh.CLOSE_ON_EXECUTE,e,!1))})},onSetup:t.onSetup,getApi:EC,columns:1,presets:"normal",classes:[],dropdownBehaviours:[sx.config({})]},n,e.shared)},DC=function(t,n,e){return function(o){o(_t(t,function(t){var o,r,i=t.text.fold(function(){return{}},function(t){return{text:t}});return et(et({type:t.type,active:!1},i),{onAction:function(t){var o=!t.isActive();t.setActive(o),r.storage.set(o),e.shared.getSink().each(function(t){n().getOpt(t).each(function(t){Gc(t.element),Ar(t,vx,{name:r.name,value:r.storage.get()})})})},onSetup:(o=r=t,function(t){t.setActive(o.storage.get())})})}))}},AC=function(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold(function(){return{}},function(t){return{action:t}}),a=et({buttonBehaviours:Pc([fb(function(){return t.disabled||i.isReadOnly()}),sb(),sx.config({}),Gg("button press",[Hr("click"),Hr("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=On(a,{dom:o});return On(c,{components:r})},MC=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map(function(t){return{"aria-label":e.translate(t),title:e.translate(t)}}).getOr({})},i=t.icon.map(function(t){return gC(t,e.icons)}),u=bb([i]);return AC(t,n,o,r,u,e)},FC=function(t,n,e,o){void 0===o&&(o=[]);var r=MC(t,ut.some(n),e,o);return Xp.sketch(r)},IC=function(t,n,o,r,i){void 0===r&&(r=[]),void 0===i&&(i=[]);var u=o.translate(t.text),a=t.icon?t.icon.map(function(t){return gC(t,o.icons)}):ut.none(),c=a.isSome()?bb([a]):[],s=a.isSome()?{}:{innerHtml:u},l=e(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],a.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],i),f=et(et({tag:"button",classes:l},s),{attributes:{title:u}});return AC(t,n,r,f,c,o)},RC=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=IC(t,ut.some(n),e,o,r);return Xp.sketch(i)},VC=function(t,n){return function(e){"custom"===n?Ar(e,vx,{name:t,value:{}}):"submit"===n?Dr(e,bx):"cancel"===n?Dr(e,hx):console.error("Unknown button type: ",n)}},PC=function(t,n,e){if("menu"===n){var o=t,r=et(et({},t),{onSetup:function(n){return n.setDisabled(t.disabled),Y},fetch:DC(o.items,function(){return i},e)}),i=Yp(BC(r,"tox-tbtn",e,ut.none()));return i.asSpec()}if("custom"===(c=n)||"cancel"===c||"submit"===c){var u=VC(t.name,n),a=et(et({},t),{borderless:!1});return RC(a,u,e.shared.providers,[])}var c;console.error("Unknown footer button type: ",n)},HC=function(t,n){var e,o,r=VC(t.name,"custom");return e=ut.none(),o=ux.parts.field(et({factory:Xp},IC(t,ut.some(r),n,[Hk(""),_k()]))),lx(e,o,[],[])},zC=K([Ne("field1Name","field1"),Ne("field2Name","field2"),qa("onLockedChange"),Wa(["lockClass"]),Ne("locked",!1),Of("coupledFieldBehaviours",[Ad,wf])]),NC=function(t,n){return $f({factory:ux,name:t,overrides:function(t){return{fieldBehaviours:Pc([Gg("coupled-input-behaviour",[zr(Qo(),function(e){fd(e,t,n).bind(Ad.getCurrent).each(function(n){fd(e,t,"lock").each(function(o){cp.isOn(o)&&t.onLockedChange(e,n,o)})})})])])}}})},LC=K([NC("field1","field2"),NC("field2","field1"),$f({factory:Xp,schema:[_e("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:Pc([cp.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),jC=_d({name:"FormCoupledInputs",configFields:zC(),partFields:LC(),factory:function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:_f(t.coupledFieldBehaviours,[Ad.config({find:ut.some}),wf.config({store:{mode:"manual",getValue:function(n){var e=hd(n,t,["field1","field2"]),o={};return o[t.field1Name]=wf.getValue(e.field1()),o[t.field2Name]=wf.getValue(e.field2()),o},setValue:function(n,e){var o=hd(n,t,["field1","field2"]);wn(e,t.field1Name)&&wf.setValue(o.field1(),e[t.field1Name]),wn(e,t.field2Name)&&wf.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return fd(n,t,"field1")},getField2:function(n){return fd(n,t,"field2")},getLock:function(n){return fd(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),UC=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null===n)return Xt.error(t);var e=parseFloat(n[1]),o=n[2];return Xt.value({value:e,unit:o})},WC=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,"in":1},o=function(t){return Object.prototype.hasOwnProperty.call(e,t)};return t.unit===n?ut.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?ut.some(t.value):ut.some(t.value/e[t.unit]*e[n]):ut.none()},GC=function(){return ut.none()},XC=function(t,n){var e,o,r,i=UC(t).toOptional();return o=UC(n).toOptional(),r=function(t,n){return WC(t,n.unit).map(function(t){return n.value/t}).map(function(t){return e=t,o=n.unit,function(t){return WC(t,o).map(function(t){return{value:t*e,unit:o}})};var e,o}).getOr(GC)},((e=i).isSome()&&o.isSome()?ut.some(r(e.getOrDie(),o.getOrDie())):ut.none()).getOr(GC)},YC=function(t,n){var e=GC,o=Mi("ratio-event"),r=jC.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:Kp("lock",n.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:Kp("unlock",n.icons)}}],buttonBehaviours:Pc([Rv.config({disabled:function(){return t.disabled||n.isReadOnly()}}),sb(),sx.config({})])}),i=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},u=function(e){return ux.parts.field({factory:Tx,inputClasses:["tox-textfield"],inputBehaviours:Pc([Rv.config({disabled:function(){return t.disabled||n.isReadOnly()}}),sb(),sx.config({}),Gg("size-input-events",[zr(qo(),function(t){Ar(t,o,{isField1:e})}),zr(Zo(),function(n){Ar(n,gx,{name:t.name})})])]),selectOnFocus:!1})},a=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},c=jC.parts.field1(i([ux.parts.label(a("Width")),u(!0)])),s=jC.parts.field2(i([ux.parts.label(a("Height")),u(!1)]));return jC.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n){UC(wf.getValue(t)).each(function(t){e(t).each(function(t){var e,o,r,i;wf.setValue(n,(r={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,"in":4,"%":4},-1!==(i=(e=t).value.toFixed((o=e.unit)in r?r[o]:1)).indexOf(".")&&(i=i.replace(/\.?0*$/,"")),i+e.unit))})})},coupledFieldBehaviours:Pc([Rv.config({disabled:function(){return t.disabled||n.isReadOnly()},onDisabled:function(t){jC.getField1(t).bind(ux.getField).each(Rv.disable),jC.getField2(t).bind(ux.getField).each(Rv.disable),jC.getLock(t).each(Rv.disable)},onEnabled:function(t){jC.getField1(t).bind(ux.getField).each(Rv.enable),jC.getField2(t).bind(ux.getField).each(Rv.enable),jC.getLock(t).each(Rv.enable)}}),sb(),Gg("size-input-events2",[zr(o,function(t,n){var o=n.event.isField1,r=o?jC.getField1(t):jC.getField2(t),i=o?jC.getField2(t):jC.getField1(t),u=r.map(wf.getValue).getOr(""),a=i.map(wf.getValue).getOr("");e=XC(u,a)})])])})},qC={undo:K(Mi("undo")),redo:K(Mi("redo")),zoom:K(Mi("zoom")),back:K(Mi("back")),apply:K(Mi("apply")),swap:K(Mi("swap")),transform:K(Mi("transform")),tempTransform:K(Mi("temp-transform")),transformApply:K(Mi("transform-apply"))},KC=K("save-state"),JC=K("disable"),$C=K("enable"),QC={formActionEvent:vx,saveState:KC,disable:JC,enable:$C},ZC=function(t,n){var e=function(t,e,o,r){return Yp(RC({name:t,text:t,disabled:o,primary:r,icon:ut.none(),borderless:!1},e,n))},o=function(t,e,o,r){return Yp(FC({name:t,icon:ut.some(t),tooltip:ut.some(e),disabled:r,primary:!1,borderless:!1},o,n))},r=function(t,n){t.map(function(t){var e=t.get(n);e.hasConfigured(Rv)&&Rv.disable(e)})},i=function(t,n){t.map(function(t){var e=t.get(n);e.hasConfigured(Rv)&&Rv.enable(e)})},u={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},a=Y,c=function(t,n,e){Ar(t,n,e)},s=function(t){return Dr(t,QC.disable())},l=function(t){return Dr(t,QC.enable())},f=function(t,n){s(t),c(t,qC.transform(),{transform:n}),l(t)},d=function(t){return function(){Q.getOpt(t).each(function(t){Wg.set(t,[J])})}},m=function(t,n){s(t),c(t,qC.transformApply(),{transform:n,swap:d(t)}),l(t)},g=function(){return e("Back",function(t){return c(t,qC.back(),{swap:d(t)})},!1,!1)},p=function(){return Yp({dom:{tag:"div",classes:["tox-spacer"]},behaviours:Pc([Rv.config({})])})},h=function(){return e("Apply",function(t){return c(t,qC.apply(),{swap:d(t)})},!0,!0)},v=[g(),p(),e("Apply",function(n){m(n,function(n){var e=t.getRect();return lC(n,e.x,e.y,e.w,e.h)}),t.hideCrop()},!1,!0)],b=ex.sketch({dom:u,components:v.map(function(t){return t.asSpec()}),containerBehaviours:Pc([Gg("image-tools-crop-buttons-events",[zr(QC.disable(),function(t){r(v,t)}),zr(QC.enable(),function(t){i(v,t)})])])}),y=Yp(YC({name:"size",label:ut.none(),constrain:!0,disabled:!1},n)),x=[g(),p(),y,p(),e("Apply",function(t){y.getOpt(t).each(function(n){var e,o,r=wf.getValue(n),i=parseInt(r.width,10),u=parseInt(r.height,10),a=(e=i,o=u,function(t){return fC(t,e,o)});m(t,a)})},!1,!0)],w=ex.sketch({dom:u,components:x.map(function(t){return t.asSpec()}),containerBehaviours:Pc([Gg("image-tools-resize-buttons-events",[zr(QC.disable(),function(t){r(x,t)}),zr(QC.enable(),function(t){i(x,t)})])])}),S=function(t,n){return function(e){return t(e,n)}},k=S(sC,"h"),C=S(sC,"v"),O=S(dC,-90),_=S(dC,90),T=function(t,n){var e,o;o=n,s(e=t),c(e,qC.tempTransform(),{transform:o}),l(e)},E=[g(),p(),o("flip-horizontally","Flip horizontally",function(t){T(t,k)},!1),o("flip-vertically","Flip vertically",function(t){T(t,C)},!1),o("rotate-left","Rotate counterclockwise",function(t){T(t,O)},!1),o("rotate-right","Rotate clockwise",function(t){T(t,_)},!1),p(),h()],B=ex.sketch({dom:u,components:E.map(function(t){return t.asSpec()}),containerBehaviours:Pc([Gg("image-tools-fliprotate-buttons-events",[zr(QC.disable(),function(t){r(E,t)}),zr(QC.enable(),function(t){i(E,t)})])])}),D=function(t,e,o,r,i){var u=gk.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}),a=gk.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),c=gk.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Yp(gk.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:i,getInitialValue:K({x:r})},components:[u,a,c],sliderBehaviours:Pc([Jg.config({})]),onChoose:e}))},A=function(t,n,e,o,r){return[g(),(i=n,D(t,function(t,n,e){var o=S(i,e.x/100);f(t,o)},e,o,r)),h()];var i},M=function(t,n,e,o,a){var c=A(t,n,e,o,a);return ex.sketch({dom:u,components:c.map(function(t){return t.asSpec()}),
containerBehaviours:Pc([Gg("image-tools-filter-panel-buttons-events",[zr(QC.disable(),function(t){r(c,t)}),zr(QC.enable(),function(t){i(c,t)})])])})},F=[g(),p(),h()],I=ex.sketch({dom:u,components:F.map(function(t){return t.asSpec()})}),R=M("Brightness",aC,-100,0,100),V=M("Contrast",cC,-100,0,100),P=M("Gamma",iC,-100,0,100),H=function(t){return D(t,function(t){var n=z.getOpt(t),e=L.getOpt(t),o=N.getOpt(t);n.each(function(n){e.each(function(e){o.each(function(o){var r,i,u,a=wf.getValue(n).x/100,c=wf.getValue(o).x/100,s=wf.getValue(e).x/100,l=(r=a,i=c,u=s,function(t){return uC(t,r,i,u)});f(t,l)})})})},0,100,200)},z=H("R"),N=H("G"),L=H("B"),j=[g(),z,N,L,h()],U=ex.sketch({dom:u,components:j.map(function(t){return t.asSpec()})}),W=function(t,n,e){return function(o){c(o,qC.swap(),{transform:n,swap:function(){Q.getOpt(o).each(function(n){Wg.set(n,[t]),e(n)})}})}},G=ut.some(rC),X=ut.some(oC),q=[o("crop","Crop",W(b,ut.none(),function(){t.showCrop()}),!1),o("resize","Resize",W(w,ut.none(),function(n){y.getOpt(n).each(function(n){var e=t.getMeasurements(),o=e.width,r=e.height;wf.setValue(n,{width:o,height:r})})}),!1),o("orientation","Orientation",W(B,ut.none(),a),!1),o("brightness","Brightness",W(R,ut.none(),a),!1),o("sharpen","Sharpen",W(I,G,a),!1),o("contrast","Contrast",W(V,ut.none(),a),!1),o("color-levels","Color levels",W(U,ut.none(),a),!1),o("gamma","Gamma",W(P,ut.none(),a),!1),o("invert","Invert",W(I,X,a),!1)],J=ex.sketch({dom:u,components:q.map(function(t){return t.asSpec()})}),$=ex.sketch({dom:{tag:"div"},components:[J],containerBehaviours:Pc([Wg.config({})])}),Q=Yp($);return{memContainer:Q,getApplyButton:function(t){return Q.getOpt(t).map(function(t){var n=t.components()[0];return n.components()[n.components().length-1]})}}},tO=tinymce.util.Tools.resolve("tinymce.geom.Rect"),nO=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),eO=tinymce.util.Tools.resolve("tinymce.util.Observable"),oO=tinymce.util.Tools.resolve("tinymce.util.Tools"),rO=tinymce.util.Tools.resolve("tinymce.util.VK"),iO=0,uO=function(t,n,e,o,r){function i(n,o,r,i){var u,a=o.x,s=o.y,l=o.w,f=o.h;a+=r*n.deltaX,s+=i*n.deltaY,(l+=r*n.deltaW)<20&&(l=20),(f+=i*n.deltaH)<20&&(f=20),u=t=tO.clamp({x:a,y:s,w:l,h:f},e,"move"===n.name),u=p(e,u),h.fire("updateRect",{rect:u}),c(u)}function u(t){function e(t,n){n.h<0&&(n.h=0),n.w<0&&(n.w=0),nO("#"+f+"-"+t,o).css({left:n.x,top:n.y,width:n.w,height:n.h})}oO.each(d,function(n){nO("#"+f+"-"+n.name,o).css({left:t.w*n.xMul+t.x,top:t.h*n.yMul+t.y})}),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)}function a(n){u(t=n)}function c(t){a(g(e,t))}var s,l="tox-",f="tox-crid-"+iO++,d=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],m=["top","right","bottom","left"],g=function(t,n){return{x:n.x+t.x,y:n.y+t.y,w:n.w,h:n.h}},p=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}};nO('<div id="'+f+'" class="'+l+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),oO.each(m,function(t){nO("#"+f,o).append('<div id="'+f+"-"+t+'"class="'+l+'croprect-block" style="display: none" data-mce-bogus="all">')}),oO.each(d,function(t){nO("#"+f,o).append('<div id="'+f+"-"+t.name+'" class="'+l+"croprect-handle "+l+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')}),s=oO.map(d,function(n){var e;return new z(f,{document:o.ownerDocument,handle:f+"-"+n.name,start:function(){e=t},drag:function(t){i(n,e,t.deltaX,t.deltaY)}})}),u(t),nO(o).on("focusin focusout",function(t){nO(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")}),nO(o).on("keydown",function(n){function e(t,n,e,r,u){t.stopPropagation(),t.preventDefault(),i(o,e,r,u)}var o;switch(oO.each(d,function(t){if(n.target.id===f+"-"+t.name)return o=t,!1}),n.keyCode){case rO.LEFT:e(n,0,t,-10,0);break;case rO.RIGHT:e(n,0,t,10,0);break;case rO.UP:e(n,0,t,0,-10);break;case rO.DOWN:e(n,0,t,0,10);break;case rO.ENTER:case rO.SPACEBAR:n.preventDefault(),r()}});var h=oO.extend({toggleVisibility:function(t){var n=oO.map(d,function(t){return"#"+f+"-"+t.name}).concat(oO.map(m,function(t){return"#"+f+"-"+t})).join(",");t?nO(n,o).show():nO(n,o).hide()},setClampRect:function(n){e=n,u(t)},setRect:a,getInnerRect:function(){return p(e,t)},setInnerRect:c,setViewPortRect:function(e){n=e,u(t)},destroy:function(){oO.each(s,function(t){t.destroy()}),s=[]}},eO);return h},aO=function(t){var n=Yp({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=Ke(1),o=Ke(ut.none()),r=Ke({x:0,y:0,w:1,h:1}),i=Ke({x:0,y:0,w:1,h:1}),u=function(t,i){s.getOpt(t).each(function(t){var u=e.get(),a=aa(t.element),c=Zu(t.element),s=i.dom.naturalWidth*u,l=i.dom.naturalHeight*u,f=Math.max(0,a/2-s/2),d=Math.max(0,c/2-l/2),m={left:f.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:l.toString()+"px",position:"absolute"};Au(i,m),n.getOpt(t).each(function(t){Au(t.element,m)}),o.get().each(function(t){var n=r.get();t.setRect({x:n.x*u+f,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:f,y:d,w:s,h:l}),t.setViewPortRect({x:0,y:0,w:a,h:c})})})},a=function(t,n){var o,a=$e.fromTag("img");return Si(a,"src",n),o=a.dom,new sh(function(t){var n=function(){o.removeEventListener("load",n),t(o)};o.complete?t(o):o.addEventListener("load",n)}).then(function(){return s.getOpt(t).map(function(t){var n=qu({element:a});Wg.replaceAt(t,1,ut.some(n));var o=i.get(),c={x:0,y:0,w:a.dom.naturalWidth,h:a.dom.naturalHeight};i.set(c);var l,f,d=tO.inflate(c,-20,-20);return r.set(d),o.w===c.w&&o.h===c.h||(l=t,f=a,s.getOpt(l).each(function(t){var n=aa(t.element),o=Zu(t.element),r=f.dom.naturalWidth,i=f.dom.naturalHeight,u=Math.min(n/r,o/i);1<=u?e.set(1):e.set(u)})),u(t,a),a})})},c=ex.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:Pc([Gg("image-panel-crop-events",[Xr(function(t){s.getOpt(t).each(function(t){var n=t.element.dom,i=uO({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,function(){});i.toggleVisibility(!1),i.on("updateRect",function(t){var n=t.rect,o=e.get(),i={x:Math.round(n.x/o),y:Math.round(n.y/o),w:Math.round(n.w/o),h:Math.round(n.h/o)};r.set(i)}),o.set(ut.some(i))})})])])}],containerBehaviours:Pc([Wg.config({}),Gg("image-panel-events",[Xr(function(n){a(n,t)})])])}),s=Yp(c);return{memContainer:s,updateSrc:a,zoom:function(t,n){var o=e.get(),r=0<n?Math.min(2,o+.1):Math.max(.1,o-.1);e.set(r),s.getOpt(t).each(function(t){var n=t.components()[1].element;u(t,n)})},showCrop:function(){o.get().each(function(t){t.toggleVisibility(!0)})},hideCrop:function(){o.get().each(function(t){t.toggleVisibility(!1)})},getRect:function(){return r.get()},getMeasurements:function(){var t=i.get();return{width:t.w,height:t.h}}}},cO=function(t,n,e,o,r){return FC({name:t,icon:ut.some(n),disabled:e,tooltip:ut.some(t),primary:!1,borderless:!1},o,r)},sO=function(t,n){n?Rv.enable(t):Rv.disable(t)},lO=function(t){var n=Ke(t),e=Ke(ut.none()),o=N();o.add(t);var r=function(t){n.set(t)},i=function(t){return{blob:t,url:URL.createObjectURL(t)}},u=function(t){URL.revokeObjectURL(t.url)},a=function(){e.get().each(u),e.set(ut.none())},c=function(t){var n,e=i(t);return r(e),n=o.add(e).removed,oO.each(n,u),e.url};return{getBlobState:function(){return n.get()},setBlobState:r,addBlobState:c,getTempState:function(){return e.get().fold(function(){return n.get()},function(t){return t})},updateTempState:function(t){var n=i(t);return a(),e.set(ut.some(n)),n.url},addTempState:function(t){var n=i(t);return e.set(ut.some(n)),n.url},applyTempState:function(t){return e.get().fold(function(){},function(n){c(n.blob),t()})},destroyTempState:a,undo:function(){var t=o.undo();return r(t),t.url},redo:function(){var t=o.redo();return r(t),t.url},getHistoryStates:function(){return{undoEnabled:o.canUndo(),redoEnabled:o.canRedo()}}}},fO=function(t,n){var e,o,r,i=lO(t.currentState),u=function(t){var n=i.getHistoryStates();p.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Ar(t,QC.formActionEvent,{name:QC.saveState(),value:n.undoEnabled})},a=function(t){return t.toBlob()},c=function(t){Ar(t,QC.formActionEvent,{name:QC.disable(),value:{}})},s=function(t){h.getApplyButton(t).each(function(t){Rv.enable(t)}),Ar(t,QC.formActionEvent,{name:QC.enable(),value:{}})},l=function(t,n){return c(t),g.updateSrc(t,n)},f=function(t,n,e,o,r){return c(t),Jk(n).then(e).then(a).then(o).then(function(n){return l(t,n).then(function(n){return u(t),r(),s(t),n})})["catch"](function(n){return console.log(n),s(t),n})},d=function(t,n,e){var o=i.getBlobState().blob;f(t,o,n,function(t){return i.updateTempState(t)},e)},m=function(t){var n=i.getBlobState().url;return i.destroyTempState(),u(t),n},g=aO(t.currentState.url),p=(o=Yp(cO("Undo","undo",!0,function(t){Ar(t,qC.undo(),{direction:1})},e=n)),r=Yp(cO("Redo","redo",!0,function(t){Ar(t,qC.redo(),{direction:1})},e)),{container:ex.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[o.asSpec(),r.asSpec(),cO("Zoom in","zoom-in",!1,function(t){Ar(t,qC.zoom(),{direction:1})},e),cO("Zoom out","zoom-out",!1,function(t){Ar(t,qC.zoom(),{direction:-1})},e)]}),updateButtonUndoStates:function(t,n,e){o.getOpt(t).each(function(t){sO(t,n)}),r.getOpt(t).each(function(t){sO(t,e)})}}),h=ZC(g,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[h.memContainer.asSpec(),g.memContainer.asSpec(),p.container],behaviours:Pc([wf.config({store:{mode:"manual",getValue:function(){return i.getBlobState()}}}),Gg("image-tools-events",[zr(qC.undo(),function(t){var n=i.undo();l(t,n).then(function(){s(t),u(t)})}),zr(qC.redo(),function(t){var n=i.redo();l(t,n).then(function(){s(t),u(t)})}),zr(qC.zoom(),function(t,n){var e=n.event.direction;g.zoom(t,e)}),zr(qC.back(),function(t,n){var e,o;o=m(e=t),l(e,o).then(function(){s(e)}),(0,n.event.swap)(),g.hideCrop()}),zr(qC.apply(),function(t,n){i.applyTempState(function(){m(t),(0,n.event.swap)()})}),zr(qC.transform(),function(t,n){return d(t,n.event.transform,Y)}),zr(qC.tempTransform(),function(t,n){return e=t,o=n.event.transform,r=i.getTempState().blob,void f(e,r,o,function(t){return i.addTempState(t)},Y);var e,o,r}),zr(qC.transformApply(),function(t,n){return e=t,o=n.event.transform,r=n.event.swap,u=i.getBlobState().blob,void f(e,u,o,function(t){var n=i.addBlobState(t);return m(e),n},r);var e,o,r,u}),zr(qC.swap(),function(t,n){var e;e=t,p.updateButtonUndoStates(e,!1,!1);var o=n.event.transform,r=n.event.swap;o.fold(function(){r()},function(n){d(t,n,r)})})]),_k()])}},dO=function(t){return!xn(t,"items")},mO="data-value",gO=function(t,n,e,o){return _t(e,function(e){return dO(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){wf.setValue(t,e.value),Ar(t,gx,{name:n}),Jg.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return gO(t,n,e.items,o)}}})},pO=function(t,n){return Ut(t,function(t){return dO(t)?(e=t,t.value===n?ut.some(e):ut.none()):pO(t.items,n);var e})},hO=Od({name:"HtmlSelect",configFields:[_e("options"),Sf("selectBehaviours",[Jg,wf]),Ne("selectClasses",[]),Ne("selectAttributes",{}),Ie("data")],factory:function(t){var n=_t(t.options,function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}}),e=t.data.map(function(t){return Vn("initialValue",t)}).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:n,behaviours:Cf(t.selectBehaviours,[Jg.config({}),wf.config({store:et({mode:"manual",getValue:function(t){return zu(t.element)},setValue:function(n,e){Mt(t.options,function(t){return t.value===e}).isSome()&&Nu(n.element,e)}},e)})])}}}),vO=function(t,n){var e=t.label.map(function(t){return mx(t,n)}),o=[Rv.config({disabled:function(){return t.disabled||n.isReadOnly()}}),sb(),zg.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return Dr(t,bx),ut.some(!0)}}),Gg("textfield-change",[zr(Qo(),function(n){Ar(n,gx,{name:t.name})}),zr(ar(),function(n){Ar(n,gx,{name:t.name})})]),sx.config({})],r=t.validation.map(function(t){return qx.config({getRoot:function(t){return ui(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=wf.getValue(n),o=t.validator(e);return Hx(!0===o?Xt.value(e):Xt.error(o))},validateOnLoad:t.validateOnLoad}})}).toArray(),i=t.placeholder.fold(K({}),function(t){return{placeholder:n.translate(t)}}),u=t.inputMode.fold(K({}),function(t){return{inputmode:t}}),a=et(et({},i),u),c=ux.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:a,inputClasses:[t.classname],inputBehaviours:Pc(It([o,r])),selectOnFocus:!1,factory:Tx}),s=(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),l=[Rv.config({disabled:function(){return t.disabled||n.isReadOnly()},onDisabled:function(t){ux.getField(t).each(Rv.disable)},onEnabled:function(t){ux.getField(t).each(Rv.enable)}}),sb()];return lx(e,c,s,l)},bO=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return Vr([zr(t.event,e),Yr(function(){return n.cancel()})].concat(t.cancelEvent.map(function(t){return[zr(t,function(){return n.cancel()})]}).getOr([])))}}),yO=function(){var t=Ke(null);return Ki({readState:function(){return{timer:null!==t.get()?"set":"unset"}},setTimer:function(n){t.set(n)},cancel:function(){var n=t.get();null!==n&&n.cancel()}})},xO=Object.freeze({__proto__:null,throttle:yO,init:function(t){return t.stream.streams.state(t)}}),wO=[Te("stream",he("mode",{throttle:[_e("delay"),Ne("stopEvent",!0),Ja("streams",{setup:function(t,n){var e=t.stream,o=Qp(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:yO})]})),Ne("event","input"),Ie("cancelEvent"),qa("onStream")],SO=zc({fields:wO,name:"streaming",active:bO,state:xO}),kO=function(t,n,e){var o=wf.getValue(e);wf.setValue(n,o),OO(n)},CO=function(t,n){var e=t.element,o=zu(e),r=e.dom;"number"!==ki(e,"type")&&n(r,o)},OO=function(t){CO(t,function(t,n){return t.setSelectionRange(n.length,n.length)})},_O=function(t,n,e){if(t.selectsOver){var o=wf.getValue(n),r=t.getDisplayText(o),i=wf.getValue(e);return 0===t.getDisplayText(i).indexOf(r)?ut.some(function(){var t,o;kO(0,n,e),t=n,o=r.length,CO(t,function(t,n){return t.setSelectionRange(o,n.length)})}):ut.none()}return ut.none()},TO=K("alloy.typeahead.itemexecute"),EO=K([Ie("lazySink"),_e("fetch"),Ne("minChars",5),Ne("responseTime",1e3),Xa("onOpen"),Ne("getHotspot",ut.some),Ne("getAnchorOverrides",K({})),Ne("layouts",ut.none()),Ne("eventOrder",{}),Ye("model",{},[Ne("getDisplayText",function(t){return t.meta!==undefined&&t.meta.text!==undefined?t.meta.text:t.value}),Ne("selectsOver",!0),Ne("populateFromBrowse",!0)]),Xa("onSetValue"),Ya("onExecute"),Xa("onItemExecute"),Ne("inputClasses",[]),Ne("inputAttributes",{}),Ne("inputStyles",{}),Ne("matchWidth",!0),Ne("useMinWidth",!1),Ne("dismissOnBlur",!0),Wa(["openClass"]),Ie("initialData"),Sf("typeaheadBehaviours",[Jg,wf,SO,zg,cp,$x]),qe("previewing",function(){return Ke(!0)})].concat(Cx()).concat(ww())),BO=K([Qf({schema:[Ua()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each(function(o){_O(t.model,o,e).fold(function(){return jd.dehighlight(n,e)},function(t){return t()})}):n.getSystem().getByUid(t.uid).each(function(n){t.model.populateFromBrowse&&kO(t.model,n,e)}),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map(function(t){return Ar(t,TO(),{item:e}),!0})},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each(function(n){t.model.populateFromBrowse&&kO(t.model,n,e)})}}}})]),DO=_d({name:"Typeahead",configFields:EO(),partFields:BO(),factory:function(t,n,e,o){var r=function(n,e,r){t.previewing.set(!1);var i=$x.getCoupled(n,"sandbox");tf.isOpen(i)?Ad.getCurrent(i).each(function(t){jd.getHighlighted(t).fold(function(){r(t)},function(){Rr(i,t.element,"keydown",e)})}):mw(t,u(n),n,i,o,function(t){Ad.getCurrent(t).each(r)},Dx.HighlightFirst).get(Y)},i=Ox(t),u=function(t){return function(n){return n.map(function(n){var e=bn(n.menus),o=Rt(e,function(t){return Bt(t.items,function(t){return"item"===t.type})});return wf.getState(t).update(_t(o,function(t){return t.data})),n})}},a=[Jg.config({}),wf.config({onSetValue:t.onSetValue,store:et({mode:"dataset",getDataKey:function(t){return zu(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){Nu(n.element,t.model.getDisplayText(e))}},t.initialData.map(function(t){return Vn("initialValue",t)}).getOr({}))}),SO.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n){var e,r=$x.getCoupled(n,"sandbox");Jg.isFocused(n)&&zu(n.element).length>=t.minChars&&(e=Ad.getCurrent(r).bind(function(t){return jd.getHighlighted(t).map(wf.getValue)}),t.previewing.set(!0),mw(t,u(n),n,r,o,function(){Ad.getCurrent(r).each(function(n){e.fold(function(){t.model.selectsOver&&jd.highlightFirst(n)},function(t){jd.highlightBy(n,function(n){return wf.getValue(n).value===t.value}),jd.getHighlighted(n).orThunk(function(){return jd.highlightFirst(n),ut.none()})})})},Dx.HighlightFirst).get(Y))},cancelEvent:gr()}),zg.config({mode:"special",onDown:function(t,n){return r(t,n,jd.highlightFirst),ut.some(!0)},onEscape:function(t){var n=$x.getCoupled(t,"sandbox");return tf.isOpen(n)?(tf.close(n),ut.some(!0)):ut.none()},onUp:function(t,n){return r(t,n,jd.highlightLast),ut.some(!0)},onEnter:function(n){var e=$x.getCoupled(n,"sandbox"),o=tf.isOpen(e);if(o&&!t.previewing.get())return Ad.getCurrent(e).bind(function(t){return jd.getHighlighted(t)}).map(function(t){return Ar(n,TO(),{item:t}),!0});var r=wf.getValue(n);return Dr(n,gr()),t.onExecute(e,n,r),o&&tf.close(e),ut.some(!0)}}),cp.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),$x.config({others:{sandbox:function(n){return yw(t,n,{onOpen:function(){return cp.on(n)},onClose:function(){return cp.off(n)}})}}}),Gg("typeaheadevents",[Kr(function(n){var e=Y;pw(t,u(n),n,o,e,Dx.HighlightFirst).get(Y)}),zr(TO(),function(n,e){var o=$x.getCoupled(n,"sandbox");kO(t.model,n,e.event.item),Dr(n,gr()),t.onItemExecute(n,o,e.event.item,wf.getValue(n)),tf.close(o),OO(n)})].concat(t.dismissOnBlur?[zr(ur(),function(t){var n=$x.getCoupled(t,"sandbox");Yc(n.element).isNone()&&tf.close(n)})]:[]))];return{uid:t.uid,dom:_x(On(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:et(et({},i),Cf(t.typeaheadBehaviours,a)),eventOrder:t.eventOrder}}}),AO=function(t){return et(et({},t),{toCached:function(){return AO(t.toCached())},bindFuture:function(n){return AO(t.bind(function(t){return t.fold(function(t){return Hx(Xt.error(t))},function(t){return n(t)})}))},bindResult:function(n){return AO(t.map(function(t){return t.bind(n)}))},mapResult:function(n){return AO(t.map(function(t){return t.map(n)}))},mapError:function(n){return AO(t.map(function(t){return t.mapError(n)}))},foldResult:function(n,e){return t.map(function(t){return t.fold(n,e)})},withTimeout:function(n,e){return AO(Px(function(o){var r=!1,i=setTimeout(function(){r=!0,o(Xt.error(e()))},n);t.get(function(t){r||(clearTimeout(i),o(t))})}))}})},MO=function(t){return AO(Px(t))},FO={type:"separator"},IO=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:function(){}}},RO=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:undefined},onAction:function(){}}},VO=function(t,n){return o=t,e=Bt(n,function(t){return t.type===o}),_t(e,IO);var e,o},PO=function(t,n){var e=t.toLowerCase();return Bt(n,function(t){var n=t.meta!==undefined&&t.meta.text!==undefined?t.meta.text:t.text;return io(n.toLowerCase(),e)||io(t.value.toLowerCase(),e)})},HO=function(t,n,e){var o=wf.getValue(n),r=o.meta.text!==undefined?o.meta.text:o.value;return e.getLinkInformation().fold(function(){return[]},function(n){var o,i,u,a,c=PO(r,(o=e.getHistory(t),_t(o,function(t){return RO(t,t)})));return"file"===t?(i=[c,PO(r,VO("header",n.targets)),PO(r,It([(a=n,ut.from(a.anchorTop).map(function(t){return RO("<top>",t)}).toArray()),VO("anchor",n.targets),(u=n,ut.from(u.anchorBottom).map(function(t){return RO("<bottom>",t)}).toArray())]))],At(i,function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(FO,n)},[])):c})},zO=Mi("aria-invalid"),NO=function(t,n,e){var o,r,i,u,a,c=n.shared.providers,s=function(n){var o=wf.getValue(n);e.addToHistory(o.value,t.filetype)},l=ux.parts.field({factory:DO,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":zO,type:"url"},minChars:0,responseTime:0,fetch:function(o){var r=HO(t.filetype,o,e),i=TC(r,Vh.BUBBLE_TO_SANDBOX,n,!1);return Hx(i)},getHotspot:function(t){return h.getOpt(t)},onSetValue:function(t){t.hasConfigured(qx)&&qx.run(t).get(Y)},typeaheadBehaviours:Pc(It([e.getValidationHandler().map(function(n){return qx.config({getRoot:function(t){return ui(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){d.getOpt(t).each(function(t){Si(t.element,"title",c.translate(n))})}},validator:{validate:function(e){var o=wf.getValue(e);return MO(function(e){n({type:t.filetype,url:o.value},function(t){var n,o;"invalid"===t.status?(n=Xt.error(t.message),e(n)):(o=Xt.value(t.message),e(o))})})},validateOnLoad:!1}})}).toArray(),[Rv.config({disabled:function(){return t.disabled||c.isReadOnly()}}),sx.config({}),Gg("urlinput-events",It(["file"===t.filetype?[zr(Qo(),function(n){Ar(n,gx,{name:t.name})})]:[],[zr(Zo(),function(n){Ar(n,gx,{name:t.name}),s(n)}),zr(ar(),function(n){Ar(n,gx,{name:t.name}),s(n)})]]))]])),eventOrder:((o={})[Qo()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:Kh(0,0,"normal")},onExecute:function(t,n){Ar(n,bx,{})},onItemExecute:function(n){s(n),Ar(n,gx,{name:t.name})}}),f=t.label.map(function(t){return mx(t,c)}),d=Yp((r="invalid",i=ut.some(zO),void 0===(u="warning")&&(u=r),void 0===a&&(a=r),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+r],innerHtml:Kp(u,c.icons),attributes:et({title:c.translate(a),"aria-live":"polite"},i.fold(function(){return{}},function(t){return{id:t}}))}})),m=Yp({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[d.asSpec()]}),g=e.getUrlPicker(t.filetype),p=Mi("browser.url.event"),h=Yp({dom:{tag:"div",classes:["tox-control-wrap"]},components:[l,m.asSpec()],behaviours:Pc([Rv.config({disabled:function(){return t.disabled||c.isReadOnly()}})])}),v=Yp(RC({name:t.name,icon:ut.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},function(t){return Dr(t,p)},c,[],["tox-browse-url"]));return ux.sketch({dom:dx([]),components:f.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:It([[h.asSpec()],g.map(function(){return v.asSpec()}).toArray()])}]),fieldBehaviours:Pc([Rv.config({disabled:function(){return t.disabled||c.isReadOnly()},onDisabled:function(t){ux.getField(t).each(Rv.disable),v.getOpt(t).each(Rv.disable)},onEnabled:function(t){ux.getField(t).each(Rv.enable),v.getOpt(t).each(Rv.enable)}}),sb(),Gg("url-input-events",[zr(p,function(n){Ad.getCurrent(n).each(function(e){var o=wf.getValue(e),r=et({fieldname:t.name},o);g.each(function(o){o(r).get(function(o){wf.setValue(e,o),Ar(n,gx,{name:t.name})})})})})])])})},LO=function(t){return function(n,e,o){return yn(e,"name").fold(function(){return t(e,o)},function(r){return n.field(r,t(e,o))})}},jO={bar:LO(function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:_t(e.items,o.interpreter)};var e,o}),collection:LO(function(t,n){return kx(t,n.shared.providers)}),alertbanner:LO(function(t,n){return e=t,o=n.shared.providers,ex.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+e.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Xp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Kp(e.icon,o.icons),attributes:{title:o.translate(e.iconTooltip)}},action:function(t){Ar(t,vx,{name:"alert-banner",value:e.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:o.translate(e.text)}}]});var e,o}),input:LO(function(t,n){return e=t,o=n.shared.providers,vO({name:e.name,multiline:!1,label:e.label,inputMode:e.inputMode,placeholder:e.placeholder,flex:!1,disabled:e.disabled,classname:"tox-textfield",validation:ut.none(),maximized:e.maximized},o);var e,o}),textarea:LO(function(t,n){return e=t,o=n.shared.providers,vO({name:e.name,multiline:!0,label:e.label,inputMode:ut.none(),placeholder:e.placeholder,flex:!0,disabled:e.disabled,classname:"tox-textarea",validation:ut.none(),maximized:e.maximized},o);var e,o}),label:LO(function(t,n){return e=t,r={dom:{tag:"label",innerHtml:(o=n.shared).providers.translate(e.label),classes:["tox-label"]}},i=_t(e.items,o.interpreter),{dom:{tag:"div",classes:["tox-form__group"]},components:[r].concat(i),behaviours:Pc([_k(),Wg.config({}),Pk(ut.none()),zg.config({mode:"acyclic"})])};var e,o,r,i}),iframe:(sw=function(t,n){return qk(t,n.shared.providers)},function(t,n,e){var o=On(n,{source:"dynamic"});return LO(sw)(t,o,e)}),button:LO(function(t,n){return HC(t,n.shared.providers)}),checkbox:LO(function(t,n){return e=t,o=n.shared.providers,r=wf.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),i=function(t){return t.element.dom.click(),ut.some(!0)},u=ux.parts.field({factory:{sketch:J},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:Pc([_k(),Rv.config({disabled:function(){return e.disabled||o.isReadOnly()}}),sx.config({}),Jg.config({}),r,zg.config({mode:"special",onEnter:i,onSpace:i,stopSpaceKeyup:!0}),Gg("checkbox-events",[zr(Zo(),function(t){Ar(t,gx,{name:e.name})})])])}),a=ux.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:o.translate(e.label)},behaviours:Pc([Ow.config({})])}),s=Yp({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[(c=function(t){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:Kp("checked"===t?"selected":"unselected",o.icons)}}})("checked"),c("unchecked")]}),ux.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[u,s.asSpec(),a],fieldBehaviours:Pc([Rv.config({disabled:function(){return e.disabled||o.isReadOnly()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){ux.getField(t).each(Rv.disable)},onEnabled:function(t){ux.getField(t).each(Rv.enable)}}),sb()])});var e,o,r,i,u,a,c,s}),colorinput:LO(function(t,n){return Bw(t,n.shared,n.colorinput)}),colorpicker:LO(function(){var t=Ok(Dk,function(t){return"tox-"+t}),n=Yp(t.sketch({dom:{tag:"div",classes:["tox-color-picker-container"],attributes:{role:"presentation"}},onValidHex:function(t){Ar(t,vx,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Ar(t,vx,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[n.asSpec()],behaviours:Pc([wf.config({store:{mode:"manual",getValue:function(t){var e=n.get(t);return Ad.getCurrent(e).bind(function(t){return wf.getValue(t).hex}).map(function(t){return"#"+t}).getOr("")},setValue:function(t,e){var o=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(e),r=n.get(t);Ad.getCurrent(r).fold(function(){console.log("Can not find form")},function(t){wf.setValue(t,{hex:ut.from(o[1]).getOr("")}),bk.getField(t,"hex").each(function(t){Dr(t,Qo())})})}}}),_k()])}}),dropzone:LO(function(t,n){return zk(t,n.shared.providers)}),grid:LO(function(t,n){return e=t,o=n.shared,{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+e.columns+"col"]},components:_t(e.items,o.interpreter)};var e,o}),listbox:LO(function(t,n){return e=t,r=(o=n).shared.providers,i=Nt(e.items).filter(dO),u=e.label.map(function(t){return mx(t,r)}),a={dom:{tag:"div",classes:["tox-listboxfield"]},components:[ux.parts.field({dom:{},factory:{sketch:function(t){return wC({uid:t.uid,text:i.map(function(t){return t.text}),icon:ut.none(),tooltip:e.label,role:ut.none(),fetch:function(t,n){var r=gO(t,e.name,e.items,wf.getValue(t));n(TC(r,Vh.CLOSE_ON_EXECUTE,o,!1))},onSetup:K(Y),getApi:K({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[sx.config({}),wf.config({store:{mode:"manual",initialValue:i.map(function(t){return t.value}).getOr(""),getValue:function(t){return ki(t.element,mO)},setValue:function(t,n){pO(e.items,n).each(function(n){Si(t.element,mO,n.value),Ar(t,yC,{text:n.text})})}}})]},"tox-listbox",o.shared)}}})]},ux.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:It([u.toArray(),[a]]),fieldBehaviours:Pc([Rv.config({disabled:K(e.disabled),onDisabled:function(t){ux.getField(t).each(Rv.disable)},onEnabled:function(t){ux.getField(t).each(Rv.enable)}})])});var e,o,r,i,u,a}),selectbox:LO(function(t,n){return e=t,o=n.shared.providers,r=_t(e.items,function(t){return{text:o.translate(t.text),value:t.value}}),i=e.label.map(function(t){return mx(t,o)}),u=ux.parts.field({dom:{},selectAttributes:{size:e.size},options:r,factory:hO,selectBehaviours:Pc([Rv.config({disabled:function(){return e.disabled||o.isReadOnly()}}),sx.config({}),Gg("selectbox-change",[zr(Zo(),function(t){Ar(t,gx,{name:e.name})})])])}),a=1<e.size?ut.none():ut.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:Kp("chevron-down",o.icons)}}),c={dom:{tag:"div",classes:["tox-selectfield"]},components:It([[u],a.toArray()])},ux.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:It([i.toArray(),[c]]),fieldBehaviours:Pc([Rv.config({disabled:function(){return e.disabled||o.isReadOnly()},onDisabled:function(t){ux.getField(t).each(Rv.disable)},onEnabled:function(t){ux.getField(t).each(Rv.enable)}}),sb()])});var e,o,r,i,u,a,c}),sizeinput:LO(function(t,n){return YC(t,n.shared.providers)}),urlinput:LO(function(t,n){return NO(t,n,n.urlinput)}),customeditor:LO(function(t){var n=Ke(ut.none()),e=Yp({dom:{tag:t.tag}}),o=Ke(ut.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:Pc([Gg("custom-editor-events",[Xr(function(r){e.getOpt(r).each(function(e){var r;r=t,(Object.prototype.hasOwnProperty.call(r,"init")?t.init(e.element.dom):Ak.load(t.scriptId,t.scriptUrl).then(function(n){return n(e.element.dom,t.settings)})).then(function(t){o.get().each(function(n){t.setValue(n)}),o.set(ut.none()),n.set(ut.some(t))})})})]),wf.config({store:{mode:"manual",getValue:function(){return n.get().fold(function(){return o.get().getOr("")},function(t){return t.getValue()})},setValue:function(t,e){n.get().fold(function(){o.set(ut.some(e))},function(t){return t.setValue(e)})}}}),_k()]),components:[e.asSpec()]}}),htmlpanel:LO(function(t){return"presentation"===t.presets?ex.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):ex.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:Pc([sx.config({}),Jg.config({})])})}),imagetools:LO(function(t,n){return fO(t,n.shared.providers)}),table:LO(function(t,n){return e=t,o=n.shared.providers,u=function(t){return{dom:{tag:"th",innerHtml:o.translate(t)}}},a=function(t){return{dom:{tag:"td",innerHtml:o.translate(t)}}},c=function(t){return{dom:{tag:"tr"},components:_t(t,a)}},{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(i=e.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:_t(i,u)}]}),(r=e.cells,{dom:{tag:"tbody"},components:_t(r,c)})],behaviours:Pc([sx.config({}),Jg.config({})])};var e,o,r,i,u,a,c}),panel:LO(function(t,n){return o=n,{dom:{tag:"div",classes:(e=t).classes},components:_t(e.items,o.shared.interpreter)};var e,o})},UO={field:function(t,n){return n}},WO=function(t,n,e){var o=On(e,{shared:{interpreter:function(n){return GO(t,n,o)}}});return GO(t,n,o)},GO=function(t,n,e){return yn(jO,n.type).fold(function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n
},function(o){return o(t,n,e)})},XO={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},YO=function(t,n,e){var o=hs(-12,12,XO),r={maxHeightFunction:fs()};return function(){return e()?{anchor:"node",root:Su(t()),node:ut.from(t()),bubble:o,layouts:{onRtl:function(){return[jp]},onLtr:function(){return[Lp]}},overrides:r}:{anchor:"hotspot",hotspot:n(),bubble:o,layouts:{onRtl:function(){return[hc]},onLtr:function(){return[vc]}},overrides:r}}},qO=function(t,n,e){return function(){return e()?{anchor:"node",root:Su(t()),node:ut.from(t()),layouts:{onRtl:function(){return[Up]},onLtr:function(){return[Up]}}}:{anchor:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[wc]},onLtr:function(){return[wc]}}}}},KO=function(t,n,e){var o,r,i,u=eb(t),a=function(){return $e.fromDom(t.getBody())},c=function(){return $e.fromDom(t.getContentAreaContainer())},s=function(){return u||!e()};return{inlineDialog:YO(c,n,s),banner:qO(c,n,s),cursor:(r=t,function(){return{anchor:"selection",root:i(),getSelection:function(){var t=r.selection.getRng();return ut.some(Ds.range($e.fromDom(t.startContainer),t.startOffset,$e.fromDom(t.endContainer),t.endOffset))}}}),node:(o=i=a,function(t){return{anchor:"node",root:o(),node:t}})}},JO=function(t){return{colorPicker:function(t,n){py(r)(t,n)},hasCustomColors:function(){return ry(o)},getColors:function(){return iy(e)},getColorCols:(n=e=o=r=t,function(){return cy(n)})};var n,e,o,r},$O=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],QO=function(t){return At(t,function(t,n){if(xn(n,"items")){var e=QO(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(xn(n,"inline")||xn(n,"block")||xn(n,"selector")){var o="custom-"+n.title.toLowerCase();return{customFormats:t.customFormats.concat([{name:o,format:n}]),formats:t.formats.concat([{title:n.title,format:o,icon:n.icon}])}}return et(et({},t),{formats:t.formats.concat(n)})},{customFormats:[],formats:[]})},ZO=function(t){return n=t,ut.from(n.getParam("style_formats")).filter(ft).map(function(n){var e,o,r,i=(e=t,o=QO(n),r=function(t){Tt(t,function(t){e.formatter.has(t.name)||e.formatter.register(t.name,t.format)})},e.formatter?r(o.customFormats):e.on("init",function(){r(o.customFormats)}),o.formats);return t.getParam("style_formats_merge",!1,"boolean")?$O.concat(i):i}).getOr($O);var n},t_=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return On(t,o)},n_=function(t,n,e,o){var r=function(n){return _t(n,function(n){var i,u,a,c,s=ln(n);if(wn(n,"items")){var l=r(n.items);return On(On(n,{type:"submenu"}),{getStyleItems:function(){return l}})}return wn(n,"format")?t_(n,e,o):1===s.length&&St(s,"title")?On(n,{type:"separator"}):(a={type:"formatter",format:u=Mi((i=n).title),isSelected:e(u),getStylePreview:o(u)},c=On(i,a),t.formatter.register(u,c),c)})};return r(n)},e_=oO.trim,o_=function(t){return function(n){if(n&&1===n.nodeType){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},r_=o_("true"),i_=o_("false"),u_=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},a_=function(t){return t.innerText||t.textContent},c_=function(t){return(n=t)&&"A"===n.nodeName&&(n.id||n.name)!==undefined&&l_(t);var n},s_=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},l_=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return r_(t)}return!1}(t)&&!i_(t)},f_=function(t){return s_(t)&&l_(t)},d_=function(t){var n,e,o=(n=t).id?n.id:Mi("h");return u_("header",a_(t),"#"+o,s_(e=t)?parseInt(e.nodeName.substr(1),10):0,function(){t.id=o})},m_=function(t){var n=t.id||t.name,e=a_(t);return u_("anchor",e||"#"+n,"#"+n,0,Y)},g_=function(t){var n,e;return n="h1,h2,h3,h4,h5,h6,a:not([href])",e=t,_t(Ys($e.fromDom(e),n),function(t){return t.dom})},p_=function(t){return 0<e_(t.title).length},h_=function(t){var n=g_(t);return Bt(_t(Bt(n,f_),d_).concat(_t(Bt(n,c_),m_)),p_)},v_="tinymce-url-history",b_=function(t){return st(t)&&/^https?/.test(t)},y_=function(t){return lt(t)&&vn(t,function(t){return!(ft(n=t)&&n.length<=5&&Vt(n,b_));var n}).isNone()},x_=function(){var t,n=Zb.getItem(v_);if(null===n)return{};try{t=JSON.parse(n)}catch(j){if(j instanceof SyntaxError)return console.log("Local storage "+v_+" was not valid JSON",j),{};throw j}return y_(t)?t:(console.log("Local storage "+v_+" was not valid format",t),{})},w_=function(t){var n=x_();return Object.prototype.hasOwnProperty.call(n,t)?n[t]:[]},S_=function(t,n){var e,o,r;b_(t)&&(e=x_(),o=Object.prototype.hasOwnProperty.call(e,n)?e[n]:[],r=Bt(o,function(n){return n!==t}),e[n]=[t].concat(r).slice(0,5),function(t){if(!y_(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));Zb.setItem(v_,JSON.stringify(t))}(e))},k_=function(t){return!!t},C_=function(t){return mn(oO.makeMap(t,/[, ]/),k_)},O_=function(t){return ut.from(t.getParam("file_picker_callback")).filter(pt)},__=function(t,n){var e,o,r,i,u=(e=t,o=ut.some(e.getParam("file_picker_types")).filter(k_),r=ut.some(e.getParam("file_browser_callback_types")).filter(k_),i=o.or(r).map(C_),O_(e).fold(function(){return!1},function(){return i.fold(function(){return!0},function(t){return 0<ln(t).length&&t})}));return dt(u)?u?O_(t):ut.none():u[n]?O_(t):ut.none()},T_=function(t){return ut.from(t).filter(st).getOrUndefined()},E_=function(t){return ut.from((e=(n=t).getParam("file_picker_validator_handler",undefined,"function"))===undefined?n.getParam("filepicker_validator_handler",undefined,"function"):e);var n,e},B_=function(t){return{getHistory:w_,addToHistory:S_,getLinkInformation:function(){return!1===(n=t).getParam("typeahead_urls")?ut.none():ut.some({targets:h_(n.getBody()),anchorTop:T_(n.getParam("anchor_top","#top")),anchorBottom:T_(n.getParam("anchor_bottom","#bottom"))});var n},getValidationHandler:function(){return E_(t)},getUrlPicker:function(n){return __(e=t,o=n).map(function(t){return function(n){return Px(function(r){var i=et({filetype:o,fieldname:n.fieldname},ut.from(n.meta).getOr({}));t.call(e,function(t,n){if(!st(t))throw new Error("Expected value to be string");if(n!==undefined&&!lt(n))throw new Error("Expected meta to be a object");r({value:t,meta:n})},n.value,i)})}});var e,o}}},D_=function(t,n,e){var o,r,i=Ke(!1),u={isPositionedAtTop:function(){return"top"===o.get()},getDockingMode:(o=Ke(tb(n)?"bottom":"top")).get,setDockingMode:o.set},a={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:wv.translate,isReadOnly:function(){return n.mode.isReadOnly()}},interpreter:function(t){return GO(UO,t,a)},anchors:KO(n,e,u.isPositionedAtTop),header:u,getSink:function(){return Xt.value(t)}},urlinput:B_(n),styleselect:function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return e!==undefined?ut.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):ut.none()}},o=function(t){var n=t.items;return n!==undefined&&0<n.length?Rt(n,o):[t.format]},r=Ke([]),i=Ke([]),u=Ke([]),a=Ke([]),c=Ke(!1);return t.on("PreInit",function(){var u=ZO(t),a=n_(t,u,n,e);r.set(a),i.set(Rt(a,o))}),t.on("addStyleModifications",function(r){var i=n_(t,r.items,n,e);u.set(i),c.set(r.replace),a.set(Rt(i,o))}),{getData:function(){var t=c.get()?[]:r.get(),n=u.get();return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)}}}(n),colorinput:JO(n),dialog:{isDraggableModal:(r=n,function(){return r.getParam("draggable_modal",!1,"boolean")})},isContextMenuOpen:function(){return i.get()},setContextMenuState:function(t){return i.set(t)}};return a},A_=K(function(t,n){var e,o,r;e=t,o=Math.floor(n),r=ua.max(e,o,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]),Du(e,"max-width",r+"px")}),M_="contexttoolbar-hide",F_=K([_e("dom"),Ne("shell",!0),Sf("toolbarBehaviours",[Wg])]),I_=K([Zf({name:"groups",overrides:function(){return{behaviours:Pc([Wg.config({})])}}})]),R_=_d({name:"Toolbar",configFields:F_(),partFields:I_(),factory:function(t,n){var e=function(n){return t.shell?ut.some(n):fd(n,t,"groups")},o=t.shell?{behaviours:[Wg.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:o.components,behaviours:Cf(t.toolbarBehaviours,o.behaviours),apis:{setGroups:function(t,n){e(t).fold(function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")},function(t){Wg.set(t,n)})}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),V_=function(t,n,e){return{within:t,extra:n,withinWidth:e}},P_=function(t,n,e){var o,r=(o=function(t,n){var o=e(t);return ut.some({element:t,start:n,finish:n+o,width:o})},At(t,function(t,n){return o(n,t.len).fold(K(t),function(n){return{len:n.finish,list:t.list.concat([n])}})},{len:0,list:[]}).list),i=Bt(r,function(t){return t.finish<=n}),u=Dt(i,function(t,n){return t+n.width},0);return{within:i,extra:r.slice(i.length),withinWidth:u}},H_=function(t){return _t(t,function(t){return t.element})},z_=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m=(0===(r=P_(n,t,e)).extra.length?ut.some(r):ut.none()).getOrThunk(function(){return P_(n,t-e(o),e)}),g=m.within,p=m.extra,h=m.withinWidth;return 1===p.length&&p[0].width<=e(o)?(l=p,f=h,d=H_(g.concat(l)),V_(d,[],f)):1<=p.length?(u=p,a=o,c=h,s=H_(g).concat([a]),V_(s,H_(u),c)):(i=h,V_(H_(g),[],i))},N_=function(t,n){var e=_t(n,function(t){return $u(t)});R_.setGroups(t,e)},L_=function(t,n,e){var o=dd(t,n,"primary"),r=$x.getCoupled(t,"overflowGroup");Du(o.element,"visibility","hidden");var i=n.builtGroups.get().concat([r]),u=Ut(i,function(t){return Yc(t.element).bind(function(n){return t.getSystem().getByDom(n).toOptional()})});e([]),N_(o,i);var a=aa(o.element),c=z_(a,n.builtGroups.get(),function(t){return aa(t.element)},r);0===c.extra.length?(Wg.remove(o,r),e([])):(N_(o,c.within),e(c.extra)),Pu(o.element,"visibility"),Hu(o.element),u.each(Jg.focus)},j_=K([Sf("splitToolbarBehaviours",[$x]),qe("builtGroups",function(){return Ke([])})]),U_=K([Wa(["overflowToggledClass"]),He("getOverflowBounds"),_e("lazySink"),qe("overflowGroups",function(){return Ke([])})].concat(j_())),W_=K([$f({factory:R_,schema:F_(),name:"primary"}),Qf({schema:F_(),name:"overflow"}),Qf({name:"overflow-button"}),Qf({name:"overflow-group"})]),G_=K([Wa(["toggledClass"]),_e("lazySink"),De("fetch"),He("getBounds"),ze("fireDismissalEventInstead",[Ne("event",Sr())]),Ss()]),X_=K([Qf({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:Pc([cp.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Qf({factory:R_,schema:F_(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:Pc([zg.config({mode:"cyclic",onEscape:function(n){return fd(n,t,"button").each(Jg.focus),ut.none()}})])}}})]),Y_=function(t,n){var e=$x.getCoupled(t,"toolbarSandbox");tf.isOpen(e)?tf.close(e):tf.open(e,n.toolbar())},q_=function(t,n,e,o){var r=e.getBounds.map(function(t){return t()}),i=e.lazySink(t).getOrDie();Ml.positionWithinBounds(i,{anchor:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:A_()}},n,r)},K_=function(t,n,e,o,r){R_.setGroups(n,r),q_(t,n,e,o),cp.on(t)},J_=_d({name:"FloatingToolbarButton",factory:function(t,n,e,o){return et(et({},Xp.sketch(et(et({},o.button()),{action:function(t){Y_(t,o)},buttonBehaviours:_f({dump:o.button().buttonBehaviours},[$x.config({others:{toolbarSandbox:function(n){return o=n,r=e,i=t,{dom:{tag:"div",attributes:{id:(u=Ba()).id}},behaviours:Pc([zg.config({mode:"special",onEscape:function(t){return tf.close(t),ut.some(!0)}}),tf.config({onOpen:function(t,n){i.fetch().get(function(t){K_(o,n,i,r.layouts,t),u.link(o.element),zg.focusIn(n)})},onClose:function(){cp.off(o),Jg.focus(o),u.unlink(o.element)},isPartOf:function(t,n,e){return Aa(n,e)||Aa(o,e)},getAttachPoint:function(){return i.lazySink(o).getOrDie()}}),Uc.config({channels:et(et({},uf(et({isExtraPart:Z},i.fireDismissalEventInstead.map(function(t){return{fireEventInstead:{event:t.event}}}).getOr({})))),cf({doReposition:function(){tf.getState($x.getCoupled(o,"toolbarSandbox")).each(function(t){q_(o,t,i,r.layouts)})}}))})])};var o,r,i,u}}})])}))),{apis:{setGroups:function(n,o){tf.getState($x.getCoupled(n,"toolbarSandbox")).each(function(r){K_(n,r,t,e.layouts,o)})},reposition:function(n){tf.getState($x.getCoupled(n,"toolbarSandbox")).each(function(o){q_(n,o,t,e.layouts)})},toggle:function(t){Y_(t,o)},getToolbar:function(t){return tf.getState($x.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return tf.isOpen($x.getCoupled(t,"toolbarSandbox"))}}})},configFields:G_(),partFields:X_(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),$_=K([_e("items"),Wa(["itemSelector"]),Sf("tgroupBehaviours",[zg])]),Q_=K([td({name:"items",unit:"item"})]),Z_=_d({name:"ToolbarGroup",configFields:$_(),partFields:Q_(),factory:function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:Cf(t.tgroupBehaviours,[zg.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),tT=function(t){return _t(t,function(t){return $u(t)})},nT=function(t,n,e){L_(t,e,function(o){e.overflowGroups.set(o),n.getOpt(t).each(function(t){J_.setGroups(t,tT(o))})})},eT=_d({name:"SplitFloatingToolbar",configFields:U_(),partFields:W_(),factory:function(t,n,e,o){var r=Yp(J_.sketch({fetch:function(){return Px(function(n){n(tT(t.overflowGroups.get()))})},layouts:{onLtr:function(){return[vc,hc]},onRtl:function(){return[hc,vc]},onBottomLtr:function(){return[yc,bc]},onBottomRtl:function(){return[bc,yc]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:t.uid,dom:t.dom,components:n,behaviours:Cf(t.splitToolbarBehaviours,[$x.config({others:{overflowGroup:function(){return Z_.sketch(et(et({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(_t(e,n.getSystem().build)),nT(n,r,t)},refresh:function(n){return nT(n,r,t)},toggle:function(t){r.getOpt(t).each(function(t){J_.toggle(t)})},isOpen:function(t){return r.getOpt(t).map(J_.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each(function(t){J_.reposition(t)})},getOverflow:function(t){return r.getOpt(t).bind(J_.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),oT=function(t,n){return n.getAnimationRoot.fold(function(){return t.element},function(n){return n(t)})},rT=function(t){return t.dimension.property},iT=function(t,n){return t.dimension.getDimension(n)},uT=function(t,n){var e=oT(t,n);hu(e,[n.shrinkingClass,n.growingClass])},aT=function(t,n){mu(t.element,n.openClass),fu(t.element,n.closedClass),Du(t.element,rT(n),"0px"),Hu(t.element)},cT=function(t,n){mu(t.element,n.closedClass),fu(t.element,n.openClass),Pu(t.element,rT(n))},sT=function(t,n,e){e.setCollapsed(),Du(t.element,rT(n),iT(n,t.element)),Hu(t.element),uT(t,n),aT(t,n),n.onStartShrink(t),n.onShrunk(t)},lT=function(t,n,e,o){var r=o.getOrThunk(function(){return iT(n,t.element)});e.setCollapsed(),Du(t.element,rT(n),r),Hu(t.element);var i=oT(t,n);mu(i,n.growingClass),fu(i,n.shrinkingClass),aT(t,n),n.onStartShrink(t)},fT=function(t,n,e){var o=iT(n,t.element);("0px"===o?sT:lT)(t,n,e,ut.some(o))},dT=function(t,n,e){var o=oT(t,n),r=gu(o,n.shrinkingClass),i=iT(n,t.element);cT(t,n);var u=iT(n,t.element);(r?function(){Du(t.element,rT(n),i),Hu(t.element)}:function(){aT(t,n)})(),mu(o,n.shrinkingClass),fu(o,n.growingClass),cT(t,n),Du(t.element,rT(n),u),e.setExpanded(),n.onStartGrow(t)},mT=function(t,n){var e=oT(t,n);return!0===gu(e,n.growingClass)},gT=function(t,n){var e=oT(t,n);return!0===gu(e,n.shrinkingClass)},pT=Object.freeze({__proto__:null,refresh:function(t,n,e){var o;e.isExpanded()&&(Pu(t.element,rT(n)),o=iT(n,t.element),Du(t.element,rT(n),o))},grow:function(t,n,e){e.isExpanded()||dT(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&fT(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&sT(t,n,e,ut.none())},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:mT,isShrinking:gT,isTransitioning:function(t,n){return!0===mT(t,n)||!0===gT(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?fT:dT)(t,n,e)},disableTransitions:uT}),hT=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.expanded;return $i(e?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:Vn(n.dimension.property,"0px")})},events:function(t,n){return Vr([Gr(nr(),function(e,o){o.event.raw.propertyName===t.dimension.property&&(uT(e,t),n.isExpanded()&&Pu(e.element,t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))})])}}),vT=[_e("closedClass"),_e("openClass"),_e("shrinkingClass"),_e("growingClass"),Ie("getAnimationRoot"),Xa("onShrunk"),Xa("onStartShrink"),Xa("onGrown"),Xa("onStartGrow"),Ne("expanded",!1),Te("dimension",he("property",{width:[Ja("property","width"),Ja("getDimension",function(t){return aa(t)+"px"})],height:[Ja("property","height"),Ja("getDimension",function(t){return Zu(t)+"px"})]}))],bT=zc({fields:vT,name:"sliding",active:hT,apis:pT,state:Object.freeze({__proto__:null,init:function(n){var e=Ke(n.expanded);return Ki({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:t(e.set,!1),setExpanded:t(e.set,!0),readState:function(){return"expanded: "+e.get()}})}})}),yT=K([Wa(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),Xa("onOpened"),Xa("onClosed")].concat(j_())),xT=K([$f({factory:R_,schema:F_(),name:"primary"}),$f({factory:R_,schema:F_(),name:"overflow",overrides:function(t){return{toolbarBehaviours:Pc([bT.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){fd(n,t,"overflow-button").each(function(t){cp.off(t),Jg.focus(t)}),t.onClosed(n)},onGrown:function(n){zg.focusIn(n),t.onOpened(n)},onStartGrow:function(n){fd(n,t,"overflow-button").each(cp.on)}}),zg.config({mode:"acyclic",onEscape:function(n){return fd(n,t,"overflow-button").each(Jg.focus),ut.some(!0)}})])}}}),Qf({name:"overflow-button",overrides:function(t){return{buttonBehaviours:Pc([cp.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Qf({name:"overflow-group"})]),wT=function(t,n){fd(t,n,"overflow-button").bind(function(){return fd(t,n,"overflow")}).each(function(e){ST(t,n),bT.toggleGrow(e)})},ST=function(t,n){fd(t,n,"overflow").each(function(e){L_(t,n,function(t){var n=_t(t,function(t){return $u(t)});R_.setGroups(e,n)}),fd(t,n,"overflow-button").each(function(t){bT.hasGrown(e)&&cp.on(t)}),bT.refresh(e)})},kT=_d({name:"SplitSlidingToolbar",configFields:yT(),partFields:xT(),factory:function(t,n,e,o){var r="alloy.toolbar.toggle";return{uid:t.uid,dom:t.dom,components:n,behaviours:Cf(t.splitToolbarBehaviours,[$x.config({others:{overflowGroup:function(t){return Z_.sketch(et(et({},o["overflow-group"]()),{items:[Xp.sketch(et(et({},o["overflow-button"]()),{action:function(){Dr(t,r)}}))]}))}}}),Gg("toolbar-toggle-events",[zr(r,function(n){wT(n,t)})])]),apis:{setGroups:function(n,e){var o;o=_t(e,n.getSystem().build),t.builtGroups.set(o),ST(n,t)},refresh:function(n){return ST(n,t)},toggle:function(n){return wT(n,t)},isOpen:function(n){return fd(n,t,"overflow").map(bT.hasGrown).getOr(!1)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),CT=K(Mi("toolbar-height-change")),OT=function(t){var n=t.title.fold(function(){return{}},function(t){return{attributes:{title:t}}});return{dom:et({tag:"div",classes:["tox-toolbar__group"]},n),components:[Z_.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:Pc([sx.config({}),Jg.config({})])}},_T=function(t){return Z_.sketch(OT(t))},TT=function(t,n){var e=Xr(function(n){var e=_t(t.initGroups,_T);R_.setGroups(n,e)});return Pc([mb(t.providers.isReadOnly),sb(),zg.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),Gg("toolbar-events",[e])])},ET=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":OT({title:ut.none(),items:[]}),"overflow-button":MC({name:"more",icon:ut.some("more-drawer"),disabled:!1,tooltip:ut.some("More..."),primary:!1,borderless:!1},ut.none(),t.providers)},splitToolbarBehaviours:TT(t,n)}},BT=function(t){var n=ET(t),e=eT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return eT.sketch(et(et({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,e=wa(n),o=ri(n),r=wa(o),i=Math.max(o.dom.scrollHeight,r.height);return ya(e.x+4,r.y,e.width-8,i)},parts:et(et({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},DT=function(t){var n=kT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=kT.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=ET(t);return kT.sketch(et(et({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([CT()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([CT()],{type:"closed"})}}))},AT=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return R_.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===Ih.scrolling?["tox-toolbar--scrolling"]:[])},components:[R_.parts.groups({})],toolbarBehaviours:TT(t,n)})},MT=Jn([Ee("type"),Te("items",Qn([ae([Ee("name"),Fe("items",xe)]),xe]))].concat(yh)),FT=[Pe("text"),Pe("tooltip"),Pe("icon"),De("fetch"),Xe("onSetup",function(){return Y})],IT=Jn(e([Ee("type")],FT)),RT=function(t){return fe("menubutton",IT,t)},VT=Jn([Ee("type"),Pe("tooltip"),Pe("icon"),Pe("text"),He("select"),De("fetch"),Xe("onSetup",function(){return Y}),We("presets","normal",["normal","color","listpreview"]),Ne("columns",1),De("onAction"),De("onItemAction")]),PT=Object.freeze({__proto__:null,events:function(t,n){var e=function(e,o){t.updateState.each(function(t){var r=t(e,o);n.set(r)}),t.renderComponents.each(function(t){var r=t(o,n.get()),i=_t(r,e.getSystem().build);Vl(e,i)})};return Vr([zr(cr(),function(n,o){var r,i=o;i.universal||(r=t.channel,St(i.channels,r)&&e(n,i.data))}),Xr(function(n){t.initialData.each(function(t){e(n,t)})})])}}),HT=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),zT=[_e("channel"),Ie("renderComponents"),Ie("updateState"),Ie("initialData")],NT=zc({fields:zT,name:"reflecting",active:PT,apis:HT,state:Object.freeze({__proto__:null,init:function(){var t=Ke(ut.none());return{readState:function(){return t.get().fold(function(){return"none"},function(t){return t})},get:function(){return t.get()},set:function(n){return t.set(n)},clear:function(){return t.set(ut.none())}}}})}),LT=K([_e("toggleClass"),_e("fetch"),qa("onExecute"),Ne("getHotspot",ut.some),Ne("getAnchorOverrides",K({})),Ss(),qa("onItemExecute"),Ie("lazySink"),_e("dom"),Xa("onOpen"),Sf("splitDropdownBehaviours",[$x,zg,Jg]),Ne("matchWidth",!1),Ne("useMinWidth",!1),Ne("eventOrder",{}),Ie("role")].concat(ww())),jT=$f({factory:Xp,schema:[_e("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:Pc([Jg.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(Mr)},buttonBehaviours:Pc([cp.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),UT=$f({factory:Xp,schema:[_e("dom")],name:"button",defaults:function(){return{buttonBehaviours:Pc([Jg.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(function(e){t.onExecute(e,n)})}}}}),WT=K([jT,UT,Zf({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[_e("text")],name:"aria-descriptor"}),Qf({schema:[Ua()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each(function(o){t.onItemExecute(o,n,e)})}}}}),Zx()]),GT=_d({name:"SplitDropdown",configFields:LT(),partFields:WT(),factory:function(t,n,e,o){var r,i=function(t){Ad.getCurrent(t).each(function(t){jd.highlightFirst(t),zg.focusIn(t)})},u=function(n){pw(t,function(t){return t},n,o,i,Dx.HighlightFirst).get(Y)},a=function(n){var e=dd(n,t,"button");return Mr(e),ut.some(!0)},c=et(et({},Vr([Xr(function(n){fd(n,t,"aria-descriptor").each(function(t){var e=Mi("aria");Si(t.element,"id",e),Si(n.element,"aria-describedby",e)})})])),lp(ut.some(u))),s={repositionMenus:function(t){cp.isOn(t)&&xw(t)}};return{uid:t.uid,dom:t.dom,components:n,apis:s,eventOrder:et(et({},t.eventOrder),((r={})[sr()]=["disabling","toggling","alloy.base.behaviour"],r)),events:c,behaviours:Cf(t.splitDropdownBehaviours,[$x.config({others:{sandbox:function(n){var e=dd(n,t,"arrow");return yw(t,n,{onOpen:function(){cp.on(e),cp.on(n)},onClose:function(){cp.off(e),cp.off(n)}})}}}),zg.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t){return u(t),ut.some(!0)}}),Jg.config({}),cp.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),XT=function(t){return{isDisabled:function(){return Rv.isDisabled(t)},setDisabled:function(n){return Rv.set(t,n)}}},YT=function(t){return{setActive:function(n){cp.set(t,n)},isActive:function(){return cp.isOn(t)},isDisabled:function(){return Rv.isDisabled(t)},setDisabled:function(n){return Rv.set(t,n)}}},qT=function(t,n){return t.map(function(t){return{"aria-label":n.translate(t),title:n.translate(t)}}).getOr({})},KT=Mi("focus-button"),JT=["checklist","ordered-list"],$T=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],QT=function(t,n,e,o,r,i){var u,a=function(t){return wv.isRtl()&&St(JT,t)?t+"-rtl":t},c=wv.isRtl()&&t.exists(function(t){return St($T,t)});return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:qT(e,i)},components:bb([t.map(function(t){return gC(a(t),i.icons)}),n.map(function(t){return hC(t,"tox-tbtn",i)})]),eventOrder:((u={})[Uo()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:Pc([mb(i.isReadOnly),sb(),Gg("common-button-display-events",[zr(Uo(),function(t,n){n.event.prevent(),Dr(t,KT)})])].concat(o.map(function(e){return NT.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t){return bb([t.icon.map(function(t){return gC(a(t),i.icons)}),t.text.map(function(t){return hC(t,"tox-tbtn",i)})])}})}).toArray()).concat(r.getOr([])))}},ZT=function(t,n,e){var o,r=Ke(Y),i=QT(t.icon,t.text,t.tooltip,ut.none(),ut.none(),e);return Xp.sketch({dom:i.dom,components:i.components,eventOrder:bC,buttonBehaviours:Pc([Gg("toolbar-button-events",[(o={onAction:t.onAction,getApi:n.getApi},Kr(function(t){gb(o,t)(function(n){Ar(t,vC,{buttonApi:n}),o.onAction(n)})})),pb(n,r),hb(n,r)]),mb(function(){return t.disabled||e.isReadOnly()}),sb()].concat(n.toolbarButtonBehaviours))})},tE=function(t,n,e){return ZT(t,{toolbarButtonBehaviours:[].concat(0<e.length?[Gg("toolbarButtonWith",e)]:[]),getApi:XT,onSetup:t.onSetup},n)},nE=function(t,n,e){return On(ZT(t,{toolbarButtonBehaviours:[Wg.config({}),cp.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(0<e.length?[Gg("toolbarToggleButtonWith",e)]:[]),getApi:YT,onSetup:t.onSetup},n))},eE=function(t,n){var e,o,r,i,u=Mi("channel-update-split-dropdown-display"),a=function(t){return{isDisabled:function(){return Rv.isDisabled(t)},setDisabled:function(n){return Rv.set(t,n)},setIconFill:function(n,e){Ta(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each(function(t){Si(t,"fill",e)})},setIconStroke:function(n,e){Ta(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each(function(t){Si(t,"stroke",e)})},setActive:function(n){Si(t.element,"aria-pressed",n),Ta(t.element,"span").each(function(e){t.getSystem().getByDom(e).each(function(t){return cp.set(t,n)})})},isActive:function(){return Ta(t.element,"span").exists(function(n){return t.getSystem().getByDom(n).exists(cp.isOn)})}}},c=Ke(Y),s={getApi:a,onSetup:t.onSetup};return GT.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:et({"aria-pressed":!1},qT(t.tooltip,n.providers))},onExecute:function(n){t.onAction(a(n))},onItemExecute:function(){},splitDropdownBehaviours:Pc([db(n.providers.isReadOnly),sb(),Gg("split-dropdown-events",[zr(KT,Jg.focus),pb(s,c),hb(s,c)]),Ow.config({})]),eventOrder:((e={})[xr()]=["alloy.base.behaviour","split-dropdown-events"],e),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:(o=a,r=t,i=n.providers,function(t){return Px(function(t){return r.fetch(t)}).map(function(n){return ut.from(Vy(On(hy(Mi("menu-value"),n,function(n){r.onItemAction(o(t),n)},r.columns,r.presets,Vh.CLOSE_ON_EXECUTE,r.select.getOr(function(){return!1}),i),{movement:by(r.columns,r.presets),menuBehaviours:fv("auto"!==r.columns?[]:[Xr(function(t){sv(t,4,Gh(r.presets)).each(function(n){var e=n.numRows,o=n.numColumns;zg.setGridSize(t,e,o)})})])})))})}),parts:{menu:Kh(0,t.columns,t.presets)},components:[GT.parts.button(QT(t.icon,t.text,ut.none(),ut.some(u),ut.some([cp.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),GT.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Kp("chevron-down",n.providers.icons)},buttonBehaviours:Pc([db(n.providers.isReadOnly),sb()])}),GT.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})},oE=function(t,n){return zr(vC,function(e,o){var r,i=t.get(e),u=(r=i,{hide:function(){return Dr(r,mr())},getValue:function(){return wf.getValue(r)}});n.onAction(u,o.event.buttonApi)})},rE=function(t,e,o){var r,i,u,a,c,s,l,f,d,m,g,p,h={backstage:{shared:{providers:o}}};return"contextformtogglebutton"===e.type?(l=t,d=h,(m=(f=e).original).primary,g=n(m,["primary"]),p=de(Ch(et(et({},g),{type:"togglebutton",onAction:function(){}}))),nE(p,d.backstage.shared.providers,[oE(l,f)])):(r=t,u=h,(a=(i=e).original).primary,c=n(a,["primary"]),s=de(wh(et(et({},c),{type:"button",onAction:function(){}}))),tE(s,u.backstage.shared.providers,[oE(r,i)]))},iE=function(t,n){var e,o,r,i,u=t.label.fold(function(){return{}},function(t){return{"aria-label":t}}),a=Yp(Tx.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:u,selectOnFocus:!0,inputBehaviours:Pc([zg.config({
mode:"special",onEnter:function(t){return c.findPrimary(t).map(function(t){return Mr(t),!0})},onLeft:function(t,n){return n.cut(),ut.none()},onRight:function(t,n){return n.cut(),ut.none()}})])})),c=(e=a,o=t.commands,r=n,i=_t(o,function(t){return Yp(rE(e,t,r))}),{asSpecs:function(){return _t(i,function(t){return t.asSpec()})},findPrimary:function(t){return Ut(o,function(n,e){return n.primary?ut.from(i[e]).bind(function(n){return n.getOpt(t)}).filter($(Rv.isDisabled)):ut.none()})}});return[{title:ut.none(),items:[a.asSpec()]},{title:ut.none(),items:c.asSpecs()}]},uE=function(t,n){var e,o,r,i,u,a=pa(window),c=xa($e.fromDom(t.getContentAreaContainer())),s=Uv(t)||Wv(t)||Xv(t),l=(e=c,o=a,r=Math.max(o.x,e.x),i=e.right-r,u=o.width-(r-o.x),{x:r,width:Math.min(i,u)}),f=l.x,d=l.width;if(t.inline&&!s)return ya(f,a.y,d,a.height);var m=function(t,n,e,o){var r=$e.fromDom(t.getContainer()),i=Ta(r,".tox-editor-header").getOr(r),u=xa(i),a=u.y>=n.bottom,c=o&&!a;if(t.inline&&c)return{y:Math.max(u.bottom,e.y),bottom:e.bottom};if(t.inline&&!c)return{y:e.y,bottom:Math.min(u.y,e.bottom)};var s=xa(r);return c?{y:Math.max(u.bottom,e.y),bottom:Math.min(s.bottom,e.bottom)}:{y:Math.max(s.y,e.y),bottom:Math.min(u.y,e.bottom)}}(t,c,a,n.header.isPositionedAtTop()),g=m.y,p=m.bottom;return ya(f,g,d,p-g)},aE=function(t,n){var e=Bt(n,function(n){return n.predicate(t.dom)}),o=Et(e,function(t){return"contexttoolbar"===t.type});return{contextToolbars:o.pass,contextForms:o.fail}},cE=function(t,n,e){var o=aE(t,n);if(0<o.contextForms.length)return ut.some({elem:t,toolbars:[o.contextForms[0]]});var r=aE(t,e);if(0<r.contextForms.length)return ut.some({elem:t,toolbars:[r.contextForms[0]]});if(0<o.contextToolbars.length||0<r.contextToolbars.length){var i=function(t){if(t.length<=1)return t;var n=function(n){return kt(t,function(t){return t.position===n})},e=function(n){return Bt(t,function(t){return t.position===n})},o=n("selection"),r=n("node");if(o||r){if(r&&o){var i=e("node"),u=_t(e("selection"),function(t){return et(et({},t),{position:"node"})});return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars));return ut.some({elem:t,toolbars:i})}return ut.none()},sE=function(t,n,e){return t(n)?ut.none():Fo(n,function(t){var n=aE(t,e.inNodeScope),o=n.contextToolbars,r=n.contextForms,i=0<r.length?r:function(t){if(t.length<=1)return t;var n=function(n){return Mt(t,function(t){return t.position===n})};return n("selection").orThunk(function(){return n("node")}).orThunk(function(){return n("line")}).map(function(t){return t.position}).fold(function(){return[]},function(n){return Bt(t,function(t){return t.position===n})})}(o);return 0<i.length?ut.some({elem:t,toolbars:i}):ut.none()},t)},lE=function(t,n){var e={},o=[],r=[],i={},u={},a=function(t,a){var c=de(fe("ContextForm",Ah,a));(e[t]=c).launch.map(function(e){i["form:"+t]=et(et({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})}),"editor"===c.scope?r.push(c):o.push(c),u[t]=c},c=function(t,n){fe("ContextToolbar",Mh,n).each(function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e})},s=ln(t);return Tt(s,function(n){var e=t[n];"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&c(n,e)}),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},fE=Mi("forward-slide"),dE=Mi("backward-slide"),mE=Mi("change-slide-event"),gE="tox-pop--resizing",pE=function(t,n,e){var o,r,i,u,a,c=e.dataset,s="basic"===c.type?function(){return _t(c.data,function(t){return t_(t,e.isSelectedFor,e.getPreviewFor)})}:c.getData;return{items:(o=n,r=e,i=function(t,n,e,i){var a=o.shared.providers.translate(t.title);if("separator"===t.type)return ut.some({type:"separator",text:a});if("submenu"!==t.type)return ut.some(et({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(i),disabled:e,onAction:r.onAction(t)},t.getStylePreview().fold(function(){return{}},function(t){return{meta:{style:t}}})));var c=Rt(t.getStyleItems(),function(t){return u(t,n,i)});return 0===n&&c.length<=0?ut.none():ut.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return Rt(t.getStyleItems(),function(t){return u(t,n,i)})}})},u=function(t,n,e){var o="formatter"===t.type&&r.isInvalid(t);return 0===n?o?[]:i(t,n,!1,e).toArray():i(t,n,o,e).toArray()},{validateItems:a=function(t){var n=r.getCurrentValue(),e=r.shouldHide?0:1;return Rt(t,function(t){return u(t,e,n)})},getFetch:function(t,n){return function(e,o){var r=n(),i=a(r);o(TC(i,Vh.CLOSE_ON_EXECUTE,t,!1))}}}),getStyleItems:s}},hE=function(t,n,e){var o=pE(0,n,e),r=o.items,i=o.getStyleItems;return wC({text:e.icon.isSome()?ut.none():ut.some(""),icon:e.icon,tooltip:ut.from(e.tooltip),role:ut.none(),fetch:r.getFetch(n,i),onSetup:function(n){return e.setInitialValue.each(function(t){return t(n.getComponent())}),e.nodeChangeHandler.map(function(e){var o=e(n.getComponent());return t.on("NodeChange",o),function(){t.off("NodeChange",o)}}).getOr(Y)},getApi:function(t){return{getComponent:function(){return t}}},columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)};(fw=lw=lw||{})[fw.SemiColon=0]="SemiColon",fw[fw.Space=1]="Space";var vE,bE,yE,xE,wE,SE,kE=function(t,n,e,o){var r,i;return{type:"basic",data:(i=t.getParam(n,e,"string"),r=o===lw.SemiColon?i.replace(/;$/,"").split(";"):i.split(" "),_t(r,function(t){var n=t,e=t,o=t.split("=");return 1<o.length&&(n=o[0],e=o[1]),{title:n,format:e}}))}},CE=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],OE=function(t){var n=function(n){var e=Mt(CE,function(n){return t.formatter.match(n.format)}).fold(function(){return"left"},function(t){return t.title.toLowerCase()});Ar(n,xC,{icon:"align-"+e})},e=ut.some(function(t){return function(){return n(t)}}),o=ut.some(n),r={type:"basic",data:CE};return{tooltip:"Align",icon:ut.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:ut.none,getPreviewFor:function(){return function(){return ut.none()}},onAction:function(n){return function(){return Mt(CE,function(t){return t.format===n.format}).each(function(n){return t.execCommand(n.command)})}},setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},_E=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],TE=function(t){var n=t.split(/\s*,\s*/);return _t(n,function(t){return t.replace(/^['"]+|['"]+$/g,"")})},EE=function(t){var n;return 0===t.indexOf("-apple-system")&&(n=TE(t.toLowerCase()),Vt(_E,function(t){return-1<n.indexOf(t.toLowerCase())}))},BE=function(t){var n=function(){var n=function(t){return t?TE(t)[0]:""},e=t.queryCommandValue("FontName"),o=i.data,r=e?e.toLowerCase():"";return{matchOpt:Mt(o,function(t){var e=t.format;return e.toLowerCase()===r||n(e).toLowerCase()===n(r).toLowerCase()}).orThunk(function(){return EE(r)?ut.from({title:"System Font",format:r}):ut.none()}),font:e}},e=function(t){var e=n(),o=e.matchOpt,r=e.font,i=o.fold(function(){return r},function(t){return t.title});Ar(t,yC,{text:i})},o=ut.some(function(t){return function(){return e(t)}}),r=ut.some(e),i=kE(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",lw.SemiColon);return{tooltip:"Fonts",icon:ut.none(),isSelectedFor:function(t){return function(n){return n.exists(function(n){return n.format===t})}},getCurrentValue:function(){return n().matchOpt},getPreviewFor:function(t){return function(){return ut.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(n){return function(){t.undoManager.transact(function(){t.focus(),t.execCommand("FontName",!1,n.format)})}},setInitialValue:r,nodeChangeHandler:o,dataset:i,shouldHide:!1,isInvalid:function(){return!1}}},DE={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},AE=function(t,n){return/[0-9.]+px$/.test(t)?(e=72*parseInt(t,10)/96,o=n||0,r=Math.pow(10,o),Math.round(e*r)/r+"pt"):t;var e,o,r},ME=function(t){var n=function(){var n=ut.none(),e=u.data,o=t.queryCommandValue("FontSize");if(o)for(var r=function(t){var r=AE(o,t),i=yn(DE,r).getOr("");n=Mt(e,function(t){return t.format===o||t.format===r||t.format===i})},i=3;n.isNone()&&0<=i;i--)r(i);return{matchOpt:n,size:o}},e=K(ut.none),o=function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold(function(){return r},function(t){return t.title});Ar(t,yC,{text:i})},r=ut.some(function(t){return function(){return o(t)}}),i=ut.some(o),u=kE(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",lw.Space);return{tooltip:"Font sizes",icon:ut.none(),isSelectedFor:function(t){return function(n){return n.exists(function(n){return n.format===t})}},getPreviewFor:e,getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact(function(){t.focus(),t.execCommand("FontSize",!1,n.format)})}},setInitialValue:i,nodeChangeHandler:r,dataset:u,shouldHide:!1,isInvalid:function(){return!1}}},FE=function(t,n,e){var o=n();return Ut(e,function(n){return Mt(o,function(e){return t.formatter.matchNode(n,e.format)})}).orThunk(function(){return t.formatter.match("p")?ut.some({title:"Paragraph",format:"p"}):ut.none()})},IE=function(t){var n=t.selection.getStart(!0)||t.getBody();return t.dom.getParents(n,function(){return!0},t.getBody())},RE=function(t){var n=Ke(ut.none()),e=function(){return n.get().each(t)};return{clear:function(){e(),n.set(ut.none())},isSet:function(){return n.get().isSome()},set:function(t){e(),n.set(ut.some(t))}}},VE=function(){return RE(function(t){return t.unbind()})},PE=function(t,n){return function(e){var o=VE(),r=function(){e.setActive(t.formatter.match(n));var r=t.formatter.formatChanged(n,e.setActive);o.set(r)};return t.initialized?r():t.on("init",r),o.clear}},HE=function(t){return function(n){return function(){t.undoManager.transact(function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)})}}},zE=function(t){var n=function(n,e){var o=FE(t,function(){return r.data},n).fold(function(){return"Paragraph"},function(t){return t.title});Ar(e,yC,{text:o})},e=ut.some(function(t){return function(e){return n(e.parents,t)}}),o=ut.some(function(e){var o=IE(t);n(o,e)}),r=kE(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",lw.SemiColon);return{tooltip:"Blocks",icon:ut.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:ut.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return ut.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},onAction:HE(t),setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},NE=function(t,n){var e=function(n,e){var o=function(t){var n=t.items;return n!==undefined&&0<n.length?Rt(n,o):[{title:t.title,format:t.format}]},r=Rt(ZO(t),o),i=FE(t,function(){return r},n).fold(function(){return"Paragraph"},function(t){return t.title});Ar(e,yC,{text:i})},o=ut.some(function(t){return function(n){return e(n.parents,t)}}),r=ut.some(function(n){var o=IE(t);e(o,n)});return{tooltip:"Formats",icon:ut.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:ut.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return e!==undefined?ut.some({tag:0<e.length&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):ut.none()}},onAction:HE(t),setInitialValue:r,nodeChangeHandler:o,shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},LE=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],jE=function(t,n){return function(e,o,r){var i=t(e).mapError(function(t){return ge(t)}).getOrDie();return n(i,o,r)}},UE={button:jE(wh,function(t,n){return e=t,o=n.backstage.shared.providers,tE(e,o,[]);var e,o}),togglebutton:jE(Ch,function(t,n){return e=t,o=n.backstage.shared.providers,nE(e,o,[]);var e,o}),menubutton:jE(RT,function(t,n){return BC(t,"tox-tbtn",n.backstage,ut.none())}),splitbutton:jE(function(t){return fe("SplitButton",VT,t)},function(t,n){return eE(t,n.backstage.shared)}),grouptoolbarbutton:jE(function(t){return fe("GroupToolbarButton",MT,t)},function(t,n,e){var o,r,i,u,a,c,s=e.ui.registry.getAll().buttons,l=((o={})[xs]=n.backstage.shared.header.isPositionedAtTop()?Fa.TopToBottom:Fa.BottomToTop,o);switch(Kv(e)){case Ih.floating:return r=t,i=n.backstage,u=function(t){return YE(e,{buttons:s,toolbar:t,allowToolbarGroups:!1},n,ut.none())},a=l,c=i.shared,J_.sketch({lazySink:c.getSink,fetch:function(){return Px(function(t){t(_t(u(r.items),_T))})},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:QT(r.icon,r.text,r.tooltip,ut.none(),ut.none(),c.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:a}}}});default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}}),styleSelectButton:function(t,n){return e=t,o=n.backstage,r=et({type:"advanced"},o.styleselect),hE(e,o,NE(e,r));var e,o,r},fontsizeSelectButton:function(t,n){return e=t,o=n.backstage,hE(e,o,ME(e));var e,o},fontSelectButton:function(t,n){return e=t,o=n.backstage,hE(e,o,BE(e));var e,o},formatButton:function(t,n){return e=t,o=n.backstage,hE(e,o,zE(e));var e,o},alignMenuButton:function(t,n){return e=t,o=n.backstage,hE(e,o,OE(e));var e,o}},WE={styleselect:UE.styleSelectButton,fontsizeselect:UE.fontsizeSelectButton,fontselect:UE.fontSelectButton,formatselect:UE.formatButton,align:UE.alignMenuButton},GE=function(t){var n,e,o,r=t.toolbar,i=t.buttons;return!1===r?[]:r===undefined||!0===r?(e=i,o=_t(LE,function(t){var n=Bt(t.items,function(t){return xn(e,t)||xn(WE,t)});return{name:t.name,items:n}}),Bt(o,function(t){return 0<t.items.length})):st(r)?(n=r.split("|"),_t(n,function(t){return{items:t.trim().split(" ")}})):vt(r,function(t){return xn(t,"name")&&xn(t,"items")})?r:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},XE=function(t,n,e,o,r,i){return yn(n,e.toLowerCase()).orThunk(function(){return i.bind(function(t){return Ut(t,function(t){return yn(n,t+e.toLowerCase())})})}).fold(function(){return yn(WE,e.toLowerCase()).map(function(n){return n(t,r)}).orThunk(function(){return ut.none()})},function(n){return"grouptoolbarbutton"!==n.type||o?(u=r,a=t,yn(UE,(i=n).type).fold(function(){return console.error("skipping button defined by",i),ut.none()},function(t){return ut.some(t(i,u,a))})):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),ut.none());var i,u,a})},YE=function(t,n,e,o){var r=GE(n),i=_t(r,function(r){var i=Rt(r.items,function(r){return 0===r.trim().length?[]:XE(t,n.buttons,r,n.allowToolbarGroups,e,o).toArray()});return{title:ut.from(t.translate(r.name)),items:i}});return Bt(i,function(t){return 0<t.items.length})},qE={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},KE={maxHeightFunction:fs(),maxWidthFunction:A_()},JE={onLtr:function(){return[xc,wc,bc,hc,yc,vc,Up,Wp,Lp,zp,jp,Np]},onRtl:function(){return[xc,wc,yc,vc,bc,hc,Up,Wp,jp,Np,Lp,zp]}},$E={onLtr:function(){return[wc,hc,vc,bc,yc,xc,Up,Wp,Lp,zp,jp,Np]},onRtl:function(){return[wc,vc,hc,yc,bc,xc,Up,Wp,jp,Np,Lp,zp]}},QE=function(t,n,e,o){var r,i,u=_o().deviceType.isTouch,a=Ju((r={sink:e,onEscape:function(){return t.focus(),ut.some(!0)}},i=Ke([]),Fp.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){i.set([]),Fp.getContent(t).each(function(t){Pu(t.element,"visibility")}),mu(t.element,gE),Pu(t.element,"width")},inlineBehaviours:Pc([Gg("context-toolbar-events",[Gr(nr(),function(t){mu(t.element,gE),Pu(t.element,"width")}),zr(mE,function(t,n){Pu(t.element,"width");var e=aa(t.element);Fp.setContent(t,n.event.contents),fu(t.element,gE);var o=aa(t.element);Du(t.element,"width",e+"px"),Fp.getContent(t).each(function(e){n.event.focus.bind(function(n){return Gc(n),Yc(t.element)}).orThunk(function(){return zg.focusIn(e),Xc()})}),Gp.setTimeout(function(){Du(t.element,"width",o+"px")},0)}),zr(fE,function(t,n){Fp.getContent(t).each(function(t){i.set(i.get().concat([{bar:t,focus:Xc()}]))}),Ar(t,mE,{contents:n.event.forwardContents,focus:ut.none()})}),zr(dE,function(t){Lt(i.get()).each(function(n){i.set(i.get().slice(0,i.get().length-1)),Ar(t,mE,{contents:$u(n.bar),focus:n.focus})})})]),zg.config({mode:"special",onEscape:function(t){return Lt(i.get()).fold(function(){return r.onEscape()},function(){return Dr(t,dE),ut.some(!0)})}})]),lazySink:function(){return Xt.value(r.sink)}}))),c=function(){return uE(t,o.backstage.shared)},s=function(){if(u()&&o.backstage.isContextMenuOpen())return!0;var n,e,r,i,a,s,l=(n=m.get().filter(function(t){return Ou($e.fromDom(t))}).map(function(t){return t.getBoundingClientRect()}).getOrThunk(function(){return t.selection.getRng().getBoundingClientRect()}),e=t.inline?da().top:wa($e.fromDom(t.getBody())).y,{y:n.top+e,bottom:n.bottom+e}),f=c();return r=l.y,i=l.bottom,a=f.y,s=f.bottom,!(Math.max(r,a)<=Math.min(i,s))},l=function(){Fp.hide(a)},f=function(){d.get().each(function(t){var n=a.element;Pu(n,"display"),s()?Du(n,"display","none"):Ml.positionWithinBounds(e,t,a,ut.some(c()))})},d=Ke(ut.none()),m=Ke(ut.none()),g=Ke(null),p=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:Pc([zg.config({mode:"acyclic"}),Gg("pop-dialog-wrap-events",[Xr(function(n){t.shortcuts.add("ctrl+F9","focus statusbar",function(){return zg.focusIn(n)})}),Yr(function(){t.shortcuts.remove("ctrl+F9")})])])}},h=Tn(function(){return lE(n,function(t){var n=v([t]);Ar(a,fE,{forwardContents:p(n)})})}),v=function(n){var e=t.ui.registry.getAll().buttons,r=h(),i=et(et({},e),r.formNavigators),u=Kv(t)===Ih.scrolling?Ih.scrolling:Ih["default"],a=It(_t(n,function(n){return"contexttoolbar"===n.type?YE(t,{buttons:i,toolbar:n.items,allowToolbarGroups:!1},o,ut.some(["form:"])):(e=n,r=o.backstage.shared.providers,iE(e,r));var e,r}));return AT({type:u,uid:Mi("context-toolbar"),initGroups:a,onEscape:ut.none,cyclicKeying:!0,providers:o.backstage.shared.providers})};t.on("contexttoolbar-show",function(n){var e=h();yn(e.lookupTable,n.toolbarKey).each(function(e){y([e],n.target===t?ut.none():ut.some(n)),Fp.getContent(a).each(zg.focusIn)})});var b=function(t,n){var e,r,i="node"===t?o.backstage.shared.anchors.node(n):o.backstage.shared.anchors.cursor();return On(i,(e=t,r=u(),"line"===e?{bubble:hs(12,0,qE),layouts:{onLtr:function(){return[Sc]},onRtl:function(){return[kc]}},overrides:KE}:{bubble:hs(0,12,qE),layouts:r?$E:JE,overrides:KE}))},y=function(t,n){var e,r,i,l;w(),u()&&o.backstage.isContextMenuOpen()||(e=v(t),r=n.map($e.fromDom),i=b(t[0].position,r),d.set(ut.some(i)),m.set(n),l=a.element,Pu(l,"display"),Fp.showWithinBounds(a,i,p(e),function(){return ut.some(c())}),s()&&Du(l,"display","none"))},x=function(){var n,e,o,r,i,u,c;t.hasFocus()&&(n=h(),e=n,o=t,i=$e.fromDom(o.getBody()),u=function(t){return Bo(t,i)},c=$e.fromDom(o.selection.getNode()),(u(r=c)||Ao(i,r)?cE(c,e.inNodeScope,e.inEditorScope).orThunk(function(){return sE(u,c,e)}):ut.none()).fold(function(){d.set(ut.none()),Fp.hide(a)},function(t){y(t.toolbars,ut.some(t.elem.dom))}))},w=function(){var t=g.get();null!==t&&(Gp.clearTimeout(t),g.set(null))},S=function(t){w(),g.set(t)};t.on("init",function(){t.on(M_,l),t.on("ScrollContent ScrollWindow longpress",f),t.on("click keyup focus SetContent ObjectResized ResizeEditor",function(){S(Gp.setEditorTimeout(t,x,0))}),t.on("focusout",function(){Gp.setEditorTimeout(t,function(){Yc(e.element).isNone()&&Yc(a.element).isNone()&&(d.set(ut.none()),Fp.hide(a))},0)}),t.on("SwitchMode",function(){t.mode.isReadOnly()&&(d.set(ut.none()),Fp.hide(a))}),t.on("NodeChange",function(){Yc(a.element).fold(function(){S(Gp.setEditorTimeout(t,x,0))},function(){})})})},ZE=yd,tB=ed,nB=K([Ne("shell",!1),_e("makeItem"),Ne("setupItem",Y),Of("listBehaviours",[Wg])]),eB=Zf({name:"items",overrides:function(){return{behaviours:Pc([Wg.config({})])}}}),oB=K([eB]),rB=_d({name:K("CustomList")(),configFields:nB(),partFields:oB(),factory:function(t,n){var e=t.shell?{behaviours:[Wg.config({})],components:[]}:{behaviours:[],components:n},o=function(n){return t.shell?ut.some(n):fd(n,t,"items")};return{uid:t.uid,dom:t.dom,components:e.components,behaviours:Cf(t.listBehaviours,e.behaviours),apis:{setItems:function(n,e){o(n).fold(function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")},function(o){var r=Wg.contents(o),i=e.length,u=i-r.length,a=0<u?Ct(u,function(){return t.makeItem()}):[],c=r.slice(i);Tt(c,function(t){return Wg.remove(o,t)}),Tt(a,function(t){return Wg.append(o,t)});var s=Wg.contents(o);Tt(s,function(o,r){t.setupItem(n,o,e[r],r)})})}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),iB=Y,uB=Z,aB=K([]),cB=Object.freeze({__proto__:null,setup:iB,isDocked:uB,getBehaviours:aB}),sB=function(t){return(Ru(t,"position").is("fixed")?ut.none():ci(t)).orThunk(function(){var n=$e.fromTag("span");return ui(t).bind(function(t){gi(t,n);var e=ci(n);return vi(n),e})})},lB=function(t){return sB(t).map(ra).getOrThunk(function(){return ea(0,0)})},fB=Sn([{"static":[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),dB=function(t,n){var e=t.element;fu(e,n.transitionClass),mu(e,n.fadeOutClass),fu(e,n.fadeInClass),n.onShow(t)},mB=function(t,n){var e=t.element;fu(e,n.transitionClass),mu(e,n.fadeInClass),fu(e,n.fadeOutClass),n.onHide(t)},gB=function(t,n,e){return Vt(t,function(t){switch(t){case"bottom":return r=e,n.bottom<=r.bottom;case"top":return o=e,n.y>=o.y}var o,r})},pB=function(t,n){return n.getInitialPosition().map(function(n){return ya(n.bounds.x,n.bounds.y,aa(t),Zu(t))})},hB=function(t,n,e){e.setInitialPosition(ut.some({style:function(t){var n={},e=t.dom;if(vu(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n}(t),position:Fu(t,"position")||"static",bounds:n}))},vB=function(t,n,e){return e.getInitialPosition().bind(function(o){switch(e.setInitialPosition(ut.none()),o.position){case"static":return ut.some(fB["static"]());case"absolute":var r=sB(t).map(xa).getOrThunk(function(){return xa(_u())});return ut.some(fB.absolute(Kc("absolute",yn(o.style,"left").map(function(){return n.x-r.x}),yn(o.style,"top").map(function(){return n.y-r.y}),yn(o.style,"right").map(function(){return r.right-n.right}),yn(o.style,"bottom").map(function(){return r.bottom-n.bottom}))));default:return ut.none()}})},bB=function(t,n,e){var o,r,i,u=t.element;return Ru(u,"position").is("fixed")?(r=n,pB(o=u,i=e).filter(function(t){return gB(i.getModes(),t,r)}).bind(function(t){return vB(o,t,i)})):function(t,n,e){var o=xa(t);if(gB(e.getModes(),o,n))return ut.none();hB(t,o,e);var r=Sa(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y;return ut.some(fB.fixed(Kc("fixed",ut.some(i),c?ut.some(u):ut.none(),ut.none(),c?ut.none():ut.some(a))))}(u,n,e)},yB=function(t,n){Tt(["left","right","top","bottom","position"],function(n){return Pu(t.element,n)}),n.onUndocked(t)},xB=function(t,n,e){Jc(t.element,e),("fixed"===e.position?n.onDocked:n.onUndocked)(t)},wB=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each(function(n){n.lazyContext(t).each(function(i){var u,a,c=(a=o,(u=i).y<a.bottom&&u.bottom>a.y);c!==e.isVisible()&&(e.setVisible(c),r&&!c?(pu(t.element,[n.fadeOutClass]),n.onHide(t)):(c?dB:mB)(t,n))})})},SB=function(t,n,e){var o,r,i=t.element;e.setDocked(!1),o=e,r=t.element,pB(r,o).bind(function(t){return vB(r,t,o)}).each(function(e){e.fold(function(){return yB(t,n)},function(e){return xB(t,n,e)},Y)}),e.setVisible(!0),n.contextual.each(function(n){hu(i,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(t)}),kB(t,n,e)},kB=function(t,n,e){var o,r,i,u,a;t.getSystem().isConnected()&&(o=t,i=e,u=(r=n).lazyViewport(o),(a=i.isDocked())&&wB(o,r,i,u),bB(o,u,i).each(function(t){i.setDocked(!a),t.fold(function(){return yB(o,r)},function(t){return xB(o,r,t)},function(t){wB(o,r,i,u,!0),xB(o,r,t)})}))},CB=function(t,n,e){e.isDocked()&&SB(t,n,e)},OB=Object.freeze({__proto__:null,refresh:kB,reset:CB,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),_B=Object.freeze({__proto__:null,events:function(t,n){return Vr([Gr(nr(),function(e,o){t.contextual.each(function(t){gu(e.element,t.transitionClass)&&(hu(e.element,[t.transitionClass,t.fadeInClass]),(n.isVisible()?t.onShown:t.onHidden)(e)),o.stop()})}),zr(br(),function(e){kB(e,t,n)}),zr(yr(),function(e){CB(e,t,n)})])}}),TB=[ze("contextual",[Ee("fadeInClass"),Ee("fadeOutClass"),Ee("transitionClass"),De("lazyContext"),Xa("onShow"),Xa("onShown"),Xa("onHide"),Xa("onHidden")]),Xe("lazyViewport",Sa),Le("modes",["top","bottom"],$n(xe)),Xa("onDocked"),Xa("onUndocked")],EB=zc({fields:TB,name:"docking",active:_B,apis:OB,state:Object.freeze({__proto__:null,init:function(t){var n=Ke(!1),e=Ke(!0),o=Ke(ut.none()),r=Ke(t.modes);return Ki({isDocked:n.get,setDocked:n.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}})}),BB={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},DB="tox-tinymce--toolbar-sticky-on",AB="tox-tinymce--toolbar-sticky-off",MB=function(t){var n=t.element;ui(n).each(function(e){var o,r,i="padding-"+EB.getModes(t)[0];EB.isDocked(t)?(o=aa(e),Du(n,"width",o+"px"),Du(e,i,ta(r=n)+(parseInt(Fu(r,"margin-top"),10)||0)+(parseInt(Fu(r,"margin-bottom"),10)||0)+"px")):(Pu(n,"width"),Pu(e,i))})},FB=function(t,n){n?(mu(t,BB.fadeOutClass),pu(t,[BB.transitionClass,BB.fadeInClass])):(mu(t,BB.fadeInClass),pu(t,[BB.fadeOutClass,BB.transitionClass]))},IB=function(t,n){var e=$e.fromDom(t.getContainer());n?(fu(e,DB),mu(e,AB)):(fu(e,AB),mu(e,DB))},RB=function(t,n){var o,r=Ke(ut.none()),i=n.getSink,u=function(t){i().each(function(n){return t(n.element)})},a=function(n){t.inline||MB(n),IB(t,EB.isDocked(n)),n.getSystem().broadcastOn([ef()],{}),i().each(function(t){return t.getSystem().broadcastOn([ef()],{})})},c=t.inline?[]:[Uc.config({channels:((o={})[CT()]={onReceive:MB},o)})];return e([Jg.config({}),EB.config({contextual:et({lazyContext:function(n){var e,o,r=ta(n.element),i=t.inline?t.getContentAreaContainer():t.getContainer(),u=xa($e.fromDom(i)),a=u.height-r,c=u.y+(e=n,o="top",St(EB.getModes(e),o)?0:r);return ut.some(ya(u.x,c,u.width,a))},onShow:function(){u(function(t){return FB(t,!0)})},onShown:function(t){u(function(t){return hu(t,[BB.transitionClass,BB.fadeInClass])}),r.get().each(function(n){var e,o,i;e=t.element,i=ei(o=n),Xc(i).filter(function(t){return!Bo(o,t)}).filter(function(t){return Bo(t,$e.fromDom(i.dom.body))||Ao(e,t)}).each(function(){return Gc(o)}),r.set(ut.none())})},onHide:function(t){var n,e;r.set((n=t.element,e=i,Yc(n).orThunk(function(){return e().toOptional().bind(function(t){return Yc(t.element)})}))),u(function(t){return FB(t,!1)})},onHidden:function(){u(function(t){return hu(t,[BB.transitionClass])})}},BB),modes:[n.header.getDockingMode()],onDocked:a,onUndocked:a})],c)},VB=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",function(){e().each(EB.reset)}),t.on("ResizeWindow ResizeEditor",function(){e().each(MB)}),t.on("SkinLoaded",function(){e().each(function(t){EB.isDocked(t)?EB.reset(t):EB.refresh(t)})}),t.on("FullscreenStateChanged",function(){e().each(EB.reset)})),t.on("AfterScrollIntoView",function(t){e().each(function(n){EB.refresh(n);var e,o,r,i,u,a,c,s,l,f,d,m,g,p,h,v,b,y=n.element;Fm(y)&&(e=t,u=(i=ei(o=y)).dom.defaultView.innerHeight,a=da(i),c=$e.fromDom(e.elm),s=wa(c),l=Zu(c),d=(f=s.y)+l,m=ra(o),g=Zu(o),h=(p=m.top)+g,v=Math.abs(p-a.top)<2,b=Math.abs(h-(a.top+u))<2,v&&f<h?ma(a.left,f-g,i):b&&p<d&&(r=f-u+l+g,ma(a.left,r,i)))})}),t.on("PostRender",function(){IB(t,!1)})},isDocked:function(t){return t().map(EB.isDocked).getOr(!1)},getBehaviours:RB}),PB=Od({factory:function(t,n){var e={focus:zg.focusIn,setMenus:function(t,e){var o=_t(e,function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=RT(e).mapError(function(t){return ge(t)}).getOrDie();return BC(o,"tox-mbtn",n.backstage,ut.some("menuitem"))});Wg.set(t,o)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:Pc([Wg.config({}),Gg("menubar-events",[Xr(function(n){t.onSetup(n)}),zr(Yo(),function(t,n){Ta(t.element,".tox-mbtn--active").each(function(e){Ea(n.event.target,".tox-mbtn").each(function(n){Bo(e,n)||t.getSystem().getByDom(e).each(function(e){t.getSystem().getByDom(n).each(function(t){Cw.expand(t),Cw.close(e),Jg.focus(t)})})})})}),zr(Cr(),function(t,n){n.event.prevFocus.bind(function(n){return t.getSystem().getByDom(n).toOptional()}).each(function(e){n.event.newFocus.bind(function(n){return t.getSystem().getByDom(n).toOptional()}).each(function(t){Cw.isOpen(e)&&(Cw.expand(t),Cw.close(e))})})})]),zg.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),ut.some(!0)}}),sx.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[_e("dom"),_e("uid"),_e("onEscape"),_e("backstage"),Ne("onSetup",Y)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),HB="container",zB=[Sf("slotBehaviours",[])],NB=function(t){return"<alloy.field."+t+">"},LB=function(t,n){var e,o=function(){return pd(t)},r=function(n,e){return function(o,r){return fd(o,t,r).map(function(t){return n(t,r)}).getOr(e)}},i=function(t){return"true"!==ki(t.element,"aria-hidden")},u=r(i,!1),a=r(function(t,n){var e;i(t)&&(e=t.element,Du(e,"display","none"),Si(e,"aria-hidden","true"),Ar(t,Or(),{name:n,visible:!1}))}),c=function(t,n){Tt(n,function(n){return e(t,n)})},s=r(function(t,n){var e;i(t)||(e=t.element,Pu(e,"display"),_i(e,"aria-hidden"),Ar(t,Or(),{name:n,visible:!0}))}),l={getSlotNames:o,getSlot:function(n,e){return fd(n,t,e)},isShowing:u,hideSlot:e=a,hideAllSlots:function(t){return c(t,o())},showSlot:s};return{uid:t.uid,dom:t.dom,components:n,behaviours:kf(t.slotBehaviours),apis:l}},jB=mn({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},Yi),UB=et(et({},jB),{sketch:function(t){var n,e=(n=[],{slot:function(t,e){return n.push(t),ud(HB,NB(t),e)},record:function(){return n}}),o=t(e),r=e.record(),i=_t(r,function(t){return $f({name:t,pname:NB(t)})});return wd(HB,zB,i,LB,o)}}),WB=Jn([Pe("icon"),Pe("tooltip"),Xe("onShow",Y),Xe("onHide",Y),Xe("onSetup",function(){return Y})]),GB=function(t){return{element:function(){return t.element.dom}}},XB=function(t,n){var e=_t(ln(n),function(t){var e=n[t],o=de(fe("sidebar",WB,e));return{name:t,getApi:GB,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}});return _t(e,function(n){var o=Ke(Y);return t.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:fv([pb(n,o),hb(n,o),zr(Or(),function(t,n){var o=n.event;Mt(e,function(t){return t.name===o.name}).each(function(n){
(o.visible?n.onShow:n.onHide)(n.getApi(t))})})])})})},YB=function(t,n){Ad.getCurrent(t).each(function(t){return Wg.set(t,[(e=n,UB.sketch(function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:XB(t,e),slotBehaviours:fv([Xr(function(t){return UB.hideAllSlots(t)})])}}))]);var e})},qB=function(t){return Ad.getCurrent(t).bind(function(t){return bT.isGrowing(t)||bT.hasGrown(t)?Ad.getCurrent(t).bind(function(t){return Mt(UB.getSlotNames(t),function(n){return UB.isShowing(t,n)})}):ut.none()})},KB=Mi("FixSizeEvent"),JB=Mi("AutoSizeEvent"),$B=function(t){var n,e,o,r=$e.fromHtml(t),i=si(r),u=(e=(n=r).dom.attributes!==undefined?n.dom.attributes:[],At(e,function(t,n){var e;return"class"===n.name?t:et(et({},t),((e={})[n.name]=n.value,e))},{})),a=(o=r,Array.prototype.slice.call(o.dom.classList,0)),c=0===i.length?{}:{innerHtml:yi(r)};return et({tag:Jr(r),classes:a,attributes:u},c)},QB=function(t,n,e){var o=t.element;!0===n?(Wg.set(t,[{dom:{tag:"div",attributes:{"aria-label":e.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:$B('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:Pc([zg.config({mode:"special",onTab:function(){return ut.some(!0)},onShiftTab:function(){return ut.some(!0)}}),Jg.config({})])}]),Pu(o,"display"),_i(o,"aria-hidden")):(Wg.set(t,[]),Du(o,"display","none"),Si(o,"aria-hidden","true"))},ZB=tB.optional({factory:PB,name:"menubar",schema:[_e("backstage")]}),tD=tB.optional({factory:{sketch:function(t){return rB.sketch({uid:t.uid,dom:t.dom,listBehaviours:Pc([zg.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return AT({type:t.type,uid:Mi("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),ut.some(!0)}})},setupItem:function(t,n,e){R_.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[_e("dom"),_e("onEscape")]}),nD=tB.optional({factory:{sketch:function(t){var n;return((n=t).type===Ih.sliding?DT:n.type===Ih.floating?BT:AT)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),ut.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[_e("dom"),_e("onEscape"),_e("getSink")]}),eD=tB.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?RB:aB;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:Pc(e(n,t.sharedBackstage))}}},name:"header",schema:[_e("dom")]}),oD=tB.optional({name:"socket",schema:[_e("dom")]}),rD=tB.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:Pc([sx.config({}),Jg.config({}),bT.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){Ad.getCurrent(t).each(UB.hideAllSlots),Dr(t,JB)},onGrown:function(t){Dr(t,JB)},onStartGrow:function(t){Ar(t,KB,{width:Ru(t.element,"width").getOr("")})},onStartShrink:function(t){Ar(t,KB,{width:aa(t.element)+"px"})}}),Wg.config({}),Ad.config({find:function(t){var n=Wg.contents(t);return Nt(n)}})])}],behaviours:Pc([Ek(0),Gg("sidebar-sliding-events",[zr(KB,function(t,n){Du(t.element,"width",n.event.width)}),zr(JB,function(t){Pu(t.element,"width")})])])}}},name:"sidebar",schema:[_e("dom")]}),iD=tB.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:Pc([Wg.config({})]),components:[]}}},name:"throbber",schema:[_e("dom")]}),uD=_d({name:"OuterContainer",factory:function(t,n){var e={getSocket:function(n){return ZE.getPart(n,t,"socket")},setSidebar:function(n,e){ZE.getPart(n,t,"sidebar").each(function(t){return YB(t,e)})},toggleSidebar:function(n,e){ZE.getPart(n,t,"sidebar").each(function(t){return n=t,o=e,void Ad.getCurrent(n).each(function(t){Ad.getCurrent(t).each(function(n){bT.hasGrown(t)?UB.isShowing(n,o)?bT.shrink(t):(UB.hideAllSlots(n),UB.showSlot(n,o)):(UB.hideAllSlots(n),UB.showSlot(n,o),bT.grow(t))})});var n,o})},whichSidebar:function(n){return ZE.getPart(n,t,"sidebar").bind(qB).getOrNull()},getHeader:function(n){return ZE.getPart(n,t,"header")},getToolbar:function(n){return ZE.getPart(n,t,"toolbar")},setToolbar:function(n,e){ZE.getPart(n,t,"toolbar").each(function(t){t.getApis().setGroups(t,e)})},setToolbars:function(n,e){ZE.getPart(n,t,"multiple-toolbar").each(function(t){rB.setItems(t,e)})},refreshToolbar:function(n){ZE.getPart(n,t,"toolbar").each(function(t){return t.getApis().refresh(t)})},toggleToolbarDrawer:function(n){ZE.getPart(n,t,"toolbar").each(function(t){var n,e;e=function(n){return n(t)},(n=t.getApis().toggle)!==undefined&&null!==n?ut.some(e(n)):ut.none()})},isToolbarDrawerToggled:function(n){return ZE.getPart(n,t,"toolbar").bind(function(t){return ut.from(t.getApis().isOpen).map(function(n){return n(t)})}).getOr(!1)},getThrobber:function(n){return ZE.getPart(n,t,"throbber")},focusToolbar:function(n){ZE.getPart(n,t,"toolbar").orThunk(function(){return ZE.getPart(n,t,"multiple-toolbar")}).each(function(t){zg.focusIn(t)})},setMenubar:function(n,e){ZE.getPart(n,t,"menubar").each(function(t){PB.setMenus(t,e)})},focusMenubar:function(n){ZE.getPart(n,t,"menubar").each(function(t){PB.focus(t)})}};return{uid:t.uid,dom:t.dom,components:n,apis:e,behaviours:t.behaviours}},configFields:[_e("dom"),_e("behaviours")],partFields:[eD,ZB,nD,tD,oD,rD,iD],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=_t(e,_T);t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=_t(e,function(t){return _t(t,_T)});t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),aD={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},cD=function(t){return"string"==typeof t?t.split(" "):t},sD=function(t,n){var e=et(et({},aD),n.menus),o=0<ln(n.menus).length,r=n.menubar===undefined||!0===n.menubar?cD("file edit view insert format tools table help"):cD(!1===n.menubar?"":n.menubar),i=Bt(r,function(t){return o&&n.menus.hasOwnProperty(t)&&n.menus[t].hasOwnProperty("items")||aD.hasOwnProperty(t)}),u=_t(i,function(o){var r,i,u,a=e[o];return r={title:a.title,items:cD(a.items)},i=n,u=t.getParam("removed_menuitems","").split(/[ ,]/),{text:r.title,getItems:function(){return Rt(r.items,function(t){var n=t.toLowerCase();return 0===n.trim().length||kt(u,function(t){return t===n})?[]:"separator"===n||"|"===n?[{type:"separator"}]:i.menuItems[n]?[i.menuItems[n]]:[]})}}});return Bt(u,function(t){return 0<t.getItems().length&&kt(t.getItems(),function(t){return"separator"!==t.type})})},lD=function(t){var n=function(){t._skinLoaded=!0,t.fire("SkinLoaded")};return function(){t.initialized?n():t.on("init",n)}},fD=function(t,n){return function(){return e={message:n},t.fire("SkinLoadError",e);var e}},dD=function(t,n){var e,o,r,i,u,a,c=(r=(e=n).getParam("skin"),i=e.getParam("skin_url"),!1!==r&&(o=r||"oxide",i=i?e.documentBaseURI.toAbsolute(i):Vv.baseURL+"/skins/ui/"+o),i);c&&(u=c+"/skin.min.css",n.contentCSS.push(c+(t?"/content.inline":"/content")+".min.css")),0==(!1===n.getParam("skin"))&&u?((a=n.ui.styleSheetLoader).load(u,lD(n),fD(n,"Skin could not be loaded")),n.on("remove",function(){return a.unload(u)})):lD(n)()},mD=t(dD,!1),gD=t(dD,!0),pD=function(t,n,e,o){var r,i=n.outerContainer,u=e.toolbar,a=e.buttons;vt(u,st)?(r=u.map(function(n){var r={toolbar:n,buttons:a,allowToolbarGroups:e.allowToolbarGroups};return YE(t,r,{backstage:o},ut.none())}),uD.setToolbars(i,r)):uD.setToolbar(i,YE(t,e,{backstage:o},ut.none()))},hD=xv.DOM,vD=_o(),bD=vD.os.isiOS()&&vD.os.version.major<=12,yD=function(t,n){var e=t.getWin(),o=t.getDoc().documentElement,r=Ke(ea(e.innerWidth,e.innerHeight)),i=Ke(ea(o.offsetWidth,o.offsetHeight)),u=function(){var n=r.get();n.left===e.innerWidth&&n.top===e.innerHeight||(r.set(ea(e.innerWidth,e.innerHeight)),Qb(t))},a=function(){var n=t.getDoc().documentElement,e=i.get();e.left===n.offsetWidth&&e.top===n.offsetHeight||(i.set(ea(n.offsetWidth,n.offsetHeight)),Qb(t))},c=function(n){return e=n,t.fire("ScrollContent",e);var e};hD.bind(e,"resize",u),hD.bind(e,"scroll",c);var s=Ny($e.fromDom(t.getBody()),"load",a),l=n.uiMothership.element;t.on("hide",function(){Du(l,"display","none")}),t.on("show",function(){Pu(l,"display")}),t.on("NodeChange",a),t.on("remove",function(){s.unbind(),hD.unbind(e,"resize",u),hD.unbind(e,"scroll",c)})},xD=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=Ke(0),u=n.outerContainer;mD(t);var a,c,s=$e.fromDom(r.targetNode),l=Su(wu(s));a=s,c=n.mothership,Ul(a,c,di),jl(l,n.uiMothership),t.on("PostRender",function(){pD(t,n,e,o),i.set(t.getWin().innerWidth),uD.setMenubar(u,sD(t,e)),uD.setSidebar(u,e.sidebar),yD(t,n)});var f,d,m,g,p=uD.getSocket(u).getOrDie("Could not find expected socket element");bD&&(Au(p.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"}),d=function(){t.fire("ScrollContent")},m=20,g=null,f={cancel:function(){null!==g&&(clearTimeout(g),g=null)},throttle:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];null===g&&(g=setTimeout(function(){d.apply(null,t),g=null},m))}},zy(p.element,"scroll",f.throttle)),cb(t,n),t.addCommand("ToggleSidebar",function(n,e){uD.toggleSidebar(u,e),t.fire("ToggleSidebar")}),t.addQueryValueHandler("ToggleSidebar",function(){return uD.whichSidebar(u)});var h=Kv(t);return h!==Ih.sliding&&h!==Ih.floating||t.on("ResizeWindow ResizeEditor ResizeContent",function(){var e=t.getWin().innerWidth;e!==i.get()&&(uD.refreshToolbar(n.outerContainer),i.set(e))}),{iframeContainer:p.element.dom,editorContainer:u.element.dom}}}),wD=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?ut.some(parseInt(""+t,10)):ut.none()},SD=function(t){return ht(t)?t+"px":t},kD=function(t,n,e){var o=n.filter(function(n){return t<n}),r=e.filter(function(n){return n<t});return o.or(r).getOr(t)},CD=function(t){var n,e,o,r;return(e=Pv(n=t),o=Nv(n),r=jv(n),wD(e).map(function(t){return kD(t,o,r)})).getOr(Pv(t))},OD=function(t){var n=Hv(t),e=zv(t),o=Lv(t);return wD(n).map(function(t){return kD(t,e,o)})},_D=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=xv.DOM,c=eb(t),s=rb(t),l=Lv(t).or(OD(t)),f=o.shared.header,d=f.isPositionedAtTop,m=Kv(t),g=m===Ih.sliding||m===Ih.floating,p=Ke(!1),h=function(){return p.get()&&!t.removed},v=function(t){return g?t.fold(function(){return 0},function(t){return 1<t.components().length?Zu(t.components()[1].element):0}):0},b=function(){i.broadcastOn([ef()],{})},y=function(t){var e,o,i,a,f,m;void 0===t&&(t=!1),h()&&(c||(e=l.getOrThunk(function(){var t=wD(Fu(_u(),"margin-left")).getOr(0);return aa(_u())-ra(n).left+t}),Du(r.get().element,"max-width",e+"px")),g&&uD.refreshToolbar(u),c||(o=uD.getToolbar(u),i=v(o),a=xa(n),f=d()?Math.max(a.y-Zu(r.get().element)+i,0):a.bottom,Au(u.element,{position:"absolute",top:Math.round(f)+"px",left:Math.round(a.x)+"px"})),s&&(m=r.get(),t?EB.reset(m):EB.refresh(m)),b())},x=function(e){var o,i;void 0===e&&(e=!0),!c&&s&&h()&&(o=f.getDockingMode(),(i=function(e){switch(Zv(t)){case Yv.auto:var o=uD.getToolbar(u),r=v(o),i=Zu(e.element)-r,a=xa(n);if(a.y>i)return"top";var c=ri(n),s=Math.max(c.dom.scrollHeight,Zu(c));return a.bottom<s-i||Sa().bottom<a.bottom-i?"bottom":"top";case Yv.bottom:return"bottom";case Yv.top:default:return"top"}}(r.get()))!==o&&(function(t){var n=r.get();EB.setModes(n,[t]),f.setDockingMode(t);var e=d()?Fa.TopToBottom:Fa.BottomToTop;Si(n.element,xs,e)}(i),e&&y(!0)))};return{isVisible:h,isPositionedAtTop:d,show:function(){p.set(!0),Du(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),Pu(i.element,"display"),x(!1),y()},hide:function(){p.set(!1),e.outerContainer&&(Du(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),Du(i.element,"display","none")},update:y,updateMode:x,repositionPopups:b}},TD=function(t,n){var e=xa(t);return{pos:n?e.y:e.bottom,bounds:e}},ED=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=Ke(null),s=$e.fromDom(r.targetNode),l=_D(t,s,n,o,c),f=t.getParam("toolbar_persist",!1,"boolean");gD(t);var d=function(){var r,d;c.get()?l.show():(c.set(uD.getHeader(a).getOrDie()),r=nb(d=t).getOrThunk(function(){return Su(wu($e.fromDom(d.getElement())))}),jl(r,i),jl(r,u),pD(t,n,e,o),uD.setMenubar(a,sD(t,e)),l.show(),function(t,n,e,o){var r=Ke(TD(n,e.isPositionedAtTop())),i=function(o){var i=TD(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,l=c.bounds,f=a.height!==l.height||a.width!==l.width;r.set({pos:u,bounds:a}),f&&Qb(t,o),e.isVisible()&&(s!==u?e.update(!0):f&&(e.updateMode(),e.repositionPopups()))};o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",function(){return e.update(!0)}),t.on("NodeChange keydown",function(t){Gp.requestAnimationFrame(function(){return i(t)})}),t.on("ScrollWindow",function(){return e.updateMode()});var u=VE();u.set(Ny($e.fromDom(t.getBody()),"load",i)),t.on("remove",function(){u.clear()})}(t,s,l,f),t.nodeChanged())};t.on("show",d),t.on("hide",l.hide),f||(t.on("focus",d),t.on("blur",l.hide)),t.on("init",function(){(t.hasFocus()||f)&&d()}),cb(t,n);var m={show:function(){l.show()},hide:function(){l.hide()}};return{editorContainer:a.element.dom,api:m}}}),BD=function(t,n){var e,o,r,i,u,a,c,s,l,f,d,m,g,p;r=pE(0,o=n,OE(e=t)),e.ui.registry.addNestedMenuItem("align",{text:o.shared.providers.translate("Align"),getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}}),a=pE(0,u=n,BE(i=t)),i.ui.registry.addNestedMenuItem("fontformats",{text:u.shared.providers.translate("Fonts"),getSubmenuItems:function(){return a.items.validateItems(a.getStyleItems())}}),c=t,l=et({type:"advanced"},(s=n).styleselect),f=pE(0,s,NE(c,l)),c.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return f.items.validateItems(f.getStyleItems())}}),m=pE(0,n,zE(d=t)),d.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return m.items.validateItems(m.getStyleItems())}}),p=pE(0,n,ME(g=t)),g.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return p.items.validateItems(p.getStyleItems())}})},DD=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},AD=function(t){var n,e;!function(t){oO.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:PE(t,n.name),onAction:DD(t,n.name)})});for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:PE(t,e),onAction:DD(t,e)})}}(t),n=t,oO.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})}),e=t,oO.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],function(t){e.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return e.execCommand(t.action)},onSetup:PE(e,t.name)})})},MD=function(t){var n;AD(t),n=t,oO.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})}),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:DD(n,"code")})},FD=function(t,n,e){var o=function(){return!!n.undoManager&&n.undoManager[e]()},r=function(){t.setDisabled(n.mode.isReadOnly()||!o())};return t.setDisabled(!o()),n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return n.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},ID=function(t){var n,e;(n=t).ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return FD(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return FD(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}}),(e=t).ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return FD(t,e,"hasUndo")},onAction:function(){return e.execCommand("undo")}}),e.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return FD(t,e,"hasRedo")},onAction:function(){return e.execCommand("redo")}})},RD={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},VD=(bE="[eE][+-]?[0-9]+",xE=["Infinity",(vE="[0-9]+")+"\\."+(yE=function(t){return"(?:"+t+")?"})(vE)+yE(bE),"\\."+vE+yE(bE),vE+yE(bE)].join("|"),new RegExp("^([+-]?(?:"+xE+"))(.*)$")),PD=function(t,n){return ut.from(VD.exec(t)).bind(function(t){var e,o=Number(t[1]),r=t[2];return e=r,kt(n,function(t){return kt(RD[t],function(t){return e===t})})?ut.some({value:o,unit:r}):ut.none()})},HD=function(t){return PD(t,["fixed","relative","empty"]).map(function(t){return t.value+t.unit}).getOr(t)},zD=function(t){var n=t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" "),e=new Map,o=RE(function(t){return t.destroy()}),r=function(){var n=HD(t.queryCommandValue("LineHeight"));ut.from(e.get(n)).fold(function(){return o.clear()},function(t){o.set({destroy:function(){t.setActive(!1)}}),t.setActive(!0)})};return t.on("nodeChange",r),_t(n,function(i,u){return{type:"togglemenuitem",text:i,onSetup:function(a){return e.set(HD(i),a),u+1===n.length&&r(),function(){0===u&&(t.off("nodeChange",r),o.clear())}},onAction:function(){return t.execCommand("LineHeight",!1,i)}}})},ND=function(t){var n,e;(n=t).ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return zD(n)}}),(e=t).ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(zD(e))}})},LD=function(t,n){var e,o,r,i;!function(t){oO.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,onAction:function(){return t.execCommand(n.cmd)},icon:n.icon,onSetup:PE(t,n.name)})});var n="alignnone",e="No alignment",o="JustifyNone",r="align-none";t.ui.registry.addButton(n,{tooltip:e,onAction:function(){return t.execCommand(o)},icon:r})}(t),MD(t),BD(t,n),ID(t),function(t){ay(t);var n=Ke(null),e=Ke(null);my(t,"forecolor","forecolor","Text color",n),my(t,"backcolor","hilitecolor","Background color",e),gy(t,"forecolor","forecolor","Text color"),gy(t,"backcolor","hilitecolor","Background color")}(t),(o=e=t).ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return o.execCommand("mceToggleVisualAid")}}),(r=e).ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return function(t,n){t.setActive(n.hasVisual);var e=function(n){t.setActive(n.hasVisual)};return n.on("VisualAid",e),function(){return n.off("VisualAid",e)}}(t,r)},onAction:function(){r.execCommand("mceToggleVisualAid")}}),(i=t).ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(t,n){t.setDisabled(!n.queryCommandState("outdent"));var e=function(){t.setDisabled(!n.queryCommandState("outdent"))};return n.on("NodeChange",e),function(){return n.off("NodeChange",e)}}(t,i)},onAction:function(){return i.execCommand("outdent")}}),i.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return i.execCommand("indent")}}),ND(t)},jD=function(t,n){return{anchor:"makeshift",x:t,y:n}},UD=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},WD=function(t,n){var e,o,r,i=xv.DOM.getPos(t);return e=n,o=i.x,r=i.y,jD(e.x+o,e.y+r)},GD=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(UD(t)){var n=t.touches[0];return jD(n.pageX,n.pageY)}return jD(t.pageX,t.pageY)}(n):WD(t.getContentAreaContainer(),function(t){if(UD(t)){var n=t.touches[0];return jD(n.clientX,n.clientY)}return jD(t.clientX,t.clientY)}(n)):XD(t)},XD=function(t){return{anchor:"selection",root:$e.fromDom(t.selection.getNode())}},YD=function(t){return{anchor:"node",node:ut.some($e.fromDom(t.selection.getNode())),root:$e.fromDom(t.getBody())}},qD=function(t,n,e,o,r,i){var u=e(),a=i?YD(t):GD(t,n);TC(u,Vh.CLOSE_ON_EXECUTE,o,!1).map(function(t){n.preventDefault(),Fp.showMenuAt(r,a,{menu:{markers:Yh("normal")},data:t})})},KD={onLtr:function(){return[wc,hc,vc,bc,yc,xc,Up,Wp,Lp,zp,jp,Np]},onRtl:function(){return[wc,vc,hc,yc,bc,xc,Up,Wp,jp,Np,Lp,zp]}},JD={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},$D=function(t,n,e,o,r,i,u){var a,c,s=i?YD(t):(a=t,c=n,et({bubble:hs(0,12,JD),layouts:KD,overrides:{maxWidthFunction:A_(),maxHeightFunction:fs()}},GD(a,c)));TC(e,Vh.CLOSE_ON_EXECUTE,o,!0).map(function(e){n.preventDefault(),Fp.showMenuWithinBounds(r,s,{menu:{markers:Yh("normal"),highlightImmediately:u},data:e,type:"horizontal"},function(){return ut.some(uE(t,o.shared))}),t.fire(M_)})},QD=function(t,n,e,o,r,i){var u,a=_o(),c=a.os.isiOS(),s=a.os.isOSX(),l=a.os.isAndroid(),f=a.deviceType.isTouch(),d=function(){var u=e();$D(t,n,u,o,r,i,!(l||c||s&&f))};!s&&!c||i?(l&&!i&&t.selection.setCursorLocation(n.target,0),d()):(u=function(){!function(t){var n=t.selection.getRng(),e=function(){Gp.setEditorTimeout(t,function(){t.selection.setRng(n)},10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}}(t),d()},function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],r=e.getRng();return Qs(t.getWin(),Ds.domRange(r)).exists(function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY})}(t,n)?u():(t.once("selectionchange",u),t.once("touchend",function(){return t.off("selectionchange",u)})))},ZD=function(t){return"string"==typeof t?t.split(/[ ,]/):t},tA=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},nA=function(t){return e="contextmenu",o="link linkchecker image imagetools table spellchecker configurepermanentpen",r=(n=t).ui.registry.getAll().contextMenus,ut.from(n.getParam(e)).map(ZD).getOrThunk(function(){return Bt(ZD(o),function(t){return xn(r,t)})});var n,e,o,r},eA=function(t){return st(t)?"|"===t:"separator"===t.type},oA={type:"separator"},rA=function(t){if(st(t))return t;switch(t.type){case"separator":return oA;case"submenu":return{type:"nestedmenuitem",text:t.text,icon:t.icon,getSubmenuItems:function(){var n=t.getSubmenuItems();return st(n)?n:_t(n,rA)}};default:return{type:"menuitem",text:t.text,icon:t.icon,onAction:(n=t.onAction,function(){return n()})}}var n},iA=function(t,n){if(0===n.length)return t;var e=Lt(t).filter(function(t){return!eA(t)}).fold(function(){return[]},function(){return[oA]});return t.concat(e).concat(n).concat([oA])},uA=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},aA=function(t,n){return uA(t,n)?t.selection.getStart(!0):n.target},cA=function(t,n,e){var o=_o().deviceType.isTouch,r=Ju(Fp.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:Pc([Gg("dismissContextMenu",[zr(Sr(),function(n){tf.close(n),t.focus()})])])})),i=function(){return Fp.hide(r)},u=function(n){var i,u;tA(t)&&n.preventDefault(),i=t,n.ctrlKey&&!tA(i)||!1===t.getParam("contextmenu")||(u=function(t,n){var e=t.getParam("contextmenu_avoid_overlap","","string");if(uA(t,n))return!0;if(e){var o=aA(t,n);return jy($e.fromDom(o),e)}return!1}(t,n),(o()?QD:qD)(t,n,function(){var e,o,r,i=aA(t,n),u=t.ui.registry.getAll(),a=nA(t);return e=u.contextMenus,o=i,0<(r=At(a,function(t,n){if(xn(e,n)){var r=e[n].update(o);if(st(r))return iA(t,r.split(" "));if(0<r.length){var i=_t(r,rA);return iA(t,i)}return t}return t.concat([n])},[])).length&&eA(r[r.length-1])&&r.pop(),r},e,r,u))};t.on("init",function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");t.on(n,i),t.on("longpress contextmenu",u)})},sA=Sn([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),lA=function(t){return function(n){return n.translate(-t.left,-t.top)}},fA=function(t){return function(n){return n.translate(t.left,t.top)}},dA=function(t){return function(n,e){return At(t,function(t,n){return n(t)},ea(n,e))}},mA=function(t,n,e){return t.fold(dA([fA(e),lA(n)]),dA([lA(n)]),dA([]))},gA=function(t,n,e){return t.fold(dA([fA(e)]),dA([]),dA([fA(n)]))},pA=function(t,n,e){return t.fold(dA([]),dA([lA(e)]),dA([fA(n),lA(e)]))},hA=function(t,n,e){var o=t.fold(function(t,n){return{position:ut.some("absolute"),left:ut.some(t+"px"),top:ut.some(n+"px")}},function(t,n){return{position:ut.some("absolute"),left:ut.some(t-e.left+"px"),top:ut.some(n-e.top+"px")}},function(t,n){return{position:ut.some("fixed"),left:ut.some(t+"px"),top:ut.some(n+"px")}});return et({right:ut.none(),bottom:ut.none()},o)},vA=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return t.fold(r(pA,bA),r(gA,yA),r(mA,xA))},bA=sA.offset,yA=sA.absolute,xA=sA.fixed,wA=function(t,n){var e=ki(t,n);return mt(e)?NaN:parseInt(e,10)},SA=function(t,n,e,o){return r=n,i=t.element,u=wA(i,r.leftAttr),a=wA(i,r.topAttr),(isNaN(u)||isNaN(a)?ut.none():ut.some(ea(u,a))).fold(function(){return e},function(t){return xA(t.left+o.left,t.top+o.top)});var r,i,u,a},kA=function(t,n,e,o,r,i){var u,a,c,s=SA(t,n,e,o),l=(n.mustSnap?_A:TA)(t,n,s,r,i),f=mA(s,r,i);return u=n,a=f,c=t.element,Si(c,u.leftAttr,a.left+"px"),Si(c,u.topAttr,a.top+"px"),l.fold(function(){return{coord:xA(f.left,f.top),extra:ut.none()}},function(t){return{coord:t.output,extra:t.extra}})},CA=function(t,n){var e,o;e=n,o=t.element,_i(o,e.leftAttr),_i(o,e.topAttr)},OA=function(t,n,e,o){return Ut(t,function(t){var r,i,u,a,c,s,l,f,d=t.sensor;return r=n,i=d,u=t.range.left,a=t.range.top,l=gA(r,c=e,s=o),f=gA(i,c,s),Math.abs(l.left-f.left)<=u&&Math.abs(l.top-f.top)<=a?ut.some({output:vA(t.output,n,e,o),extra:t.extra}):ut.none()})},_A=function(t,n,e,o,r){var i=n.getSnapPoints(t);return OA(i,e,o,r).orThunk(function(){return At(i,function(t,n){var i,u,a,c,s,l,f,d,m=n.sensor,g=(i=e,u=m,n.range.left,n.range.top,s=gA(i,a=o,c=r),l=gA(u,a,c),f=Math.abs(s.left-l.left),d=Math.abs(s.top-l.top),ea(f,d));return t.deltas.fold(function(){return{deltas:ut.some(g),snap:ut.some(n)}},function(e){return(g.left+g.top)/2<=(e.left+e.top)/2?{deltas:ut.some(g),snap:ut.some(n)}:t})},{deltas:ut.none(),snap:ut.none()}).snap.map(function(t){return{output:vA(t.output,e,o,r),extra:t.extra}})})},TA=function(t,n,e,o,r){var i=n.getSnapPoints(t);return OA(i,e,o,r)},EA=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r,i,u,a,c,s,l,f=n.getTarget(t.element);n.repositionTarget&&(r=ei(t.element),s=da(r),l=i=lB(f),u={coord:vA((c=o).output,c.output,s,l),extra:c.extra},a=hA(u.coord,0,i),Mu(f,a))}}),BA="data-initial-z-index",DA=function(t,n){var e;t.getSystem().addToGui(n),ui((e=n).element).filter(Qr).each(function(t){Ru(t,"z-index").each(function(n){Si(t,BA,n)}),Du(t,"z-index",Fu(e.element,"z-index"))})},AA=function(t){ui(t.element).filter(Qr).each(function(t){Ci(t,BA).fold(function(){return Pu(t,"z-index")},function(n){return Du(t,"z-index",n)}),_i(t,BA)}),t.getSystem().removeFromGui(t)},MA=function(t,n,e){return t.getSystem().build(ex.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},FA=ze("snaps",[_e("getSnapPoints"),Xa("onSensor"),_e("leftAttr"),_e("topAttr"),Ne("lazyViewport",Sa),Ne("mustSnap",!1)]),IA=[Ne("useFixed",Z),_e("blockerClass"),Ne("getTarget",J),Ne("onDrag",Y),Ne("repositionTarget",!0),Ne("onDrop",Y),Xe("getBounds",Sa),FA],RA=function(t){return n=Ru(t,"left"),e=Ru(t,"top"),o=Ru(t,"position"),r=function(t,n,e){return("fixed"===e?xA:bA)(parseInt(t,10),parseInt(n,10))},(n.isSome()&&e.isSome()&&o.isSome()?ut.some(r(n.getOrDie(),e.getOrDie(),o.getOrDie())):ut.none()).getOrThunk(function(){var n=ra(t);return yA(n.left,n.top)});var n,e,o,r},VA=function(t,n,e,o,r,i,u){var a,c,s,l,f,d,m,g,p,h=n.fold(function(){var t,n,u,a=(t=e,n=i.left,u=i.top,t.fold(function(t,e){return bA(t+n,e+u)},function(t,e){return yA(t+n,e+u)},function(t,e){return xA(t+n,e+u)})),c=mA(a,o,r);return xA(c.left,c.top)},function(n){var u=kA(t,n,e,i,o,r);return u.extra.each(function(e){n.onSensor(t,e)}),u.coord});return a=h,c=o,s=r,f=(l=u).bounds,d=gA(a,c,s),m=rs(d.left,f.x,f.x+f.width-l.width),g=rs(d.top,f.y,f.y+f.height-l.height),p=yA(m,g),a.fold(function(){var t=pA(p,c,s);return bA(t.left,t.top)},function(){return p},function(){var t=mA(p,c,s)
;return xA(t.left,t.top)})},PA=function(t,n){return{bounds:t.getBounds(),height:ta(n.element),width:ca(n.element)}},HA=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk(function(){return PA(n,t)});i.each(function(e){var o,r,i,a,c,s,l,f,d,m,g;o=t,i=u,a=e,g=(r=n).getTarget(o.element),r.repositionTarget&&(c=ei(o.element),s=da(c),l=lB(g),f=RA(g),d=VA(o,r.snaps,f,s,l,a,i),m=hA(d,0,l),Mu(g,m)),r.onDrag(o,g,a)})},zA=function(t,n,e,o){n.each(AA),e.snaps.each(function(n){CA(t,n)});var r=e.getTarget(t.element);o.reset(),e.onDrop(t,r)},NA=function(t){return function(n,o){var r=function(t){o.setStartData(PA(n,t))};return Vr(e([zr(br(),function(t){o.getStartData().each(function(){return r(t)})})],t(n,o,r)))}},LA=Object.freeze({__proto__:null,getData:function(t){return ut.from(ea(t.x,t.y))},getDelta:function(t,n){return ea(n.left-t.left,n.top-t.top)}}),jA=function(t,n,e){return[zr(Uo(),function(o,r){var i,a,c,s,l;0===r.event.raw.button&&(r.stop(),c={drop:i=function(){return zA(o,ut.some(s),t,n)},delayDrop:(a=u(i,200)).schedule,forceDrop:i,move:function(e){a.cancel(),HA(o,t,n,LA,e)}},s=MA(o,t.blockerClass,(l=c,Vr([zr(Uo(),l.forceDrop),zr(Xo(),l.drop),zr(Wo(),function(t,n){l.move(n.event)}),zr(Go(),l.delayDrop)]))),e(o),DA(o,s))})]},UA=e(IA,[Ja("dragger",{handlers:NA(jA)})]),WA=Object.freeze({__proto__:null,getData:function(t){var n,e=t.raw.touches;return 1===e.length?(n=e[0],ut.some(ea(n.clientX,n.clientY))):ut.none()},getDelta:function(t,n){return ea(n.left-t.left,n.top-t.top)}}),GA=function(t,n,e){var o=Ke(ut.none());return[zr(zo(),function(r,i){i.stop();var u,a=function(){zA(r,o.get(),t,n),o.set(ut.none())},c={drop:a,delayDrop:function(){},forceDrop:a,move:function(e){HA(r,t,n,WA,e)}},s=MA(r,t.blockerClass,(u=c,Vr([zr(zo(),u.forceDrop),zr(Lo(),u.drop),zr(jo(),u.drop),zr(No(),function(t,n){u.move(n.event)})])));o.set(ut.some(s)),e(r),DA(r,s)}),zr(No(),function(e,o){o.stop(),HA(e,t,n,WA,o.event)}),zr(Lo(),function(e,r){r.stop(),zA(e,o.get(),t,n),o.set(ut.none())}),zr(jo(),function(e){zA(e,o.get(),t,n),o.set(ut.none())})]},XA=e(IA,[Ja("dragger",{handlers:NA(GA)})]),YA=e(IA,[Ja("dragger",{handlers:NA(function(t,n,o){return e(jA(t,n,o),GA(t,n,o))})})]),qA=Lc({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:UA,touch:XA,mouseOrTouch:YA}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:ut.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var t=ut.none(),n=ut.none(),e=K({});return Ki({readState:e,reset:function(){t=ut.none(),n=ut.none()},update:function(n,e){return n.getData(e).bind(function(e){return o=n,r=e,i=t.map(function(t){return o.getDelta(t,r)}),t=ut.some(r),i;var o,r,i})},getStartData:function(){return n},setStartData:function(t){n=ut.some(t)}})}}),apis:EA}),KA=function(t,n,e,o,r,i){return t.fold(function(){return qA.snap({sensor:yA(e-20,o-20),range:ea(r,i),output:yA(ut.some(e),ut.some(o)),extra:{td:n}})},function(t){var r=e-20,i=o-20,u=t.element.dom.getBoundingClientRect();return qA.snap({sensor:yA(r,i),range:ea(40,40),output:yA(ut.some(e-u.width/2),ut.some(o-u.height/2)),extra:{td:n}})})},JA=function(t,n,e){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var r,i,u=o.td;r=n.get(),i=u,r.exists(function(t){return Bo(t,i)})||(n.set(ut.some(u)),e(u))},mustSnap:!0}},$A=function(t){return Yp(Xp.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:Pc([qA.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),Ow.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},QA=function(t,n){var e=Ke([]),o=Ke([]),r=Ke(!1),i=Ke(ut.none()),u=Ke(ut.none()),a=function(t){var e=wa(t);return KA(f.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(t){var e=wa(t);return KA(d.getOpt(n),t,e.right,e.bottom,e.width,e.height)},s=JA(function(){return _t(e.get(),a)},i,function(n){u.get().each(function(e){t.fire("TableSelectorChange",{start:n,finish:e})})}),l=JA(function(){return _t(o.get(),c)},u,function(n){i.get().each(function(e){t.fire("TableSelectorChange",{start:e,finish:n})})}),f=$A(s),d=$A(l),m=Ju(f.asSpec()),g=Ju(d.asSpec()),p=function(n,e,o,r){var i=o(e);qA.snapTo(n,i),function(n,e,o,r){var i=e.dom.getBoundingClientRect();Pu(n.element,"display");var u=ii($e.fromDom(t.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&Du(n.element,"display","none")}(n,e,function(t){return t[r]<0},function(t,n){return t[r]>n})},h=function(t){return p(m,t,a,"top")},v=function(t){return p(g,t,c,"bottom")};_o().deviceType.isTouch()&&(t.on("TableSelectionChange",function(t){r.get()||(Pl(n,m),Pl(n,g),r.set(!0)),i.set(ut.some(t.start)),u.set(ut.some(t.finish)),t.otherCells.each(function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),h(t.start),v(t.finish)})}),t.on("ResizeEditor ResizeWindow ScrollContent",function(){i.get().each(h),u.get().each(v)}),t.on("TableSelectionClear",function(){r.get()&&(Nl(m),Nl(g),r.set(!1)),i.set(ut.none()),u.set(ut.none())}))};(SE=wE=wE||{})[SE.None=0]="None",SE[SE.Both=1]="Both",SE[SE.Vertical=2]="Vertical";var ZA,tM,nM,eM=function(t,n,e){var o,r,i,u,a,c,s=$e.fromDom(t.getContainer()),l=(o=t,r=n,i=e,u=Zu(s),a=aa(s),(c={}).height=kD(u+r.top,Nv(o),jv(o)),i===wE.Both&&(c.width=kD(a+r.left,zv(o),Lv(o))),c);dn(l,function(t,n){return Du(s,n,SD(t))}),t.fire("ResizeEditor")},oM=function(t,n,e){return n.delimiter||(n.delimiter="\xbb"),{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:Pc([zg.config({mode:"flow",selector:"div[role=button]"}),Rv.config({disabled:e.isReadOnly}),sb(),sx.config({}),Wg.config({}),Gg("elementPathEvents",[Xr(function(o){t.shortcuts.add("alt+F11","focus statusbar elementpath",function(){return zg.focusIn(o)}),t.on("NodeChange",function(r){var i,u,a=function(n){for(var e=[],o=n.length;0<o--;){var r=n[o];if(1===r.nodeType&&!function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1}(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e}(r.parents);0<a.length?Wg.set(o,(i=_t(a||[],function(n,o){return Xp.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:Pc([fb(e.isReadOnly),sb()])})}),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}},At(i.slice(1),function(t,n){var e=t;return e.push(u),e.push(n),e},[i[0]]))):Wg.set(o,[])})})])]),components:[]}},rM=function(t,n){var e,o,r,i,u,a;return{dom:{tag:"div",classes:["tox-statusbar"]},components:(u=function(){var e,o,r,i,u,a=[];return t.getParam("elementpath",!0,"boolean")&&a.push(oM(t,{},n)),t.hasPlugin("wordcount")&&a.push((e=t,o=n,i=function(t,n,e){return Wg.set(t,[Yu(o.translate(["{0} "+e,n[e]]))])},Xp.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:Pc([fb(o.isReadOnly),sb(),sx.config({}),Wg.config({}),wf.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),Gg("wordcount-events",[Kr(function(t){var n=wf.getValue(t),e="words"===n.mode?"characters":"words";wf.setValue(t,{mode:e,count:n.count}),i(t,n.count,e)}),Xr(function(t){e.on("wordCountUpdate",function(n){var e=wf.getValue(t).mode;wf.setValue(t,{mode:e,count:n.wordCount}),i(t,n.wordCount,e)})})])]),eventOrder:((r={})[sr()]=["disabling","alloy.base.behaviour","wordcount-events"],r)}))),t.getParam("branding",!0,"boolean")&&a.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(u=wv.translate(["Powered by {0}","Tiny"]))+'">'+u+"</a>"}}),0<a.length?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:a}]:[]}(),o=!(e=t).hasPlugin("autoresize"),(a=!1===(r=e.getParam("resize",o))?wE.None:"both"===r?wE.Both:wE.Vertical)!==wE.None&&u.push((i=a,{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize"),"aria-hidden":"true"},innerHtml:Kp("resize-handle",n.icons)},behaviours:Pc([qA.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,e,o){eM(t,o,i)},blockerClass:"tox-blocker"})])})),u)}},iM=function(t){var n,e=t.inline,o=e?ED:xD,r=rb(t)?VB:cB,i=ut.none(),u=_o(),a=u.browser.isIE()?["tox-platform-ie"]:[],c=u.deviceType.isTouch()?["tox-platform-touch"]:[],s=tb(t),l=wv.isRtl()?{attributes:{dir:"rtl"}}:{},f={attributes:((n={})[xs]=s?Fa.BottomToTop:Fa.TopToBottom,n)},d=function(){return i.bind(uD.getHeader)},m=Ju({dom:et({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(a).concat(c)},l),behaviours:Pc([Ml.config({useFixed:function(){return r.isDocked(d)}})])}),g=function(){return Xt.value(m)},p=Yp({dom:{tag:"div",classes:["tox-anchorbar"]}}),h=function(){return i.bind(function(t){return uD.getThrobber(t)}).getOrDie("Could not find throbber element")},v=D_(m,t,function(){return i.bind(function(t){return p.getOpt(t)}).getOrDie("Could not find a anchor bar element")}),b=uD.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:v,onEscape:function(){t.focus()}}),y=Kv(t),x=uD.parts.toolbar(et({dom:{tag:"div",classes:["tox-toolbar"]},getSink:g,providers:v.shared.providers,onEscape:function(){t.focus()},type:y,lazyToolbar:function(){return i.bind(function(t){return uD.getToolbar(t)}).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return d().getOrDie("Could not find header element")}},f)),w=uD.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:v.shared.providers,onEscape:function(){t.focus()},type:y}),S=uD.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),k=uD.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),C=uD.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:v}),O=t.getParam("statusbar",!0,"boolean")&&!e?ut.some(rM(t,v.shared.providers)):ut.none(),_={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[S,k]},T=Xv(t),E=Wv(t),B=Uv(t),D=uD.parts.header({dom:et({tag:"div",classes:["tox-editor-header"]},f),components:It([B?[b]:[],T?[w]:E?[x]:[],eb(t)?[]:[p.asSpec()]]),sticky:rb(t),editor:t,sharedBackstage:v.shared}),A=It([s?[]:[D],e?[]:[_],s?[D]:[]]),M=It([[{dom:{tag:"div",classes:["tox-editor-container"]},components:A}],e?[]:O.toArray(),[C]]),F=ob(t),I=et(et({role:"application"},wv.isRtl()?{dir:"rtl"}:{}),F?{"aria-hidden":"true"}:{}),R=Ju(uD.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(s?["tox-tinymce--toolbar-bottom"]:[]).concat(c).concat(a),styles:et({visibility:"hidden"},F?{opacity:"0",border:"0"}:{}),attributes:I},components:M,behaviours:Pc([zg.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));i=ut.some(R);t.shortcuts.add("alt+F9","focus menubar",function(){uD.focusMenubar(R)}),t.shortcuts.add("alt+F10","focus toolbar",function(){uD.focusToolbar(R)}),t.addCommand("ToggleToolbarDrawer",function(){uD.toggleToolbarDrawer(R)}),t.addQueryStateHandler("ToggleToolbarDrawer",function(){return uD.isToolbarDrawerToggled(R)});var V,P,H,z,N,L,j,U,W,G,X,Y,q,K,J,$,Q=ox(R),Z=ox(m);V=t,P=Q,H=Z,z=function(t,n){Tt([P,H],function(e){e.broadcastEvent(t,n)})},N=function(t,n){Tt([P,H],function(e){e.broadcastOn([t],n)})},L=function(t){return N(nf(),{target:t.target})},j=zy($e.fromDom(document),"touchstart",L),U=zy($e.fromDom(document),"touchmove",function(t){return z(hr(),t)}),W=zy($e.fromDom(document),"touchend",function(t){return z(vr(),t)}),G=zy($e.fromDom(document),"mousedown",L),X=zy($e.fromDom(document),"mouseup",function(t){0===t.raw.button&&N(of(),{target:t.target})}),Y=function(t){return N(nf(),{target:$e.fromDom(t.target)})},q=function(t){0===t.button&&N(of(),{target:$e.fromDom(t.target)})},K=function(t){return z(br(),Ly(t))},J=function(t){N(ef(),{}),z(yr(),Ly(t))},$=function(){return N(ef(),{})},V.on("PostRender",function(){V.on("click",Y),V.on("tap",Y),V.on("mouseup",q),V.on("ScrollWindow",K),V.on("ResizeWindow",J),V.on("ResizeEditor",$)}),V.on("remove",function(){V.off("click",Y),V.off("tap",Y),V.off("mouseup",q),V.off("ScrollWindow",K),V.off("ResizeWindow",J),V.off("ResizeEditor",$),G.unbind(),j.unbind(),U.unbind(),W.unbind(),X.unbind()}),V.on("detach",function(){Wl(P),Wl(H),P.destroy(),H.destroy()});var tt=function(){var n,e=SD(CD(t)),o=SD(OD(n=t).getOr(Hv(n)));return t.inline||(Vu("div","width",o)&&Du(R.element,"width",o),Vu("div","height",e)?Du(R.element,"height",e):Du(R.element,"height","200px")),e};return{mothership:Q,uiMothership:Z,backstage:v,renderUI:function(){var n,e,i,u,a,c,s,l;r.setup(t,v.shared,d),LD(t,v),cA(t,g,v),e=(n=t).ui.registry.getAll().sidebars,Tt(ln(e),function(t){var o=e[t],r=function(){return ut.from(n.queryCommandValue("ToggleSidebar")).is(t)};n.ui.registry.addToggleButton(t,{icon:o.icon,tooltip:o.tooltip,onAction:function(e){n.execCommand("ToggleSidebar",!1,t),e.setActive(r())},onSetup:function(t){var e=function(){return t.setActive(r())};return n.on("ToggleSidebar",e),function(){n.off("ToggleSidebar",e)}}})}),i=t,u=h,a=v.shared,c=Ke(!1),s=Ke(ut.none()),l=function(t){t!==c.get()&&(QB(u(),t,a.providers),c.set(t))},i.on("ProgressState",function(t){var n;s.get().each(Gp.clearTimeout),ht(t.time)?(n=Gp.setEditorTimeout(i,function(){return l(t.state)},t.time),s.set(ut.some(n))):(l(t.state),s.set(ut.none()))}),mn(t.getParam("toolbar_groups",{},"object"),function(n,e){t.ui.registry.addGroupToolbarButton(e,n)});var f,p=t.ui.registry.getAll(),b=p.buttons,x=p.menuItems,w=p.contextToolbars,S=p.sidebars,k=Gv(t),C={menuItems:x,menus:(f=t.getParam("menu"))?mn(f,function(t){return et(et({},t),{items:t.items})}):{},menubar:t.getParam("menubar"),toolbar:k.getOrThunk(function(){return t.getParam("toolbar",!0)}),allowToolbarGroups:y===Ih.floating,buttons:b,sidebar:S};QE(t,w,m,{backstage:v}),QA(t,m);var O=t.getElement(),_=tt(),T={mothership:Q,uiMothership:Z,outerContainer:R},E={targetNode:O,height:_};return o.render(t,T,C,v,E)},getUi:function(){return{channels:{broadcastAll:Z.broadcast,broadcastOn:Z.broadcastOn,register:function(){}}}}}},uM=K([_e("lazySink"),Ie("dragBlockClass"),Xe("getBounds",Sa),Ne("useTabstopAt",tt),Ne("eventOrder",{}),Sf("modalBehaviours",[zg]),Ya("onExecute"),Ka("onEscape")]),aM={sketch:J},cM=K([Zf({name:"draghandle",overrides:function(t,n){return{behaviours:Pc([qA.config({mode:"mouse",getTarget:function(t){return _a(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),$f({schema:[_e("dom")],name:"title"}),$f({factory:aM,schema:[_e("dom")],name:"close"}),$f({factory:aM,schema:[_e("dom")],name:"body"}),Zf({factory:aM,schema:[_e("dom")],name:"footer"}),Qf({factory:{sketch:function(t,n){return et(et({},t),{dom:n.dom,components:n.components})}},schema:[Ne("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Ne("components",[])],name:"blocker"})]),sM=_d({name:"ModalDialog",configFields:uM(),partFields:cM(),factory:function(t,n,e,o){var r,i=Mi("alloy.dialog.busy"),u=Mi("alloy.dialog.idle"),a=Pc([zg.config({mode:"special",onTab:function(){return ut.some(!0)},onShiftTab:function(){return ut.some(!0)}}),Jg.config({})]),c=Mi("modal-events"),s=et(et({},t.eventOrder),((r={})[xr()]=[c].concat(t.eventOrder["alloy.system.attached"]||[]),r));return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){var e=t.lazySink(n).getOrDie(),r=Ke(ut.none()),c=o.blocker(),s=e.getSystem().build(et(et({},c),{components:c.components.concat([$u(n)]),behaviours:Pc([Jg.config({}),Gg("dialog-blocker-events",[Gr(qo(),function(){zg.focusIn(n)}),zr(u,function(){Oi(n.element,"aria-busy")&&(_i(n.element,"aria-busy"),r.get().each(function(t){return Wg.remove(n,t)}))}),zr(i,function(t,e){Si(n.element,"aria-busy","true");var o=e.event.getBusySpec;r.get().each(function(t){Wg.remove(n,t)});var i=o(n,a),u=t.getSystem().build(i);r.set(ut.some(u)),Wg.append(n,$u(u)),u.hasConfigured(zg)&&zg.focusIn(u)})])])}));Pl(e,s),zg.focusIn(n)},hide:function(t){ui(t.element).each(function(n){t.getSystem().getByDom(n).each(function(t){Nl(t)})})},getBody:function(n){return dd(n,t,"body")},getFooter:function(n){return dd(n,t,"footer")},setIdle:function(t){Dr(t,u)},setBusy:function(t,n){Ar(t,i,{getBusySpec:n})}},eventOrder:s,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Cf(t.modalBehaviours,[Wg.config({}),zg.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),Gg(c,[Xr(function(n){var e,o,r,i,u,a;e=n.element,o=dd(n,t,"title").element,r=Ci(e,"id").fold(function(){var t=Mi("dialog-label");return Si(o,"id",t),t},J),Si(e,"aria-labelledby",r),i=n.element,u=dd(n,t,"body").element,a=ut.from(ki(i,"id")).fold(function(){var t=Mi("dialog-describe");return Si(u,"id",t),t},J),Si(i,"aria-describedby",a)})])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),lM=Jn([Ee("type"),Ee("name")].concat(ov)),fM=we,dM=[oe("name","name",Mn(function(){return Mi("button-name")}),xe),Pe("icon"),We("align","end",["start","end"]),Ge("primary",!1),Ge("disabled",!1)],mM=e(dM,[Ee("text")]),gM=e([Be("type",["submit","cancel","custom"])],mM),pM=e([Be("type",["menu"]),Pe("text"),Pe("tooltip"),Pe("icon"),Fe("items",lM)],dM),hM=he("type",{submit:gM,cancel:gM,custom:gM,menu:pM}),vM=[Ee("type"),Ee("text"),Be("level",["info","warn","error","success"]),Ee("icon"),Ne("url","")],bM=Jn(vM),yM=[Ee("type"),Ee("text"),Ge("disabled",!1),Ge("primary",!1),oe("name","name",Mn(function(){return Mi("button-name")}),xe),Pe("icon"),Ge("borderless",!1)],xM=Jn(yM),wM=[Ee("type"),Ee("name"),Ee("label"),Ge("disabled",!1)],SM=Jn(wM),kM=we,CM=[Ee("type"),Ee("name")],OM=CM.concat([Pe("label")]),_M=OM.concat([Ne("columns","auto")]),TM=Jn(_M),EM=ae([Ee("value"),Ee("text"),Ee("icon")]),BM=Jn(OM),DM=xe,AM=Jn(OM),MM=xe,FM=CM.concat([Ue("tag","textarea"),Ee("scriptId"),Ee("scriptUrl"),(ZA=undefined,Le("settings",ZA,Ce))]),IM=CM.concat([Ue("tag","textarea"),De("init")]),RM=se(function(t){return fe("customeditor.old",Kn(IM),t).orThunk(function(){return fe("customeditor.new",Kn(FM),t)})}),VM=xe,PM=Jn(OM),HM=$n(ue),zM=function(t){return[Ee("type"),Te("columns",ye),t]},NM=[Ee("type"),Ee("html"),We("presets","presentation",["presentation","document"])],LM=Jn(NM),jM=OM.concat([Ge("sandboxed",!0)]),UM=Jn(jM),WM=xe,GM=OM.concat([Te("currentState",Jn([_e("blob"),Ee("url")]))]),XM=Jn(GM),YM=OM.concat([Pe("inputMode"),Pe("placeholder"),Ge("maximized",!1),Ge("disabled",!1)]),qM=Jn(YM),KM=xe,JM=[Ee("text"),Ee("value")],$M=[Ee("text"),Fe("items",(tM=function(){return QM},nM=Tn(function(){return tM()}),{extract:function(t,n,e){return nM().extract(t,n,e)},toString:function(){return nM().toString()}}))],QM=Qn([Jn(JM),Jn($M)]),ZM=OM.concat([Fe("items",QM),Ge("disabled",!1)]),tF=Jn(ZM),nF=xe,eF=OM.concat([Me("items",[Ee("text"),Ee("value")]),je("size",1),Ge("disabled",!1)]),oF=Jn(eF),rF=xe,iF=OM.concat([Ge("constrain",!0),Ge("disabled",!1)]),uF=Jn(iF),aF=Jn([Ee("width"),Ee("height")]),cF=[Ee("type"),Fe("header",xe),Fe("cells",$n(xe))],sF=Jn(cF),lF=OM.concat([Pe("placeholder"),Ge("maximized",!1),Ge("disabled",!1)]),fF=Jn(lF),dF=xe,mF=OM.concat([We("filetype","file",["image","media","file"]),Ne("disabled",!1)]),gF=Jn(mF),pF=Jn([Ee("value"),Ne("meta",{})]),hF=function(t){return oe("items","items",Dn(),$n(se(function(n){return fe("Checking item of "+t,vF,n).fold(function(t){return Xt.error(ge(t))},function(t){return Xt.value(t)})})))},vF=ce(function(){return pe("type",{alertbanner:bM,bar:Jn((n=hF("bar"),[Ee("type"),n])),button:xM,checkbox:SM,colorinput:BM,colorpicker:AM,dropzone:PM,grid:Jn(zM(hF("grid"))),iframe:UM,input:qM,listbox:tF,selectbox:oF,sizeinput:uF,textarea:fF,urlinput:gF,customeditor:RM,htmlpanel:LM,imagetools:XM,collection:TM,label:Jn((t=hF("label"),[Ee("type"),Ee("label"),t])),table:sF,panel:yF});var t,n}),bF=[Ee("type"),Ne("classes",[]),Fe("items",vF)],yF=Jn(bF),xF=[oe("name","name",Mn(function(){return Mi("tab-name")}),xe),Ee("title"),Fe("items",vF)],wF=[Ee("type"),Me("tabs",xF)],SF=Jn(wF),kF=mM,CF=hM,OF=Jn([Ee("title"),Te("body",pe("type",{panel:yF,tabpanel:SF})),Ue("size","normal"),Fe("buttons",CF),Ne("initialData",{}),Xe("onAction",Y),Xe("onChange",Y),Xe("onSubmit",Y),Xe("onClose",Y),Xe("onCancel",Y),Ne("onTabChange",Y)]),_F=Jn(e([Be("type",["cancel","custom"])],kF)),TF=Jn([Ee("title"),Ee("url"),Ve("height"),Ve("width"),Re("buttons",$n(_F)),Xe("onAction",Y),Xe("onCancel",Y),Xe("onClose",Y),Xe("onMessage",Y)]),EF=function(t){return lt(t)?[t].concat(Rt(bn(t),EF)):ft(t)?Rt(t,EF):[]},BF=function(t){return st(t.type)&&st(t.name)},DF={checkbox:kM,colorinput:DM,colorpicker:MM,dropzone:HM,input:KM,iframe:WM,sizeinput:aF,selectbox:rF,listbox:nF,size:aF,textarea:dF,urlinput:pF,customeditor:VM,collection:EM,togglemenuitem:fM},AF=function(t){var n=Bt(EF(t),BF),e=Rt(n,function(t){return n=t,ut.from(DF[n.type]).fold(function(){return[]},function(n){return[Te(t.name,n)]});var n});return Jn(e)},MF=function(t){return{internalDialog:de(fe("dialog",OF,t)),dataValidator:AF(t),initialData:t.initialData}},FF={open:function(t,n){var e=MF(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(de(fe("dialog",TF,n)))},redial:MF},IF=function(t){var n=[],e={};return dn(t,function(t,o){t.fold(function(){n.push(o)},function(t){e[o]=t})}),0<n.length?Xt.error(n):Xt.value(e)},RF=Od({name:"TabButton",configFields:[Ne("uid",undefined),_e("value"),oe("dom","dom",Fn(function(){return{attributes:{role:"tab",id:Mi("aria"),"aria-selected":"false"}}}),ve()),Ie("action"),Ne("domModification",{}),Sf("tabButtonBehaviours",[Jg,zg,wf]),_e("view")],factory:function(t){return{uid:t.uid,dom:t.dom,components:t.components,events:lp(t.action),behaviours:Cf(t.tabButtonBehaviours,[Jg.config({}),zg.config({mode:"execution",useSpace:!0,useEnter:!0}),wf.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),VF=K([_e("tabs"),_e("dom"),Ne("clickToDismiss",!1),Sf("tabbarBehaviours",[jd,zg]),Wa(["tabClass","selectedClass"])]),PF=td({factory:RF,name:"tabs",unit:"tab",overrides:function(t){var n=function(t,n){jd.dehighlight(t,n),Ar(t,Tr(),{tabbar:t,button:n})},e=function(t,n){jd.highlight(t,n),Ar(t,_r(),{tabbar:t,button:n})};return{action:function(o){var r=o.getSystem().getByUid(t.uid).getOrDie(),i=jd.isHighlighted(r,o);(i&&t.clickToDismiss?n:i?Y:e)(r,o)},domModification:{classes:[t.markers.tabClass]}}}}),HF=K([PF]),zF=_d({name:"Tabbar",configFields:VF(),partFields:HF(),factory:function(t,n){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Cf(t.tabbarBehaviours,[jd.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){Si(n.element,"aria-selected","true")},onDehighlight:function(t,n){Si(n.element,"aria-selected","false")}}),zg.config({mode:"flow",getInitial:function(t){return jd.getHighlighted(t).map(function(t){return t.element})},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),NF=Od({name:"Tabview",configFields:[Sf("tabviewBehaviours",[Wg])],factory:function(t){return{uid:t.uid,dom:t.dom,behaviours:Cf(t.tabviewBehaviours,[Wg.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),LF=K([Ne("selectFirst",!0),Xa("onChangeTab"),Xa("onDismissTab"),Ne("tabs",[]),Sf("tabSectionBehaviours",[])]),jF=$f({factory:zF,schema:[_e("dom"),Ae("markers",[_e("tabClass"),_e("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),UF=$f({factory:NF,name:"tabview"}),WF=K([jF,UF]),GF=_d({name:"TabSection",configFields:LF(),partFields:WF(),factory:function(t,n){var e=function(n,e){fd(n,t,"tabbar").each(function(t){e(t).each(Mr)})};return{uid:t.uid,dom:t.dom,components:n,behaviours:kf(t.tabSectionBehaviours),events:Vr(It([t.selectFirst?[Xr(function(t){e(t,jd.getFirst)})]:[],[zr(_r(),function(n,e){var o,r,i=e.event.button;o=i,r=wf.getValue(o),fd(o,t,"tabview").each(function(n){Mt(t.tabs,function(t){return t.value===r}).each(function(e){var r=e.view();Ci(o.element,"id").each(function(t){Si(n.element,"aria-labelledby",t)}),Wg.set(n,r),t.onChangeTab(n,o,r)})})}),zr(Tr(),function(n,e){var o=e.event.button;t.onDismissTab(n,o)})]])),apis:{getViewItems:function(n){return fd(n,t,"tabview").map(function(t){return Wg.contents(t)}).getOr([])},showTab:function(t,n){e(t,function(t){var e=jd.getCandidates(t);return Mt(e,function(t){return wf.getValue(t)===n}).filter(function(n){return!jd.isHighlighted(t,n)})})}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),XF=function(t,n){Du(t,"height",n+"px"),_o().browser.isIE()?Pu(t,"flex-basis"):Du(t,"flex-basis",n+"px")},YF=function(t,n,e){_a(t,'[role="dialog"]').each(function(t){Ta(t,'[role="tablist"]').each(function(o){e.get().map(function(e){return Du(n,"height","0"),Du(n,"flex-basis","0"),Math.min(e,(i=n,u=o,a=ri(r=t).dom,c=_a(r,".tox-dialog-wrap").getOr(r),s="fixed"===Fu(c,"position")?Math.max(a.clientHeight,window.innerHeight):Math.max(a.offsetHeight,a.scrollHeight),l=Zu(i),f=i.dom.offsetLeft>=u.dom.offsetLeft+aa(u)?Math.max(Zu(u),l):l,d=parseInt(Fu(r,"margin-top"),10)||0,m=parseInt(Fu(r,"margin-bottom"),10)||0,s-(Zu(r)+d+m-f)));var r,i,u,a,c,s,l,f,d,m}).each(function(t){XF(n,t)})})})},qF=function(t){return Ta(t,'[role="tabpanel"]')},KF=function(t){var n;return{smartTabHeight:(n=Ke(ut.none()),{extraEvents:[Xr(function(e){var o=e.element;qF(o).each(function(r){var i;Du(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each(function(e){var o,i,u,a=(i=r,u=e,_t(o=t,function(t,n){Wg.set(u,o[n].view());var e=i.dom.getBoundingClientRect();return Wg.set(u,[]),e.height})),c=Nt(zt(a,function(t,n){return n<t?-1:t<n?1:0}));n.set(c)}),YF(o,r,n),Pu(r,"visibility"),i=e,Nt(t).each(function(t){return GF.showTab(i,t.value)}),Gp.requestAnimationFrame(function(){YF(o,r,n)})})}),zr(yr(),function(t){var e=t.element;qF(e).each(function(t){YF(e,t,n)})}),zr(Sx,function(t){var e=t.element;qF(e).each(function(t){var o=Xc();Du(t,"visibility","hidden");var r=Ru(t,"height").map(function(t){return parseInt(t,10)});Pu(t,"height"),Pu(t,"flex-basis");var i=t.dom.getBoundingClientRect().height;r.forall(function(t){return t<i})?(n.set(ut.from(i)),YF(e,t,n)):r.each(function(n){XF(t,n)}),Pu(t,"visibility"),o.each(Gc)})})],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},JF="send-data-to-section",$F="send-data-to-view",QF=Mi("update-dialog"),ZF=Mi("update-title"),tI=Mi("update-body"),nI=Mi("update-footer"),eI=Mi("body-send-message"),oI=function(t,n,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:et(et({},n.map(function(t){return{id:t}}).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:Pc([Ek(0),NT.config({channel:tI,updateState:function(t,n){return ut.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){switch(t.body.type){case"tabpanel":return[(i=t.body,u=e,a=Ke({}),c=function(t){var n=wf.getValue(t),e=IF(n).getOr({}),o=a.get(),r=On(o,e);a.set(r)},s=function(t){var n=a.get();wf.setValue(t,n)},l=Ke(null),f=_t(i.tabs,function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:u.shared.providers.translate(t.title)},view:function(){return[bk.sketch(function(n){return{dom:{tag:"div",classes:["tox-form"]},components:_t(t.items,function(t){return WO(n,t,u)}),formBehaviours:Pc([zg.config({mode:"acyclic",useTabstopAt:$(Xk)}),Gg("TabView.form.events",[Xr(s),Yr(c)]),Uc.config({channels:Pn([{key:JF,value:{onReceive:c}},{key:$F,value:{onReceive:s}}])})])}})]}}}),d=KF(f).smartTabHeight,GF.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n){var e=wf.getValue(n);Ar(t,wx,{name:e,oldName:l.get()}),l.set(e)},tabs:f,components:[GF.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[zF.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:Pc([sx.config({})])}),GF.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:d.selectFirst,tabSectionBehaviours:Pc([Gg("tabpanel",d.extraEvents),zg.config({mode:"acyclic"}),Ad.config({find:function(t){return Nt(GF.getViewItems(t))}}),wf.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([JF],{}),a.get()},setValue:function(t,n){a.set(n),t.getSystem().broadcastOn([$F],{})}}})])}))];default:return[(n=t.body,o=e,{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[(r=Yp(bk.sketch(function(t){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:_t(n.items,function(n){return WO(t,n,o)})}}))).asSpec()]}],behaviours:Pc([zg.config({mode:"acyclic",useTabstopAt:$(Xk)}),Tk(r),Rk(r,{postprocess:function(t){return IF(t).fold(function(t){return console.error(t),{}},function(t){return t})}})])})]}var n,o,r,i,u,a,c,s,l,f,d},initialData:t})])}},rI=wb.deviceType.isTouch(),iI=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},uI=function(t,n){return sM.parts.close(Xp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:Pc([sx.config({})])}))},aI=function(){return sM.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},cI=function(t,n){return sM.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:$B("<p>"+n.translate(t)+"</p>")}]}]})},sI=function(t){return sM.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},lI=function(t,n){return[ex.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),ex.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},fI=function(t){var n,o="tox-dialog",r=o+"-wrap",i=r+"__backdrop",u=o+"__disable-scroll";return sM.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),ut.some(!0)},useTabstopAt:function(t){return!Xk(t)},dom:{tag:"div",classes:[o].concat(t.extraClasses),styles:et({position:"relative"},t.extraStyles)},components:e([t.header,t.body],t.footer.toArray()),parts:{blocker:{dom:$B('<div class="'+r+'"></div>'),components:[{dom:{tag:"div",classes:rI?[i,i+"--opaque"]:[i]}}]}},dragBlockClass:r,modalBehaviours:Pc(e([Jg.config({}),Gg("dialog-events",t.dialogEvents.concat([Gr(qo(),function(t){zg.focusIn(t)})])),Gg("scroll-lock",[Xr(function(){fu(_u(),u)}),Yr(function(){mu(_u(),u)})])],t.extraBehaviours)),eventOrder:et(((n={})[sr()]=["dialog-events"],n[xr()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[wr()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},dI=function(t){return Xp.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:Kp("close",t.icons)}}],action:function(t){Dr(t,hx)}})},mI=function(t,n,e){var o=function(t){return[Yu(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:et({},n.map(function(t){return{id:t}}).getOr({}))},components:o(t),behaviours:Pc([NT.config({channel:ZF,renderComponents:o})])}},gI=function(){return{dom:$B('<div class="tox-dialog__draghandle"></div>')}},pI=function(t,n){return e={title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},o=n.shared.providers,r=sM.parts.title(mI(e,ut.none(),o)),i=sM.parts.draghandle(gI()),u=sM.parts.close(dI(o)),a=[r].concat(e.draggable?[i]:[]).concat([u]),ex.sketch({dom:$B('<div class="tox-dialog__header"></div>'),components:a});var e,o,r,i,u,a},hI=function(t,n){return{
onClose:function(){return n.closeWindow()},onBlock:function(n){sM.setBusy(t(),function(t,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":n.message},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:e,components:[{dom:$B('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}})},onUnblock:function(){sM.setIdle(t())}}},vI=function(t,n,o,r){var i;return Ju(fI(et(et({},t),{lazySink:r.shared.getSink,extraBehaviours:e([NT.config({channel:QF,updateState:function(t,n){return ut.some(n)},initialData:n}),Hk({})],t.extraBehaviours),onEscape:function(t){Dr(t,hx)},dialogEvents:o,eventOrder:((i={})[cr()]=["reflecting","receiving"],i[xr()]=["scroll-lock","reflecting","messages","dialog-events","alloy.base.behaviour"],i[wr()]=["alloy.base.behaviour","dialog-events","messages","reflecting","scroll-lock"],i)})))},bI=function(t){return _t(t,function(t){return"menu"===t.type?(e=_t((n=t).items,function(t){var n=Ke(!1);return et(et({},t),{storage:n})}),et(et({},n),{items:e})):t;var n,e})},yI=function(t){return At(t,function(t,n){return"menu"!==n.type?t:At(n.items,function(t,n){return t[n.name]=n.storage,t},t)},{})},xI=function(t,n){return[Ur(qo(),Gk),t(px,function(t,e){n.onClose(),e.onClose()}),t(hx,function(t,n,e,o){n.onCancel(t),Dr(o,px)}),zr(xx,function(){return n.onUnblock()}),zr(yx,function(t,e){return n.onBlock(e.event)})]},wI=function(t,n){var o=function(n,e){return zr(n,function(n,o){r(n,function(r){e(t(),r,o.event,n)})})},r=function(t,n){NT.getState(t).get().each(function(e){n(e,t)})};return e(xI(o,n),[o(vx,function(t,n,e){n.onAction(t,{name:e.name})})])},SI=function(t,n,o){var r=function(n,e){return zr(n,function(n,o){i(n,function(r){e(t(),r,o.event,n)})})},i=function(t,n){NT.getState(t).get().each(function(e){n(e.internalDialog,t)})};return e(xI(r,n),[r(bx,function(t,n){return n.onSubmit(t)}),r(gx,function(t,n,e){n.onChange(t,{name:e.name})}),r(vx,function(t,n,e,r){var i=function(){return zg.focusIn(r)},u=function(t){return Oi(t,"disabled")||Ci(t,"aria-disabled").exists(function(t){return"true"===t})},a=wu(r.element),c=Xc(a);n.onAction(t,{name:e.name,value:e.value}),Xc(a).fold(i,function(t){u(t)||c.exists(function(n){return Ao(t,n)&&u(n)})?i():o().toOptional().filter(function(n){return!Ao(n.element,t)}).each(i)})}),r(wx,function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})}),Yr(function(n){var e=t();wf.setValue(n,e.getData())})])},kI=function(t,n){var e=n.map(function(t){return t.footerButtons}).getOr([]),o=Et(e,function(t){return"start"===t.align}),r=function(t,n){return ex.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:_t(n,function(t){return t.memento.asSpec()})})};return[r("start",o.pass),r("end",o.fail)]},CI=function(t,n){return{dom:$B('<div class="tox-dialog__footer"></div>'),components:[],behaviours:Pc([NT.config({channel:nI,initialData:t,updateState:function(t,e){var o=_t(e.buttons,function(t){var e,o,r=Yp((o=n,PC(e=t,e.type,o)));return{name:t.name,align:t.align,memento:r}});return ut.some({lookupByName:function(t,n){return e=t,r=n,Mt(o,function(t){return t.name===r}).bind(function(t){return t.memento.getOpt(e)});var e,r},footerButtons:o})},renderComponents:kI})])}},OI=CI,_I=function(t,n){return sM.parts.footer(CI(t,n))},TI=function(t,n){if(t.getRoot().getSystem().isConnected()){var e=Ad.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return bk.getField(e,n).fold(function(){var o=t.getFooter();return NT.getState(o).get().bind(function(t){return t.lookupByName(e,n)})},function(t){return ut.some(t)})}return ut.none()},EI=function(t,n,e){var o=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},r={getData:function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=wf.getValue(o),i=mn(e,function(t){return t.get()});return et(et({},r),i)},setData:function(n){o(function(){var o,i,u=r.getData(),a=et(et({},u),n),c=(o=a,i=t.getRoot(),NT.getState(i).get().map(function(t){return de(fe("data",t.dataValidator,o))}).getOr(o)),s=t.getFormWrapper();wf.setValue(s,c),dn(e,function(t,n){xn(a,n)&&t.set(a[n])})})},disable:function(n){TI(t,n).each(Rv.disable)},enable:function(n){TI(t,n).each(Rv.enable)},focus:function(n){TI(t,n).each(Jg.focus)},block:function(t){if(!st(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o(function(n){Ar(n,yx,{message:t})})},unblock:function(){o(function(t){Dr(t,xx)})},showTab:function(n){o(function(){var e=t.getBody();NT.getState(e).get().exists(function(t){return t.isTabPanel()})&&Ad.getCurrent(e).each(function(t){GF.showTab(t,n)})})},redial:function(t){o(function(e){var o=n(t);e.getSystem().broadcastOn([QF],o),e.getSystem().broadcastOn([ZF],o.internalDialog),e.getSystem().broadcastOn([tI],o.internalDialog),e.getSystem().broadcastOn([nI],o.internalDialog),r.setData(o.initialData)})},close:function(){o(function(t){Dr(t,px)})}};return r},BI=function(t,n,e){var o,r,i,u=pI(t.internalDialog.title,e),a=(o={body:t.internalDialog.body},r=e,i=oI(o,ut.none(),r,!1),sM.parts.body(i)),c=bI(t.internalDialog.buttons),s=yI(c),l=_I({buttons:c},e),f=SI(function(){return p},hI(function(){return g},n),e.shared.getSink),d="normal"!==t.internalDialog.size?"large"===t.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],m={header:u,body:a,footer:ut.some(l),extraClasses:d,extraBehaviours:[],extraStyles:{}},g=vI(m,t,f,e),p=EI({getRoot:function(){return g},getBody:function(){return sM.getBody(g)},getFooter:function(){return sM.getFooter(g)},getFormWrapper:function(){var t=sM.getBody(g);return Ad.getCurrent(t).getOr(t)}},n.redial,s);return{dialog:g,instanceApi:p}},DI=function(t,n,e,o){var r,i,u,a,c,s,l,f,d,m=Mi("dialog-label"),g=Mi("dialog-content"),p=Yp((u={title:t.internalDialog.title,draggable:!0},a=m,c=e.shared.providers,ex.sketch({dom:$B('<div class="tox-dialog__header"></div>'),components:[mI(u,ut.some(a),c),gI(),dI(c)],containerBehaviours:Pc([qA.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return Ea(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),h=Yp((s={body:t.internalDialog.body},l=g,f=e,d=o,oI(s,ut.some(l),f,d))),v=bI(t.internalDialog.buttons),b=yI(v),y=Yp(OI({buttons:v},e)),x=SI(function(){return S},{onBlock:function(){},onUnblock:function(){},onClose:function(){return n.closeWindow()}},e.shared.getSink),w=Ju({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:((r={role:"dialog"})["aria-labelledby"]=m,r["aria-describedby"]=""+g,r)},eventOrder:((i={})[cr()]=[NT.name(),Uc.name()],i[sr()]=["execute-on-form"],i[xr()]=["reflecting","execute-on-form"],i),behaviours:Pc([zg.config({mode:"cyclic",onEscape:function(t){return Dr(t,px),ut.some(!0)},useTabstopAt:function(t){return!Xk(t)&&("button"!==Jr(t)||"disabled"!==ki(t,"disabled"))}}),NT.config({channel:QF,updateState:function(t,n){return ut.some(n)},initialData:t}),Jg.config({}),Gg("execute-on-form",x.concat([Gr(qo(),function(t){zg.focusIn(t)})])),Hk({})]),components:[p.asSpec(),h.asSpec(),y.asSpec()]}),S=EI({getRoot:function(){return w},getFooter:function(){return y.get(w)},getBody:function(){return h.get(w)},getFormWrapper:function(){var t=h.get(w);return Ad.getCurrent(t).getOr(t)}},n.redial,b);return{dialog:w,instanceApi:S}},AI=tinymce.util.Tools.resolve("tinymce.util.URI"),MI=["insertContent","setContent","execCommand","close","block","unblock"],FI=function(t){return lt(t)&&-1!==MI.indexOf(t.mceAction)},II=function(t,n,e,o){var r,i,u,a,c=pI(t.title,o),s=(i={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[Uk({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:Pc([sx.config({}),Jg.config({})])})]}],behaviours:Pc([zg.config({mode:"acyclic",useTabstopAt:$(Xk)})])},sM.parts.body(i)),l=t.buttons.bind(function(t){return 0===t.length?ut.none():ut.some(_I({buttons:t},o))}),f=wI(function(){return y},hI(function(){return b},n)),d=et(et({},t.height.fold(function(){return{}},function(t){return{height:t+"px","max-height":t+"px"}})),t.width.fold(function(){return{}},function(t){return{width:t+"px","max-width":t+"px"}})),m=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],g=new AI(t.url,{base_uri:new AI(window.location.href)}),p=g.protocol+"://"+g.host+(g.port?":"+g.port:""),h=Ke(ut.none()),v=[Gg("messages",[Xr(function(){var n=zy($e.fromDom(window),"message",function(n){var o,r;g.isSameOrigin(new AI(n.raw.origin))&&(o=n.raw.data,FI(o)?function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!dt(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}}(e,y,o):!FI(r=o)&&lt(r)&&xn(r,"mceAction")&&t.onMessage(y,o))});h.set(ut.some(n))}),Yr(function(){h.get().each(function(t){return t.unbind()})})]),Uc.config({channels:((r={})[eI]={onReceive:function(t,n){Ta(t.element,"iframe").each(function(t){t.dom.contentWindow.postMessage(n,p)})}},r)})],b=vI({header:c,body:s,footer:l,extraClasses:m,extraBehaviours:v,extraStyles:d},t,f,o),y=(a=function(t){u.getSystem().isConnected()&&t(u)},{block:function(t){if(!st(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");a(function(n){Ar(n,yx,{message:t})})},unblock:function(){a(function(t){Dr(t,xx)})},close:function(){a(function(t){Dr(t,px)})},sendMessage:function(t){a(function(n){n.getSystem().broadcastOn([eI],t)})}});return{dialog:u=b,instanceApi:y}},RI=function(t){var n,o,r,i,u=t.backstage,a=t.editor,c=rb(a),s=(o=(n=t).backstage.shared,{open:function(t,e){var r=function(){sM.hide(c),e()},i=Yp(PC({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:ut.none()},"cancel",n.backstage)),u=aI(),a=uI(r,o.providers),c=Ju(fI({lazySink:function(){return o.getSink()},header:iI(u,a),body:cI(t,o.providers),footer:ut.some(sI(lI([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[zr(hx,r)],eventOrder:{}}));sM.show(c);var s=i.get(c);Jg.focus(s)}}),l=(i=(r=t).backstage.shared,{open:function(t,n){var e=function(t){sM.hide(s),n(t)},o=Yp(PC({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:ut.none()},"submit",r.backstage)),u=PC({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:ut.none()},"cancel",r.backstage),a=aI(),c=uI(function(){return e(!1)},i.providers),s=Ju(fI({lazySink:function(){return i.getSink()},header:iI(a,c),body:cI(t,i.providers),footer:ut.some(sI(lI([],[u,o.asSpec()]))),onEscape:function(){return e(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[zr(hx,function(){return e(!1)}),zr(bx,function(){return e(!0)})],eventOrder:{}}));sM.show(s);var l=o.get(s);Jg.focus(l)}}),f=function(t,n){return FF.openUrl(function(t){var e=II(t,{closeWindow:function(){sM.hide(e.dialog),n(e.instanceApi)}},a,u);return sM.show(e.dialog),e.instanceApi},t)},d=function(t,n){return FF.open(function(t,e,o){var r=e,i=BI({dataValidator:o,initialData:r,internalDialog:t},{redial:FF.redial,closeWindow:function(){sM.hide(i.dialog),n(i.instanceApi)}},u);return sM.show(i.dialog),i.instanceApi.setData(r),i.instanceApi},t)},m=function(t,n,o,r){return FF.open(function(t,i,s){var l,f,d,m=de(fe("data",s,i)),g=(l=Ke(ut.none()),{clear:function(){return l.set(ut.none())},set:function(t){return l.set(ut.some(t))},isSet:function(){return l.get().isSome()},on:function(t){return l.get().each(t)}}),p=u.shared.header.isPositionedAtTop(),h=function(){return g.on(function(t){Fp.reposition(t),EB.refresh(t)})},v=DI({dataValidator:s,initialData:m,internalDialog:t},{redial:FF.redial,closeWindow:function(){g.on(Fp.hide),a.off("ResizeEditor",h),g.clear(),o(v.instanceApi)}},u,r),b=Ju(Fp.sketch(et(et({lazySink:u.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},p?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:Pc(e([Gg("window-manager-inline-events",[zr(Sr(),function(){Dr(v.dialog,hx)})])],(f=a,d=p,c&&d?[]:[EB.config({contextual:{lazyContext:function(){return ut.some(xa($e.fromDom(f.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]))),isExtraPart:function(t,n){return jy(e=n,".tox-alert-dialog")||jy(e,".tox-confirm-dialog");var e}})));return g.set(b),Fp.showWithin(b,n,$u(v.dialog),ut.some(_u())),c&&p||(EB.refresh(b),a.on("ResizeEditor",h)),v.instanceApi.setData(m),zg.focusIn(v.dialog),v.instanceApi},t)};return{open:function(t,n,e){return n!==undefined&&"toolbar"===n.inline?m(t,u.shared.anchors.inlineDialog(),e,n.ariaAttrs):n!==undefined&&"cursor"===n.inline?m(t,u.shared.anchors.cursor(),e,n.ariaAttrs):d(t,e)},openUrl:function(t,n){return f(t,n)},alert:function(t,n){s.open(t,function(){n()})},close:function(t){t.close()},confirm:function(t,n){l.open(t,function(t){n(t)})}}};nt.add("silver",function(t){var n=iM(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,u=n.getUi;Py(t,o.shared);var a=RI({editor:t,backstage:o});return{renderUI:r,getWindowManagerImpl:K(a),getNotificationManagerImpl:function(){return i(0,{backstage:o},e)},ui:u()}})}();